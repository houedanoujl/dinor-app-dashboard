import{_ as s,A as a,a as e,u as t}from"./index.XHIxoS6z.js";import{e as r,f as i,v as l,g as c,n,t as o,F as d,m as u,z as m,l as p,r as h,h as v,o as y}from"./vendor.CgTKjNNK.js";const k={class:"predictions-leaderboard"},b={class:"md3-main-content"},g={key:0,class:"loading-container"},_={key:1,class:"leaderboard-content"},f={key:0,class:"user-stats-card"},S={class:"user-stats-header"},w={class:"stats-grid"},A={class:"stat-item"},C={class:"stat-value"},P={class:"stat-item"},M={class:"stat-value"},x={class:"stat-item"},j={class:"stat-value"},q={class:"stat-item"},z={class:"stat-value"},L={key:0,class:"rank-change"},V={key:0,class:"material-icons rank-up"},I={key:1,class:"material-icons rank-down"},U={key:1,class:"auth-prompt"},E={class:"auth-prompt-content"},R={class:"top-players-section"},$={key:0,class:"podium"},B={class:"podium-rank"},D={class:"material-icons"},F={class:"podium-info"},N={class:"player-name"},T={class:"player-points"},G={class:"player-accuracy"},H={key:1,class:"leaderboard-list"},J={class:"rank-number"},K={class:"player-info"},O={class:"player-name"},Q={key:0,class:"you-badge"},W={class:"player-details"},X={class:"detail-item"},Y={class:"detail-item"},Z={class:"player-stats"},ss={class:"points"},as={class:"accuracy"},es={key:0,class:"rank-change-indicator"},ts={key:0,class:"material-icons rank-up"},rs={key:1,class:"material-icons rank-down"},is={key:2,class:"empty-leaderboard"},ls={class:"refresh-section"},cs=["disabled"],ns={key:0},os={key:1};const ds=s({name:"PredictionsLeaderboard",emits:["update-header"],components:{AuthModal:a},setup(s,{emit:a}){const r=e(),i=t(),l=h([]),c=h([]),n=h(null),o=h(!0),d=h(!1),u=h(!1),m=async()=>{try{const[s,a]=await Promise.all([r.get("/leaderboard"),r.get("/leaderboard/top?limit=10")]);s.success&&(l.value=s.data),a.success&&(c.value=a.data)}catch(s){console.error("Erreur lors du chargement du classement:",s)}},p=async()=>{if(i.isAuthenticated)try{const s=await r.get("/leaderboard/my-stats");s.success&&(n.value=s.data)}catch(s){console.error("Erreur lors du chargement des stats utilisateur:",s)}},y=async()=>{o.value=!0,await Promise.all([m(),p()]),o.value=!1};return v(()=>{y(),a("update-header",{title:"Classement",showBack:!0,backPath:"/predictions"})}),{leaderboard:l,topPlayers:c,userStats:n,loading:o,refreshing:d,showAuthModal:u,authStore:i,refreshLeaderboard:async()=>{d.value=!0;try{(await r.post("/leaderboard/refresh")).success&&await y()}catch(s){console.error("Erreur lors de la mise à jour:",s)}finally{d.value=!1}},isCurrentUser:s=>i.isAuthenticated&&s.user_id===i.userId,getRankClass:s=>1===s?"rank-gold":2===s?"rank-silver":3===s?"rank-bronze":s<=10?"rank-top10":"",getPodiumIcon:s=>{switch(s){case 1:return"emoji_events";case 2:return"military_tech";case 3:return"stars";default:return"star"}},handleAuthenticated:()=>{u.value=!1,p()}}}},[["render",function(s,a,e,t,h,v){const ds=p("AuthModal");return y(),r("div",k,[i("main",b,[t.loading?(y(),r("div",g,a[3]||(a[3]=[i("div",{class:"md3-circular-progress"},null,-1),i("p",{class:"md3-body-large"},"Chargement du classement...",-1)]))):(y(),r("div",_,[a[16]||(a[16]=i("div",{class:"leaderboard-header"},[i("h1",{class:"md3-title-large dinor-text-primary"},"Classement"),i("p",{class:"md3-body-medium dinor-text-gray"},"Découvrez qui sont les meilleurs pronostiqueurs!")],-1)),t.authStore.isAuthenticated&&t.userStats?(y(),r("div",f,[i("div",S,[a[5]||(a[5]=i("h2",{class:"md3-title-medium"},"Vos statistiques",-1)),i("div",{class:n(["user-rank-badge",t.getRankClass(t.userStats.current_position)])},[a[4]||(a[4]=i("i",{class:"material-icons"},"star",-1)),i("span",null,o(t.userStats.current_position?`#${t.userStats.current_position}`:"Non classé"),1)],2)]),i("div",w,[i("div",A,[i("div",C,o(t.userStats.total_points),1),a[6]||(a[6]=i("div",{class:"stat-label"},"Points",-1))]),i("div",P,[i("div",M,o(t.userStats.total_predictions),1),a[7]||(a[7]=i("div",{class:"stat-label"},"Pronostics",-1))]),i("div",x,[i("div",j,o(t.userStats.accuracy_percentage)+"%",1),a[8]||(a[8]=i("div",{class:"stat-label"},"Précision",-1))]),i("div",q,[i("div",z,o(t.userStats.correct_scores),1),a[9]||(a[9]=i("div",{class:"stat-label"},"Scores exacts",-1))])]),0!==t.userStats.rank_change?(y(),r("div",L,[t.userStats.rank_change>0?(y(),r("i",V,"trending_up")):(y(),r("i",I,"trending_down")),i("span",null,o(Math.abs(t.userStats.rank_change))+" position"+o(Math.abs(t.userStats.rank_change)>1?"s":""),1)])):c("",!0)])):t.authStore.isAuthenticated?c("",!0):(y(),r("div",U,[i("div",E,[a[10]||(a[10]=i("i",{class:"material-icons"},"account_circle",-1)),a[11]||(a[11]=i("h3",{class:"md3-title-medium"},"Connectez-vous",-1)),a[12]||(a[12]=i("p",{class:"md3-body-medium"},"Connectez-vous pour voir vos statistiques et votre position dans le classement",-1)),i("button",{onClick:a[0]||(a[0]=s=>t.showAuthModal=!0),class:"btn-primary"}," Se connecter ")])])),i("div",R,[a[14]||(a[14]=i("h2",{class:"md3-title-medium dinor-text-primary"},"Top 10",-1)),t.topPlayers.length?(y(),r("div",$,[(y(!0),r(d,null,u(t.topPlayers.slice(0,3),(s,a)=>(y(),r("div",{key:s.id,class:n(["podium-item",`rank-${a+1}`])},[i("div",B,[i("i",D,o(t.getPodiumIcon(a+1)),1)]),i("div",F,[i("div",N,o(s.user.name),1),i("div",T,o(s.total_points)+" pts",1),i("div",G,o(s.accuracy_percentage)+"% précision",1)])],2))),128))])):c("",!0),t.leaderboard.length?(y(),r("div",H,[(y(!0),r(d,null,u(t.leaderboard,(s,a)=>(y(),r("div",{key:s.id,class:n(["leaderboard-item",{"current-user":t.isCurrentUser(s)}])},[i("div",J,[i("span",{class:n(["rank-badge",t.getRankClass(a+1)])},o(a+1),3)]),i("div",K,[i("div",O,[m(o(s.user.name)+" ",1),t.isCurrentUser(s)?(y(),r("span",Q,"Vous")):c("",!0)]),i("div",W,[i("span",X,o(s.total_predictions)+" pronostics",1),i("span",Y,o(s.correct_scores)+" scores exacts",1)])]),i("div",Z,[i("div",ss,o(s.total_points)+" pts",1),i("div",as,o(s.accuracy_percentage)+"%",1)]),s.rank_change?(y(),r("div",es,[s.rank_change>0?(y(),r("i",ts,"keyboard_arrow_up")):(y(),r("i",rs,"keyboard_arrow_down")),i("span",null,o(Math.abs(s.rank_change)),1)])):c("",!0)],2))),128))])):(y(),r("div",is,a[13]||(a[13]=[i("div",{class:"empty-icon"},[i("i",{class:"material-icons"},"leaderboard")],-1),i("h3",{class:"md3-title-medium"},"Aucun classement",-1),i("p",{class:"md3-body-medium dinor-text-gray"},"Le classement apparaîtra dès que les premiers pronostics seront faits.",-1)])))]),i("div",ls,[i("button",{onClick:a[1]||(a[1]=(...s)=>t.refreshLeaderboard&&t.refreshLeaderboard(...s)),disabled:t.refreshing,class:"btn-secondary refresh-btn"},[a[15]||(a[15]=i("i",{class:"material-icons"},"refresh",-1)),t.refreshing?(y(),r("span",ns,"Mise à jour...")):(y(),r("span",os,"Actualiser le classement"))],8,cs)])]))]),l(ds,{modelValue:t.showAuthModal,"onUpdate:modelValue":a[2]||(a[2]=s=>t.showAuthModal=s),onAuthenticated:t.handleAuthenticated},null,8,["modelValue","onAuthenticated"])])}],["__scopeId","data-v-8945cd77"]]);export{ds as default};
