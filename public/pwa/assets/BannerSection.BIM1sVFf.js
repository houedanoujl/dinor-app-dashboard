import{a as e}from"./useApi.Cm5RO5Cj.js";import{r as n,h as t,j as r,F as o,E as s,G as a,i as l,t as i,k as c,l as u,q as d,o as p}from"./vendor.Bvrl98ec.js";import{_ as F,D as y}from"./index.CsDJUcBR.js";function b(){const{request:t}=e(),r=n([]),o=n(!1),s=n(null),a=async(e={},n=!1)=>{o.value=!0,s.value=null;try{const o={};e.position&&(o.position=e.position),e.type_contenu&&(o.type_contenu=e.type_contenu),e.section&&(o.section=e.section),console.log("🌐 [useBanners] Requête API /banners avec params:",o);const a=n?{forceRefresh:!0}:{},l=await t("/banners",{params:o,...a});console.log("📦 [useBanners] Réponse API:",l),l.success?(r.value=l.data,console.log(`✅ [useBanners] ${l.data.length} bannières chargées`)):(s.value=l.message||"Erreur lors du chargement des bannières",console.error("❌ [useBanners] Erreur:",s.value))}catch(a){s.value="Impossible de charger les bannières",console.error("❌ [useBanners] Exception:",a)}finally{o.value=!1}};return{banners:r,loading:o,error:s,loadBanners:a,loadBannersByType:async e=>{o.value=!0,s.value=null;try{const n=await t(`/banners/type/${e}`);return n.success?(r.value=n.data,n.data):(s.value=n.message||"Erreur lors du chargement des bannières",[])}catch(n){return s.value="Impossible de charger les bannières pour ce type",console.error("Erreur bannières par type:",n),[]}finally{o.value=!1}},loadBannersForContentType:async(e,n=!1)=>(console.log(`🎯 [useBanners] Chargement des bannières pour type: ${e}`),await a({type_contenu:e,position:"home"===e?"home":"content"},n)),clearBannersCache:()=>(console.log("🗑️ [useBanners] Vidage du cache des bannières"),r.value=[],a({},!0)),getBanner:async e=>{try{const n=await t(`/banners/${e}`);if(n.success)return n.data;throw new Error(n.message||"Bannière non trouvée")}catch(n){throw console.error("Erreur récupération bannière:",n),n}},getActiveBanners:()=>r.value.filter(e=>e.is_active),getBannersByPosition:e=>r.value.filter(n=>n.position===e||"all_pages"===n.position),getBannersBySection:e=>r.value.filter(n=>n.section===e),getBannersByTypeAndSection:(e,n)=>r.value.filter(t=>t.type_contenu===e&&t.section===n)}}const g={class:"banner-content"},v={key:3,class:"banner-video"},h=["onClick"],B=["onClick"];const _=F({name:"BannerSection",components:{DinorIcon:y},props:{type:{type:String,required:!0,validator:e=>["recipes","tips","events","dinor_tv","pages","home"].includes(e)},section:{type:String,default:"hero",validator:e=>["header","hero","featured","footer"].includes(e)},banners:{type:Array,default:()=>[]}},computed:{visibleBanners(){return this.banners.filter(e=>e.image_url)}},methods:{getBannerStyle:e=>({backgroundColor:e.background_color||"#E1251B",color:e.text_color||"#FFFFFF"}),getBannerButtonStyle(e){return{backgroundColor:e.button_color||"#FFFFFF",color:this.getContrastColor(e.button_color||"#FFFFFF"),border:`2px solid ${e.button_color||"#FFFFFF"}`}},getContrastColor:e=>(299*parseInt(e.slice(1,3),16)+587*parseInt(e.slice(3,5),16)+114*parseInt(e.slice(5,7),16))/1e3>128?"#000000":"#FFFFFF",handleButtonClick(e){e.startsWith("/")?this.$router.push(e):e.startsWith("http")?window.open(e,"_blank"):this.$router.push(e)},playDemoVideo(e){e&&window.open(e,"_blank")}}},[["render",function(e,n,F,y,b,_){const m=u("DinorIcon");return _.visibleBanners&&_.visibleBanners.length>0?(p(),t("section",{key:0,class:d(["banner-section",`banner-section--${F.section}`])},[(p(!0),t(o,null,s(_.visibleBanners,e=>(p(),t("div",{key:e.id,class:"banner-item",style:a(_.getBannerStyle(e))},[e.image_url?(p(),t("div",{key:0,class:"banner-background",style:a({backgroundImage:`url(${e.image_url})`})},null,4)):r("",!0),l("div",g,[e.titre?(p(),t("h2",{key:0,class:"banner-title",style:a({color:e.text_color||"#FFFFFF"})},i(e.titre),5)):r("",!0),e.sous_titre?(p(),t("h3",{key:1,class:"banner-subtitle",style:a({color:e.text_color||"#FFFFFF"})},i(e.sous_titre),5)):r("",!0),e.description?(p(),t("p",{key:2,class:"banner-description",style:a({color:e.text_color||"#FFFFFF"})},i(e.description),5)):r("",!0),e.demo_video_url?(p(),t("div",v,[l("button",{onClick:n=>_.playDemoVideo(e.demo_video_url),class:"video-play-button",style:a({color:e.text_color||"#FFFFFF"})},[c(m,{name:"play_circle",size:20}),n[0]||(n[0]=l("span",null,"Voir la démo",-1))],12,h)])):r("",!0),e.button_text&&e.button_url?(p(),t("button",{key:4,class:"banner-button",style:a(_.getBannerButtonStyle(e)),onClick:n=>_.handleButtonClick(e.button_url)},i(e.button_text),13,B)):r("",!0)])],4))),128))],2)):r("",!0)}],["__scopeId","data-v-e580d7e0"]]);export{_ as B,b as u};
