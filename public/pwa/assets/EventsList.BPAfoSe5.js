import{e,v as t,f as a,B as l,l as s,t as n,I as r,g as i,F as o,m as c,n as u,b as d,r as v,h as p,k as m,o as y}from"./vendor.CgTKjNNK.js";import{_ as g,b as f}from"./index.Dqjl_hq9.js";import{B as b,u as h}from"./BannerSection.WFCjefTr.js";import{S as F}from"./SearchAndFilters.BGxS_nQC.js";import"./useApi.CwvlQ1Zj.js";const k={class:"events-list"},C={class:"filters-toggle"},_={class:"material-icons"},w={class:"filters-container"},T={key:0,class:"loading-state"},E={key:1,class:"error-state"},A={key:2,class:"content"},L={key:0,class:"empty-state"},j={class:"md3-body-medium dinor-text-gray"},S={key:1,class:"events-container"},x=["onClick"],B={class:"event-image"},Q=["src","alt"],D={class:"event-status"},I={class:"event-content"},R={class:"event-header"},U={class:"event-title"},N={key:0,class:"event-price"},P={key:0,class:"free-badge"},z={key:1,class:"price"},G={key:0,class:"event-description"},O={class:"event-details"},$={class:"detail"},q={key:0,class:"detail"},H={key:1,class:"detail"},M={key:2,class:"detail"},X={key:1,class:"participants-info"};const J=g({name:"EventsList",components:{SearchAndFilters:F,BannerSection:b},setup(){const e=m(),{banners:t,loadBannersForContentType:a}=h(),l=d(()=>t.value),s=v([]),n=v([]),r=v(!1),i=v(null),o=v(""),c=v(!1),u=v(null),y=v({eventType:null,eventFormat:null,price:null,status:null}),g=d(()=>{let e=s.value;if(o.value.trim()){const t=o.value.toLowerCase();e=e.filter(e=>{var a,l,s,n,r,i;return(null==(a=e.title)?void 0:a.toLowerCase().includes(t))||(null==(l=e.description)?void 0:l.toLowerCase().includes(t))||(null==(s=e.short_description)?void 0:s.toLowerCase().includes(t))||(null==(n=e.location)?void 0:n.toLowerCase().includes(t))||(null==(r=e.city)?void 0:r.toLowerCase().includes(t))||(null==(i=e.organizer_name)?void 0:i.toLowerCase().includes(t))})}return u.value&&(e=e.filter(e=>e.category_id===u.value)),y.value.eventType&&(e=e.filter(e=>e.event_type===y.value.eventType)),y.value.eventFormat&&(e=e.filter(e=>e.event_format===y.value.eventFormat)),y.value.price&&("free"===y.value.price?e=e.filter(e=>e.is_free):"paid"===y.value.price&&(e=e.filter(e=>!e.is_free))),y.value.status&&(e=e.filter(e=>e.status===y.value.status)),e}),b=d(()=>Object.values(y.value).some(e=>null!==e)),F=d(()=>[{key:"eventType",label:"Type d'événement",icon:"category",allLabel:"Tous les types",options:[{value:"conference",label:"Conférence"},{value:"workshop",label:"Atelier"},{value:"seminar",label:"Séminaire"},{value:"cooking_class",label:"Cours de cuisine"},{value:"tasting",label:"Dégustation"},{value:"festival",label:"Festival"},{value:"competition",label:"Concours"},{value:"networking",label:"Networking"},{value:"exhibition",label:"Exposition"},{value:"party",label:"Fête"}]},{key:"eventFormat",label:"Format",icon:"computer",allLabel:"Tous les formats",options:[{value:"in_person",label:"En présentiel"},{value:"online",label:"En ligne"},{value:"hybrid",label:"Hybride"}]},{key:"price",label:"Tarif",icon:"payments",allLabel:"Tous les tarifs",options:[{value:"free",label:"Gratuit"},{value:"paid",label:"Payant"}]},{key:"status",label:"Statut",icon:"info",allLabel:"Tous les statuts",options:[{value:"active",label:"Actif"},{value:"upcoming",label:"À venir"},{value:"completed",label:"Terminé"}]}]),k=async()=>{r.value=!0,i.value=null;try{const e=await f.getEvents();if(!e.success)throw new Error(e.message||"Failed to fetch events");s.value=e.data}catch(e){i.value=e.message,console.error("Error fetching events:",e)}finally{r.value=!1}},C=async()=>{try{const e=await f.getEventCategories();e.success&&(n.value=e.data)}catch(e){console.warn("Error fetching event categories:",e)}};return p(async()=>{await a("events",!0),k(),C()}),{events:s,categories:n,loading:r,error:i,searchQuery:o,selectedCategory:u,selectedFilters:y,filteredEvents:g,hasActiveFilters:b,eventFilters:F,showFilters:c,bannersByType:l,goToEvent:t=>{e.push(`/event/${t}`)},retry:()=>{i.value=null,k(),C()},updateAdditionalFilter:({key:e,value:t})=>{y.value[e]=t},clearAllFilters:()=>{o.value="",u.value=null,y.value={eventType:null,eventFormat:null,price:null,status:null}},getStatusClass:e=>({active:"status-active",cancelled:"status-cancelled",completed:"status-completed",upcoming:"status-upcoming"}[e]||"status-default"),getStatusLabel:e=>({active:"Actif",cancelled:"Annulé",completed:"Terminé",upcoming:"À venir"}[e]||"Non défini"),getEventTypeLabel:e=>({festival:"Festival",cooking_class:"Cours de cuisine",tasting:"Dégustation",workshop:"Atelier",conference:"Conférence"}[e]||e),formatDate:e=>e?new Date(e).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}):"",formatTime:e=>e?new Date(`2000-01-01T${e}`).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}):"",formatPrice:(e,t="XOF")=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:t}).format(e),handleImageError:e=>{e.target.src="/images/default-event.jpg"}}}},[["render",function(d,v,p,m,g,f){const b=s("BannerSection"),h=s("SearchAndFilters");return y(),e("div",k,[t(b,{type:"events",section:"hero",banners:m.bannersByType},null,8,["banners"]),a("div",C,[a("button",{onClick:v[0]||(v[0]=e=>m.showFilters=!m.showFilters),class:"toggle-btn"},[a("i",_,n(m.showFilters?"expand_less":"expand_more"),1),a("span",null,n(m.showFilters?"Masquer les filtres":"Afficher les filtres"),1)])]),l(a("div",w,[t(h,{searchQuery:m.searchQuery,"onUpdate:searchQuery":v[1]||(v[1]=e=>m.searchQuery=e),selectedCategory:m.selectedCategory,"onUpdate:selectedCategory":v[2]||(v[2]=e=>m.selectedCategory=e),"search-placeholder":"Rechercher un événement...",categories:m.categories,"additional-filters":m.eventFilters,"selected-filters":m.selectedFilters,"results-count":m.filteredEvents.length,"item-type":"événement","onUpdate:additionalFilter":m.updateAdditionalFilter},null,8,["searchQuery","selectedCategory","categories","additional-filters","selected-filters","results-count","onUpdate:additionalFilter"])],512),[[r,m.showFilters]]),m.loading?(y(),e("div",T,v[6]||(v[6]=[a("div",{class:"loading-spinner"},null,-1),a("p",null,"Chargement des événements...",-1)]))):m.error?(y(),e("div",E,[v[7]||(v[7]=a("div",{class:"error-icon"},[a("span",{class:"material-symbols-outlined"},"error"),a("span",{class:"emoji-fallback"},"⚠️")],-1)),v[8]||(v[8]=a("p",{class:"md3-body-large dinor-text-gray"},"Erreur lors du chargement des événements.",-1)),a("button",{onClick:v[3]||(v[3]=(...e)=>m.retry&&m.retry(...e)),class:"retry-btn"}," Réessayer ")])):(y(),e("div",A,[m.filteredEvents.length||m.loading?(y(),e("div",S,[(y(!0),e(o,null,c(m.filteredEvents,t=>(y(),e("article",{key:t.id,onClick:e=>m.goToEvent(t.id),class:"event-card"},[a("div",B,[a("img",{src:t.featured_image_url||"/images/default-event.jpg",alt:t.title,loading:"lazy",onError:v[5]||(v[5]=(...e)=>m.handleImageError&&m.handleImageError(...e))},null,40,Q),a("div",D,[a("span",{class:u(m.getStatusClass(t.status))},n(m.getStatusLabel(t.status)),3)])]),a("div",I,[a("div",R,[a("h3",U,n(t.title),1),t.price?(y(),e("div",N,[t.is_free?(y(),e("span",P,"Gratuit")):(y(),e("span",z,n(m.formatPrice(t.price,t.currency)),1))])):i("",!0)]),t.short_description?(y(),e("p",G,n(t.short_description),1)):i("",!0),a("div",O,[a("div",$,[v[11]||(v[11]=a("span",{class:"material-symbols-outlined"},"calendar_today",-1)),v[12]||(v[12]=a("span",{class:"emoji-fallback"},"📅",-1)),a("span",null,n(m.formatDate(t.start_date)),1)]),t.start_time?(y(),e("div",q,[v[13]||(v[13]=a("span",{class:"material-symbols-outlined"},"schedule",-1)),v[14]||(v[14]=a("span",{class:"emoji-fallback"},"⏰",-1)),a("span",null,n(m.formatTime(t.start_time)),1)])):i("",!0),t.location?(y(),e("div",H,[v[15]||(v[15]=a("span",{class:"material-symbols-outlined"},"location_on",-1)),v[16]||(v[16]=a("span",{class:"emoji-fallback"},"📍",-1)),a("span",null,n(t.location),1)])):i("",!0),t.event_type?(y(),e("div",M,[v[17]||(v[17]=a("span",{class:"material-symbols-outlined"},"category",-1)),v[18]||(v[18]=a("span",{class:"emoji-fallback"},"🏷️",-1)),a("span",null,n(m.getEventTypeLabel(t.event_type)),1)])):i("",!0)]),t.max_participants?(y(),e("div",X,[v[19]||(v[19]=a("span",{class:"material-symbols-outlined"},"group",-1)),v[20]||(v[20]=a("span",{class:"emoji-fallback"},"👥",-1)),a("span",null,n(t.participants_count||0)+" / "+n(t.max_participants)+" participants",1)])):i("",!0)])],8,x))),128))])):(y(),e("div",L,[v[9]||(v[9]=a("div",{class:"empty-icon"},[a("span",{class:"material-symbols-outlined"},"event"),a("span",{class:"emoji-fallback"},"📅")],-1)),v[10]||(v[10]=a("h2",{class:"md3-title-medium"},"Aucun événement trouvé",-1)),a("p",j,n(m.searchQuery||m.selectedCategory||m.hasActiveFilters?"Aucun événement ne correspond à vos critères de recherche.":"Aucun événement n'est disponible pour le moment."),1),m.searchQuery||m.selectedCategory||m.hasActiveFilters?(y(),e("button",{key:0,onClick:v[4]||(v[4]=(...e)=>m.clearAllFilters&&m.clearAllFilters(...e)),class:"clear-filters-btn"}," Effacer tous les filtres ")):i("",!0)]))]))])}],["__scopeId","data-v-cd524d27"]]);export{J as default};
