import{e as s,f as e,v as a,g as t,F as n,m as i,n as r,t as l,s as o,y as c,z as u,l as m,r as d,b as p,h as y,o as v}from"./vendor.CgTKjNNK.js";import{_ as g,A as h,a as f,u as k}from"./index.DfjICG2s.js";const b={class:"tournaments"},_={class:"md3-main-content"},T={key:0,class:"loading-container"},w={key:1,class:"tournaments-content"},A={class:"filters-section"},C={class:"filter-tabs"},x=["onClick"],F={key:0,class:"tournaments-grid"},z=["onClick"],P={class:"tournament-header"},M={class:"tournament-name"},I={class:"tournament-description"},D={class:"tournament-info"},j={class:"info-row"},E={class:"info-item"},L={key:0,class:"info-item"},R={class:"info-row"},S={class:"info-item"},V={key:0,class:"info-item"},N={key:0,class:"tournament-progress"},O={class:"progress-bar"},q={class:"progress-text"},B={class:"tournament-actions"},G=["onClick","disabled"],U={key:0},X={key:1},$=["onClick"],H={key:2,class:"tournament-status-info"},J={key:0,class:"status-text"},K={key:1,class:"status-text"},Q={key:2,class:"status-text"},W={key:1,class:"empty-state"},Y={key:2,class:"my-tournaments-section"},Z={class:"my-tournaments-list"},ss=["onClick"],es={class:"tournament-info-left"},as={class:"tournament-name"},ts={class:"tournament-stats"},ns={class:"stat-item"},is={class:"stat-value"},rs={class:"stat-item"},ls={class:"stat-value"},os={class:"stat-item"},cs={class:"stat-value"};const us=g({name:"Tournaments",emits:["update-header"],components:{AuthModal:h},setup(s,{emit:e}){const a=f(),t=k(),n=d([]),i=d([]),r=d(!0),l=d(null),o=d(!1),c=d("all"),u=p(()=>"all"===c.value?n.value:n.value.filter(s=>s.status===c.value)),m=async()=>{try{const s=await a.get("/tournaments",{sort_by:"start_date",sort_direction:"asc"});s.success&&(n.value=s.data||[])}catch(s){console.error("Erreur lors du chargement des tournois:",s)}},v=async()=>{if(t.isAuthenticated)try{const s=await a.get("/tournaments/my-tournaments");s.success&&(i.value=s.data||[])}catch(s){console.error("Erreur lors du chargement de mes tournois:",s)}};return y(async()=>{r.value=!0,await Promise.all([m(),v()]),r.value=!1,e("update-header",{title:"Tournois",showBack:!0})}),{tournaments:n,myTournaments:i,loading:r,registering:l,showAuthModal:o,selectedFilter:c,filters:[{key:"all",label:"Tous"},{key:"registration_open",label:"Inscriptions ouvertes"},{key:"active",label:"En cours"},{key:"upcoming",label:"À venir"},{key:"finished",label:"Terminés"}],filteredTournaments:u,authStore:t,registerToTournament:async s=>{var e;if(t.isAuthenticated){l.value=s.id;try{(await a.post(`/tournaments/${s.id}/register`,{})).success&&(s.user_is_participant=!0,s.can_register=!1,s.participants_count+=1,await v(),console.log("Inscription réussie au tournoi!"))}catch(n){console.error("Erreur lors de l'inscription:",n),(null==(e=n.message)?void 0:e.includes("401"))&&(o.value=!0)}finally{l.value=null}}else o.value=!0},openTournament:s=>{console.log("Ouverture du tournoi:",s.name)},viewTournamentLeaderboard:s=>{console.log("Classement du tournoi:",s.name)},formatPrize:(s,e)=>0===s?"Gratuit":new Intl.NumberFormat("fr-FR",{style:"currency",currency:e||"XOF",minimumFractionDigits:0}).format(s),formatDate:s=>new Date(s).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"}),handleAuthenticated:()=>{o.value=!1,v()}}}},[["render",function(d,p,y,g,h,f){const k=m("AuthModal");return v(),s("div",b,[e("main",_,[g.loading?(v(),s("div",T,p[1]||(p[1]=[e("div",{class:"md3-circular-progress"},null,-1),e("p",{class:"md3-body-large"},"Chargement des tournois...",-1)]))):(v(),s("div",w,[p[15]||(p[15]=e("div",{class:"tournaments-header"},[e("h1",{class:"md3-title-large dinor-text-primary"},"Tournois"),e("p",{class:"md3-body-medium dinor-text-gray"},"Participez aux tournois et gagnez des prix!")],-1)),e("div",A,[e("div",C,[(v(!0),s(n,null,i(g.filters,e=>(v(),s("button",{key:e.key,onClick:s=>g.selectedFilter=e.key,class:r(["filter-tab",{active:g.selectedFilter===e.key}])},l(e.label),11,x))),128))])]),g.filteredTournaments.length>0?(v(),s("div",F,[(v(!0),s(n,null,i(g.filteredTournaments,a=>(v(),s("div",{key:a.id,class:"tournament-card",onClick:s=>g.openTournament(a)},[e("div",P,[e("h3",M,l(a.name),1),e("span",{class:r(["tournament-status",a.status])},l(a.status_label),3)]),e("p",I,l(a.description),1),e("div",D,[e("div",j,[e("div",E,[p[2]||(p[2]=e("i",{class:"material-icons"},"group",-1)),e("span",null,l(a.participants_count)+" participants",1)]),a.prize_pool>0?(v(),s("div",L,[p[3]||(p[3]=e("i",{class:"material-icons"},"emoji_events",-1)),e("span",null,l(g.formatPrize(a.prize_pool,a.currency)),1)])):t("",!0)]),e("div",R,[e("div",S,[p[4]||(p[4]=e("i",{class:"material-icons"},"schedule",-1)),e("span",null,"Fin: "+l(g.formatDate(a.end_date)),1)]),a.entry_fee>0?(v(),s("div",V,[p[5]||(p[5]=e("i",{class:"material-icons"},"payment",-1)),e("span",null,l(g.formatPrize(a.entry_fee,a.currency)),1)])):t("",!0)])]),"active"===a.status?(v(),s("div",N,[e("div",O,[e("div",{class:"progress-fill",style:o({width:a.progress_percentage+"%"})},null,4)]),e("span",q,l(a.progress_percentage)+"% terminé",1)])):t("",!0),e("div",B,[a.can_register?(v(),s("button",{key:0,onClick:c(s=>g.registerToTournament(a),["stop"]),disabled:g.registering===a.id,class:"btn-primary btn-small"},[g.registering===a.id?(v(),s("span",U,"Inscription...")):(v(),s("span",X,"Participer"))],8,G)):a.user_is_participant?(v(),s("button",{key:1,onClick:c(s=>g.viewTournamentLeaderboard(a),["stop"]),class:"btn-secondary btn-small"},p[6]||(p[6]=[e("i",{class:"material-icons"},"leaderboard",-1),u(" Mon classement ")]),8,$)):(v(),s("div",H,["upcoming"===a.status?(v(),s("span",J,p[7]||(p[7]=[e("i",{class:"material-icons"},"schedule",-1),u(" À venir ")]))):"finished"===a.status?(v(),s("span",K,p[8]||(p[8]=[e("i",{class:"material-icons"},"flag",-1),u(" Terminé ")]))):(v(),s("span",Q,p[9]||(p[9]=[e("i",{class:"material-icons"},"block",-1),u(" Inscriptions fermées ")])))]))])],8,z))),128))])):(v(),s("div",W,p[10]||(p[10]=[e("i",{class:"material-icons"},"emoji_events",-1),e("h3",null,"Aucun tournoi disponible",-1),e("p",null,"Les tournois apparaîtront ici quand ils seront disponibles.",-1)]))),g.authStore.isAuthenticated&&g.myTournaments.length>0?(v(),s("div",Y,[p[14]||(p[14]=e("h2",{class:"md3-title-medium dinor-text-primary"},"Mes tournois",-1)),e("div",Z,[(v(!0),s(n,null,i(g.myTournaments,a=>(v(),s("div",{key:a.tournament.id,class:"my-tournament-item",onClick:s=>g.openTournament(a.tournament)},[e("div",es,[e("h4",as,l(a.tournament.name),1),e("span",{class:r(["tournament-status",a.tournament.status])},l(a.tournament.status_label),3)]),e("div",ts,[e("div",ns,[p[11]||(p[11]=e("span",{class:"stat-label"},"Rang",-1)),e("span",is,"#"+l(a.user_rank||"N/A"),1)]),e("div",rs,[p[12]||(p[12]=e("span",{class:"stat-label"},"Points",-1)),e("span",ls,l(a.user_points),1)]),e("div",os,[p[13]||(p[13]=e("span",{class:"stat-label"},"Précision",-1)),e("span",cs,l(a.user_accuracy)+"%",1)])])],8,ss))),128))])])):t("",!0)]))]),a(k,{modelValue:g.showAuthModal,"onUpdate:modelValue":p[0]||(p[0]=s=>g.showAuthModal=s),onAuthenticated:g.handleAuthenticated},null,8,["modelValue","onAuthenticated"])])}],["__scopeId","data-v-6e80979f"]]);export{us as default};
