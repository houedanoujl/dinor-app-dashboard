import{h as e,i as s,k as t,j as a,F as n,E as r,q as i,t as o,l,G as u,z as c,A as m,r as d,b as p,g as y,o as v}from"./vendor.Bvrl98ec.js";import{_ as g,D as h,A as f,u as k,d as b}from"./index.Bsia8KuI.js";const _={class:"tournaments"},T={class:"md3-main-content"},z={key:0,class:"loading-container"},w={key:1,class:"tournaments-content"},A={class:"filters-section"},C={class:"filter-tabs"},x=["onClick"],F={key:0,class:"tournaments-grid"},D=["onClick"],I={class:"tournament-header"},P={class:"tournament-name"},M={class:"tournament-description"},j={class:"tournament-info"},E={class:"info-row"},L={class:"info-item"},R={key:0,class:"info-item"},S={class:"info-row"},V={class:"info-item"},q={key:0,class:"info-item"},G={key:0,class:"tournament-progress"},N={class:"progress-bar"},O={class:"progress-text"},B={class:"tournament-actions"},U=["onClick","disabled"],X={key:0},$={key:1},H=["onClick"],J={key:2,class:"tournament-status-info"},K={key:0,class:"status-text"},Q={key:1,class:"status-text"},W={key:2,class:"status-text"},Y={key:1,class:"empty-state"},Z={key:2,class:"my-tournaments-section"},ee={class:"my-tournaments-list"},se=["onClick"],te={class:"tournament-info-left"},ae={class:"tournament-name"},ne={class:"tournament-stats"},re={class:"stat-item"},ie={class:"stat-value"},oe={class:"stat-item"},le={class:"stat-value"},ue={class:"stat-item"},ce={class:"stat-value"};const me=g({name:"Tournaments",emits:["update-header"],components:{AuthModal:f,DinorIcon:h},setup(e,{emit:s}){const t=k(),a=b(),n=d([]),r=d([]),i=d(!0),o=d(null),l=d(!1),u=d("all"),c=p(()=>"all"===u.value?n.value:n.value.filter(e=>e.status===u.value)),m=async()=>{try{const e=await t.get("/tournaments",{sort_by:"start_date",sort_direction:"asc"});e.success&&(n.value=e.data||[])}catch(e){console.error("Erreur lors du chargement des tournois:",e)}},v=async()=>{if(a.isAuthenticated)try{const e=await t.get("/tournaments/my-tournaments");e.success&&(r.value=e.data||[])}catch(e){console.error("Erreur lors du chargement de mes tournois:",e)}};return y(async()=>{i.value=!0,await Promise.all([m(),v()]),i.value=!1,s("update-header",{title:"Tournois",showBack:!0})}),{tournaments:n,myTournaments:r,loading:i,registering:o,showAuthModal:l,selectedFilter:u,filters:[{key:"all",label:"Tous"},{key:"registration_open",label:"Inscriptions ouvertes"},{key:"active",label:"En cours"},{key:"upcoming",label:"À venir"},{key:"finished",label:"Terminés"}],filteredTournaments:c,authStore:a,registerToTournament:async e=>{var s;if(a.isAuthenticated){o.value=e.id;try{(await t.post(`/tournaments/${e.id}/register`,{})).success&&(e.user_is_participant=!0,e.can_register=!1,e.participants_count+=1,await v(),console.log("Inscription réussie au tournoi!"))}catch(n){console.error("Erreur lors de l'inscription:",n),(null==(s=n.message)?void 0:s.includes("401"))&&(l.value=!0)}finally{o.value=null}}else l.value=!0},openTournament:e=>{console.log("Ouverture du tournoi:",e.name)},viewTournamentLeaderboard:e=>{console.log("Classement du tournoi:",e.name)},formatPrize:(e,s)=>0===e?"Gratuit":new Intl.NumberFormat("fr-FR",{style:"currency",currency:s||"XOF",minimumFractionDigits:0}).format(e),formatDate:e=>new Date(e).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"}),handleAuthenticated:()=>{l.value=!1,v()}}}},[["render",function(d,p,y,g,h,f){const k=l("DinorIcon"),b=l("AuthModal");return v(),e("div",_,[s("main",T,[g.loading?(v(),e("div",z,p[1]||(p[1]=[s("div",{class:"md3-circular-progress"},null,-1),s("p",{class:"md3-body-large"},"Chargement des tournois...",-1)]))):(v(),e("div",w,[p[12]||(p[12]=s("div",{class:"tournaments-header"},[s("h1",{class:"md3-title-large dinor-text-primary"},"Tournois"),s("p",{class:"md3-body-medium dinor-text-gray"},"Participez aux tournois et gagnez des prix!")],-1)),s("div",A,[s("div",C,[(v(!0),e(n,null,r(g.filters,s=>(v(),e("button",{key:s.key,onClick:e=>g.selectedFilter=s.key,class:i(["filter-tab",{active:g.selectedFilter===s.key}])},o(s.label),11,x))),128))])]),g.filteredTournaments.length>0?(v(),e("div",F,[(v(!0),e(n,null,r(g.filteredTournaments,n=>(v(),e("div",{key:n.id,class:"tournament-card",onClick:e=>g.openTournament(n)},[s("div",I,[s("h3",P,o(n.name),1),s("span",{class:i(["tournament-status",n.status])},o(n.status_label),3)]),s("p",M,o(n.description),1),s("div",j,[s("div",E,[s("div",L,[t(k,{name:"group",size:16}),s("span",null,o(n.participants_count)+" participants",1)]),n.prize_pool>0?(v(),e("div",R,[t(k,{name:"emoji_events",size:16}),s("span",null,o(g.formatPrize(n.prize_pool,n.currency)),1)])):a("",!0)]),s("div",S,[s("div",V,[t(k,{name:"schedule",size:16}),s("span",null,"Fin: "+o(g.formatDate(n.end_date)),1)]),n.entry_fee>0?(v(),e("div",q,[t(k,{name:"payments",size:16}),s("span",null,o(g.formatPrize(n.entry_fee,n.currency)),1)])):a("",!0)])]),"active"===n.status?(v(),e("div",G,[s("div",N,[s("div",{class:"progress-fill",style:u({width:n.progress_percentage+"%"})},null,4)]),s("span",O,o(n.progress_percentage)+"% terminé",1)])):a("",!0),s("div",B,[n.can_register?(v(),e("button",{key:0,onClick:c(e=>g.registerToTournament(n),["stop"]),disabled:g.registering===n.id,class:"btn-primary btn-small"},[g.registering===n.id?(v(),e("span",X,"Inscription...")):(v(),e("span",$,"Participer"))],8,U)):n.user_is_participant?(v(),e("button",{key:1,onClick:c(e=>g.viewTournamentLeaderboard(n),["stop"]),class:"btn-secondary btn-small"},[t(k,{name:"leaderboard",size:16}),p[2]||(p[2]=m(" Mon classement "))],8,H)):(v(),e("div",J,["upcoming"===n.status?(v(),e("span",K,[t(k,{name:"schedule",size:16}),p[3]||(p[3]=m(" À venir "))])):"finished"===n.status?(v(),e("span",Q,[t(k,{name:"flag",size:16}),p[4]||(p[4]=m(" Terminé "))])):(v(),e("span",W,[t(k,{name:"block",size:16}),p[5]||(p[5]=m(" Inscriptions fermées "))]))]))])],8,D))),128))])):(v(),e("div",Y,[t(k,{name:"emoji_events",size:64}),p[6]||(p[6]=s("h3",null,"Aucun tournoi disponible",-1)),p[7]||(p[7]=s("p",null,"Les tournois apparaîtront ici quand ils seront disponibles.",-1))])),g.authStore.isAuthenticated&&g.myTournaments.length>0?(v(),e("div",Z,[p[11]||(p[11]=s("h2",{class:"md3-title-medium dinor-text-primary"},"Mes tournois",-1)),s("div",ee,[(v(!0),e(n,null,r(g.myTournaments,t=>(v(),e("div",{key:t.tournament.id,class:"my-tournament-item",onClick:e=>g.openTournament(t.tournament)},[s("div",te,[s("h4",ae,o(t.tournament.name),1),s("span",{class:i(["tournament-status",t.tournament.status])},o(t.tournament.status_label),3)]),s("div",ne,[s("div",re,[p[8]||(p[8]=s("span",{class:"stat-label"},"Rang",-1)),s("span",ie,"#"+o(t.user_rank||"N/A"),1)]),s("div",oe,[p[9]||(p[9]=s("span",{class:"stat-label"},"Points",-1)),s("span",le,o(t.user_points),1)]),s("div",ue,[p[10]||(p[10]=s("span",{class:"stat-label"},"Précision",-1)),s("span",ce,o(t.user_accuracy)+"%",1)])])],8,se))),128))])])):a("",!0)]))]),t(b,{modelValue:g.showAuthModal,"onUpdate:modelValue":p[0]||(p[0]=e=>g.showAuthModal=e),onAuthenticated:g.handleAuthenticated},null,8,["modelValue","onAuthenticated"])])}],["__scopeId","data-v-10d0f0bd"]]);export{me as default};
