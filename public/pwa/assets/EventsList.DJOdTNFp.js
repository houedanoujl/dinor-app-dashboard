import{h as e,k as t,i as a,B as l,l as s,t as n,L as r,j as i,F as o,E as c,q as u,b as d,r as v,g as p,p as m,o as y}from"./vendor.Bvrl98ec.js";import{_ as g,D as f,b as h}from"./index.Bsia8KuI.js";import{B as b,u as F}from"./BannerSection.B2oN4XQD.js";import{S as k}from"./SearchAndFilters.DPYZdhhF.js";import"./useApi.CD5SC-zH.js";const _={class:"events-list"},C={class:"filters-toggle"},w={class:"filters-container"},E={key:0,class:"loading-state"},T={key:1,class:"error-state"},A={class:"error-icon"},L={key:2,class:"content"},S={key:0,class:"empty-state"},x={class:"empty-icon"},z={class:"md3-body-medium dinor-text-gray"},D={key:1,class:"events-container"},j=["onClick"],B={class:"event-image"},Q=["src","alt"],I={class:"event-status"},R={class:"event-content"},U={class:"event-header"},q={class:"event-title"},N={key:0,class:"event-price"},P={key:0,class:"free-badge"},G={key:1,class:"price"},O={key:0,class:"event-description"},$={class:"event-details"},H={class:"detail"},M={key:0,class:"detail"},X={key:1,class:"detail"},J={key:2,class:"detail"},K={key:1,class:"participants-info"};const V=g({name:"EventsList",components:{SearchAndFilters:k,BannerSection:b,DinorIcon:f},setup(){const e=m(),{banners:t,loadBannersForContentType:a}=F(),l=d(()=>t.value),s=v([]),n=v([]),r=v(!1),i=v(null),o=v(""),c=v(!1),u=v(null),y=v({eventType:null,eventFormat:null,price:null,status:null}),g=d(()=>{let e=s.value;if(o.value.trim()){const t=o.value.toLowerCase();e=e.filter(e=>{var a,l,s,n,r,i;return(null==(a=e.title)?void 0:a.toLowerCase().includes(t))||(null==(l=e.description)?void 0:l.toLowerCase().includes(t))||(null==(s=e.short_description)?void 0:s.toLowerCase().includes(t))||(null==(n=e.location)?void 0:n.toLowerCase().includes(t))||(null==(r=e.city)?void 0:r.toLowerCase().includes(t))||(null==(i=e.organizer_name)?void 0:i.toLowerCase().includes(t))})}return u.value&&(e=e.filter(e=>e.category_id===u.value)),y.value.eventType&&(e=e.filter(e=>e.event_type===y.value.eventType)),y.value.eventFormat&&(e=e.filter(e=>e.event_format===y.value.eventFormat)),y.value.price&&("free"===y.value.price?e=e.filter(e=>e.is_free):"paid"===y.value.price&&(e=e.filter(e=>!e.is_free))),y.value.status&&(e=e.filter(e=>e.status===y.value.status)),e}),f=d(()=>Object.values(y.value).some(e=>null!==e)),b=d(()=>[{key:"eventType",label:"Type d'événement",icon:"category",allLabel:"Tous les types",options:[{value:"conference",label:"Conférence"},{value:"workshop",label:"Atelier"},{value:"seminar",label:"Séminaire"},{value:"cooking_class",label:"Cours de cuisine"},{value:"tasting",label:"Dégustation"},{value:"festival",label:"Festival"},{value:"competition",label:"Concours"},{value:"networking",label:"Networking"},{value:"exhibition",label:"Exposition"},{value:"party",label:"Fête"}]},{key:"eventFormat",label:"Format",icon:"computer",allLabel:"Tous les formats",options:[{value:"in_person",label:"En présentiel"},{value:"online",label:"En ligne"},{value:"hybrid",label:"Hybride"}]},{key:"price",label:"Tarif",icon:"payments",allLabel:"Tous les tarifs",options:[{value:"free",label:"Gratuit"},{value:"paid",label:"Payant"}]},{key:"status",label:"Statut",icon:"info",allLabel:"Tous les statuts",options:[{value:"active",label:"Actif"},{value:"upcoming",label:"À venir"},{value:"completed",label:"Terminé"}]}]),k=async()=>{r.value=!0,i.value=null;try{const e=await h.getEvents();if(!e.success)throw new Error(e.message||"Failed to fetch events");s.value=e.data}catch(e){i.value=e.message,console.error("Error fetching events:",e)}finally{r.value=!1}},_=async()=>{try{const e=await h.getEventCategories();e.success&&(n.value=e.data)}catch(e){console.warn("Error fetching event categories:",e)}};return p(async()=>{await a("events",!0),k(),_()}),{events:s,categories:n,loading:r,error:i,searchQuery:o,selectedCategory:u,selectedFilters:y,filteredEvents:g,hasActiveFilters:f,eventFilters:b,showFilters:c,bannersByType:l,goToEvent:t=>{e.push(`/event/${t}`)},retry:()=>{i.value=null,k(),_()},updateAdditionalFilter:({key:e,value:t})=>{y.value[e]=t},clearAllFilters:()=>{o.value="",u.value=null,y.value={eventType:null,eventFormat:null,price:null,status:null}},getStatusClass:e=>({active:"status-active",cancelled:"status-cancelled",completed:"status-completed",upcoming:"status-upcoming"}[e]||"status-default"),getStatusLabel:e=>({active:"Actif",cancelled:"Annulé",completed:"Terminé",upcoming:"À venir"}[e]||"Non défini"),getEventTypeLabel:e=>({festival:"Festival",cooking_class:"Cours de cuisine",tasting:"Dégustation",workshop:"Atelier",conference:"Conférence"}[e]||e),formatDate:e=>e?new Date(e).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}):"",formatTime:e=>e?new Date(`2000-01-01T${e}`).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}):"",formatPrice:(e,t="XOF")=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:t}).format(e),handleImageError:e=>{e.target.src="/images/default-event.jpg"}}}},[["render",function(d,v,p,m,g,f){const h=s("BannerSection"),b=s("DinorIcon"),F=s("SearchAndFilters");return y(),e("div",_,[t(h,{type:"events",section:"hero",banners:m.bannersByType},null,8,["banners"]),a("div",C,[a("button",{onClick:v[0]||(v[0]=e=>m.showFilters=!m.showFilters),class:"toggle-btn"},[t(b,{name:m.showFilters?"expand_less":"expand_more",size:20},null,8,["name"]),a("span",null,n(m.showFilters?"Masquer les filtres":"Afficher les filtres"),1)])]),l(a("div",w,[t(F,{searchQuery:m.searchQuery,"onUpdate:searchQuery":v[1]||(v[1]=e=>m.searchQuery=e),selectedCategory:m.selectedCategory,"onUpdate:selectedCategory":v[2]||(v[2]=e=>m.selectedCategory=e),"search-placeholder":"Rechercher un événement...",categories:m.categories,"additional-filters":m.eventFilters,"selected-filters":m.selectedFilters,"results-count":m.filteredEvents.length,"item-type":"événement","onUpdate:additionalFilter":m.updateAdditionalFilter},null,8,["searchQuery","selectedCategory","categories","additional-filters","selected-filters","results-count","onUpdate:additionalFilter"])],512),[[r,m.showFilters]]),m.loading?(y(),e("div",E,v[6]||(v[6]=[a("div",{class:"loading-spinner"},null,-1),a("p",null,"Chargement des événements...",-1)]))):m.error?(y(),e("div",T,[a("div",A,[t(b,{name:"error",size:48})]),v[7]||(v[7]=a("p",{class:"md3-body-large dinor-text-gray"},"Erreur lors du chargement des événements.",-1)),a("button",{onClick:v[3]||(v[3]=(...e)=>m.retry&&m.retry(...e)),class:"retry-btn"}," Réessayer ")])):(y(),e("div",L,[m.filteredEvents.length||m.loading?(y(),e("div",D,[(y(!0),e(o,null,c(m.filteredEvents,l=>(y(),e("article",{key:l.id,onClick:e=>m.goToEvent(l.id),class:"event-card"},[a("div",B,[a("img",{src:l.featured_image_url||"/images/default-event.jpg",alt:l.title,loading:"lazy",onError:v[5]||(v[5]=(...e)=>m.handleImageError&&m.handleImageError(...e))},null,40,Q),a("div",I,[a("span",{class:u(m.getStatusClass(l.status))},n(m.getStatusLabel(l.status)),3)])]),a("div",R,[a("div",U,[a("h3",q,n(l.title),1),l.price?(y(),e("div",N,[l.is_free?(y(),e("span",P,"Gratuit")):(y(),e("span",G,n(m.formatPrice(l.price,l.currency)),1))])):i("",!0)]),l.short_description?(y(),e("p",O,n(l.short_description),1)):i("",!0),a("div",$,[a("div",H,[t(b,{name:"calendar_today",size:16}),a("span",null,n(m.formatDate(l.start_date)),1)]),l.start_time?(y(),e("div",M,[t(b,{name:"schedule",size:16}),a("span",null,n(m.formatTime(l.start_time)),1)])):i("",!0),l.location?(y(),e("div",X,[t(b,{name:"location_on",size:16}),a("span",null,n(l.location),1)])):i("",!0),l.event_type?(y(),e("div",J,[t(b,{name:"category",size:16}),a("span",null,n(m.getEventTypeLabel(l.event_type)),1)])):i("",!0)]),l.max_participants?(y(),e("div",K,[t(b,{name:"group",size:16}),a("span",null,n(l.participants_count||0)+" / "+n(l.max_participants)+" participants",1)])):i("",!0)])],8,j))),128))])):(y(),e("div",S,[a("div",x,[t(b,{name:"calendar_today",size:64})]),v[8]||(v[8]=a("h2",{class:"md3-title-medium"},"Aucun événement trouvé",-1)),a("p",z,n(m.searchQuery||m.selectedCategory||m.hasActiveFilters?"Aucun événement ne correspond à vos critères de recherche.":"Aucun événement n'est disponible pour le moment."),1),m.searchQuery||m.selectedCategory||m.hasActiveFilters?(y(),e("button",{key:0,onClick:v[4]||(v[4]=(...e)=>m.clearAllFilters&&m.clearAllFilters(...e)),class:"clear-filters-btn"}," Effacer tous les filtres ")):i("",!0)]))]))])}],["__scopeId","data-v-e7fa1fa4"]]);export{V as default};
