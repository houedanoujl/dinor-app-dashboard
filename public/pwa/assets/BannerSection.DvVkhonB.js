import{a as e}from"./useApi.fWoZF7Gp.js";import{r as n,e as t,g as r,F as s,m as o,s as a,f as l,t as i,n as c,o as u}from"./vendor.CgTKjNNK.js";import{_ as d}from"./index.DfjICG2s.js";function p(){const{request:t}=e(),r=n([]),s=n(!1),o=n(null),a=async(e={},n=!1)=>{s.value=!0,o.value=null;try{const s={};e.position&&(s.position=e.position),e.type_contenu&&(s.type_contenu=e.type_contenu),e.section&&(s.section=e.section),console.log("🌐 [useBanners] Requête API /banners avec params:",s);const a=n?{forceRefresh:!0}:{},l=await t("/banners",{params:s,...a});console.log("📦 [useBanners] Réponse API:",l),l.success?(r.value=l.data,console.log(`✅ [useBanners] ${l.data.length} bannières chargées`)):(o.value=l.message||"Erreur lors du chargement des bannières",console.error("❌ [useBanners] Erreur:",o.value))}catch(a){o.value="Impossible de charger les bannières",console.error("❌ [useBanners] Exception:",a)}finally{s.value=!1}};return{banners:r,loading:s,error:o,loadBanners:a,loadBannersByType:async e=>{s.value=!0,o.value=null;try{const n=await t(`/banners/type/${e}`);return n.success?(r.value=n.data,n.data):(o.value=n.message||"Erreur lors du chargement des bannières",[])}catch(n){return o.value="Impossible de charger les bannières pour ce type",console.error("Erreur bannières par type:",n),[]}finally{s.value=!1}},loadBannersForContentType:async(e,n=!1)=>(console.log(`🎯 [useBanners] Chargement des bannières pour type: ${e}`),await a({type_contenu:e,position:"home"===e?"home":"content"},n)),clearBannersCache:()=>(console.log("🗑️ [useBanners] Vidage du cache des bannières"),r.value=[],a({},!0)),getBanner:async e=>{try{const n=await t(`/banners/${e}`);if(n.success)return n.data;throw new Error(n.message||"Bannière non trouvée")}catch(n){throw console.error("Erreur récupération bannière:",n),n}},getActiveBanners:()=>r.value.filter(e=>e.is_active),getBannersByPosition:e=>r.value.filter(n=>n.position===e||"all_pages"===n.position),getBannersBySection:e=>r.value.filter(n=>n.section===e),getBannersByTypeAndSection:(e,n)=>r.value.filter(t=>t.type_contenu===e&&t.section===n)}}const F={class:"banner-content"},b={key:3,class:"banner-video"},y=["onClick"],g=["onClick"];const v=d({name:"BannerSection",props:{type:{type:String,required:!0,validator:e=>["recipes","tips","events","dinor_tv","pages","home"].includes(e)},section:{type:String,default:"hero",validator:e=>["header","hero","featured","footer"].includes(e)},banners:{type:Array,default:()=>[]}},computed:{visibleBanners(){return this.banners.filter(e=>e.image_url)}},methods:{getBannerStyle:e=>({backgroundColor:e.background_color||"#E1251B",color:e.text_color||"#FFFFFF"}),getBannerButtonStyle(e){return{backgroundColor:e.button_color||"#FFFFFF",color:this.getContrastColor(e.button_color||"#FFFFFF"),border:`2px solid ${e.button_color||"#FFFFFF"}`}},getContrastColor:e=>(299*parseInt(e.slice(1,3),16)+587*parseInt(e.slice(3,5),16)+114*parseInt(e.slice(5,7),16))/1e3>128?"#000000":"#FFFFFF",handleButtonClick(e){e.startsWith("/")?this.$router.push(e):e.startsWith("http")?window.open(e,"_blank"):this.$router.push(e)},playDemoVideo(e){e&&window.open(e,"_blank")}}},[["render",function(e,n,d,p,v,m){return m.visibleBanners&&m.visibleBanners.length>0?(u(),t("section",{key:0,class:c(["banner-section",`banner-section--${d.section}`])},[(u(!0),t(s,null,o(m.visibleBanners,e=>(u(),t("div",{key:e.id,class:"banner-item",style:a(m.getBannerStyle(e))},[e.image_url?(u(),t("div",{key:0,class:"banner-background",style:a({backgroundImage:`url(${e.image_url})`})},null,4)):r("",!0),l("div",F,[e.titre?(u(),t("h2",{key:0,class:"banner-title",style:a({color:e.text_color||"#FFFFFF"})},i(e.titre),5)):r("",!0),e.sous_titre?(u(),t("h3",{key:1,class:"banner-subtitle",style:a({color:e.text_color||"#FFFFFF"})},i(e.sous_titre),5)):r("",!0),e.description?(u(),t("p",{key:2,class:"banner-description",style:a({color:e.text_color||"#FFFFFF"})},i(e.description),5)):r("",!0),e.demo_video_url?(u(),t("div",b,[l("button",{onClick:n=>m.playDemoVideo(e.demo_video_url),class:"video-play-button",style:a({color:e.text_color||"#FFFFFF"})},n[0]||(n[0]=[l("span",{class:"material-symbols-outlined"},"play_circle",-1),l("span",{class:"emoji-fallback"},"▶️",-1),l("span",null,"Voir la démo",-1)]),12,y)])):r("",!0),e.button_text&&e.button_url?(u(),t("button",{key:4,class:"banner-button",style:a(m.getBannerButtonStyle(e)),onClick:n=>m.handleButtonClick(e.button_url)},i(e.button_text),13,g)):r("",!0)])],4))),128))],2)):r("",!0)}],["__scopeId","data-v-dc342f41"]]);export{v as B,p as u};
