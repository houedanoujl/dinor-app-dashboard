import{_ as s,A as a,a as e,u as t}from"./index.DSySyJtv.js";import{e as r,f as l,v as n,g as i,n as o,t as c,F as d,m as u,z as m,l as p,r as h,h as v,o as y}from"./vendor.CgTKjNNK.js";const b={class:"predictions-leaderboard"},k={class:"md3-main-content"},g={key:0,class:"loading-container"},_={key:1,class:"leaderboard-content"},f={key:0,class:"user-stats-card"},S={class:"user-stats-header"},w={class:"stats-grid"},A={class:"stat-item"},C={class:"stat-value"},P={class:"stat-item"},M={class:"stat-value"},x={class:"stat-item"},j={class:"stat-value"},q={class:"stat-item"},z={class:"stat-value"},L={key:0,class:"rank-change"},V={key:0,class:"material-symbols-outlined rank-up"},I={key:1,class:"material-symbols-outlined rank-down"},U={key:1,class:"auth-prompt"},E={class:"auth-prompt-content"},R={class:"top-players-section"},$={key:0,class:"podium"},B={class:"podium-rank"},D={class:"material-symbols-outlined"},F={class:"podium-info"},N={class:"player-name"},T={class:"player-points"},G={class:"player-accuracy"},H={key:1,class:"leaderboard-list"},J={class:"rank-number"},K={class:"player-info"},O={class:"player-name"},Q={key:0,class:"you-badge"},W={class:"player-details"},X={class:"detail-item"},Y={class:"detail-item"},Z={class:"player-stats"},ss={class:"points"},as={class:"accuracy"},es={key:0,class:"rank-change-indicator"},ts={key:0,class:"material-symbols-outlined rank-up"},rs={key:1,class:"material-symbols-outlined rank-down"},ls={key:2,class:"empty-leaderboard"},ns={class:"refresh-section"},is=["disabled"],os={key:0},cs={key:1};const ds=s({name:"PredictionsLeaderboard",emits:["update-header"],components:{AuthModal:a},setup(s,{emit:a}){const r=e(),l=t(),n=h([]),i=h([]),o=h(null),c=h(!0),d=h(!1),u=h(!1),m=async()=>{try{const[s,a]=await Promise.all([r.get("/leaderboard"),r.get("/leaderboard/top?limit=10")]);s.success&&(n.value=s.data),a.success&&(i.value=a.data)}catch(s){console.error("Erreur lors du chargement du classement:",s)}},p=async()=>{if(l.isAuthenticated)try{const s=await r.get("/leaderboard/my-stats");s.success&&(o.value=s.data)}catch(s){console.error("Erreur lors du chargement des stats utilisateur:",s)}},y=async()=>{c.value=!0,await Promise.all([m(),p()]),c.value=!1};return v(()=>{y(),a("update-header",{title:"Classement",showBack:!0,backPath:"/predictions"})}),{leaderboard:n,topPlayers:i,userStats:o,loading:c,refreshing:d,showAuthModal:u,authStore:l,refreshLeaderboard:async()=>{d.value=!0;try{(await r.post("/leaderboard/refresh")).success&&await y()}catch(s){console.error("Erreur lors de la mise à jour:",s)}finally{d.value=!1}},isCurrentUser:s=>l.isAuthenticated&&s.user_id===l.userId,getRankClass:s=>1===s?"rank-gold":2===s?"rank-silver":3===s?"rank-bronze":s<=10?"rank-top10":"",getPodiumIcon:s=>{switch(s){case 1:return"emoji_events";case 2:return"military_tech";case 3:return"stars";default:return"star"}},handleAuthenticated:()=>{u.value=!1,p()}}}},[["render",function(s,a,e,t,h,v){const ds=p("AuthModal");return y(),r("div",b,[l("main",k,[t.loading?(y(),r("div",g,a[3]||(a[3]=[l("div",{class:"md3-circular-progress"},null,-1),l("p",{class:"md3-body-large"},"Chargement du classement...",-1)]))):(y(),r("div",_,[a[16]||(a[16]=l("div",{class:"leaderboard-header"},[l("h1",{class:"md3-title-large dinor-text-primary"},"Classement"),l("p",{class:"md3-body-medium dinor-text-gray"},"Découvrez qui sont les meilleurs pronostiqueurs!")],-1)),t.authStore.isAuthenticated&&t.userStats?(y(),r("div",f,[l("div",S,[a[5]||(a[5]=l("h2",{class:"md3-title-medium"},"Vos statistiques",-1)),l("div",{class:o(["user-rank-badge",t.getRankClass(t.userStats.current_position)])},[a[4]||(a[4]=l("span",{class:"material-symbols-outlined"},"star",-1)),l("span",null,c(t.userStats.current_position?`#${t.userStats.current_position}`:"Non classé"),1)],2)]),l("div",w,[l("div",A,[l("div",C,c(t.userStats.total_points),1),a[6]||(a[6]=l("div",{class:"stat-label"},"Points",-1))]),l("div",P,[l("div",M,c(t.userStats.total_predictions),1),a[7]||(a[7]=l("div",{class:"stat-label"},"Pronostics",-1))]),l("div",x,[l("div",j,c(t.userStats.accuracy_percentage)+"%",1),a[8]||(a[8]=l("div",{class:"stat-label"},"Précision",-1))]),l("div",q,[l("div",z,c(t.userStats.correct_scores),1),a[9]||(a[9]=l("div",{class:"stat-label"},"Scores exacts",-1))])]),0!==t.userStats.rank_change?(y(),r("div",L,[t.userStats.rank_change>0?(y(),r("span",V,"trending_up")):(y(),r("span",I,"trending_down")),l("span",null,c(Math.abs(t.userStats.rank_change))+" position"+c(Math.abs(t.userStats.rank_change)>1?"s":""),1)])):i("",!0)])):t.authStore.isAuthenticated?i("",!0):(y(),r("div",U,[l("div",E,[a[10]||(a[10]=l("span",{class:"material-symbols-outlined"},"account_circle",-1)),a[11]||(a[11]=l("h3",{class:"md3-title-medium"},"Connectez-vous",-1)),a[12]||(a[12]=l("p",{class:"md3-body-medium"},"Connectez-vous pour voir vos statistiques et votre position dans le classement",-1)),l("button",{onClick:a[0]||(a[0]=s=>t.showAuthModal=!0),class:"btn-primary"}," Se connecter ")])])),l("div",R,[a[14]||(a[14]=l("h2",{class:"md3-title-medium dinor-text-primary"},"Top 10",-1)),t.topPlayers.length?(y(),r("div",$,[(y(!0),r(d,null,u(t.topPlayers.slice(0,3),(s,a)=>(y(),r("div",{key:s.id,class:o(["podium-item",`rank-${a+1}`])},[l("div",B,[l("span",D,c(t.getPodiumIcon(a+1)),1)]),l("div",F,[l("div",N,c(s.user.name),1),l("div",T,c(s.total_points)+" pts",1),l("div",G,c(s.accuracy_percentage)+"% précision",1)])],2))),128))])):i("",!0),t.leaderboard.length?(y(),r("div",H,[(y(!0),r(d,null,u(t.leaderboard,(s,a)=>(y(),r("div",{key:s.id,class:o(["leaderboard-item",{"current-user":t.isCurrentUser(s)}])},[l("div",J,[l("span",{class:o(["rank-badge",t.getRankClass(a+1)])},c(a+1),3)]),l("div",K,[l("div",O,[m(c(s.user.name)+" ",1),t.isCurrentUser(s)?(y(),r("span",Q,"Vous")):i("",!0)]),l("div",W,[l("span",X,c(s.total_predictions)+" pronostics",1),l("span",Y,c(s.correct_scores)+" scores exacts",1)])]),l("div",Z,[l("div",ss,c(s.total_points)+" pts",1),l("div",as,c(s.accuracy_percentage)+"%",1)]),s.rank_change?(y(),r("div",es,[s.rank_change>0?(y(),r("span",ts,"keyboard_arrow_up")):(y(),r("span",rs,"keyboard_arrow_down")),l("span",null,c(Math.abs(s.rank_change)),1)])):i("",!0)],2))),128))])):(y(),r("div",ls,a[13]||(a[13]=[l("div",{class:"empty-icon"},[l("span",{class:"material-symbols-outlined"},"leaderboard")],-1),l("h3",{class:"md3-title-medium"},"Aucun classement",-1),l("p",{class:"md3-body-medium dinor-text-gray"},"Le classement apparaîtra dès que les premiers pronostics seront faits.",-1)])))]),l("div",ns,[l("button",{onClick:a[1]||(a[1]=(...s)=>t.refreshLeaderboard&&t.refreshLeaderboard(...s)),disabled:t.refreshing,class:"btn-secondary refresh-btn"},[a[15]||(a[15]=l("span",{class:"material-symbols-outlined"},"refresh",-1)),t.refreshing?(y(),r("span",os,"Mise à jour...")):(y(),r("span",cs,"Actualiser le classement"))],8,is)])]))]),n(ds,{modelValue:t.showAuthModal,"onUpdate:modelValue":a[2]||(a[2]=s=>t.showAuthModal=s),onAuthenticated:t.handleAuthenticated},null,8,["modelValue","onAuthenticated"])])}],["__scopeId","data-v-5dd419fa"]]);export{ds as default};
