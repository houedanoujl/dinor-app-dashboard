import{h as t,k as e,l as i,i as a,t as s,F as n,E as o,j as l,z as r,b as d,r as c,g as u,s as p,p as m,o as v}from"./vendor.Bvrl98ec.js";import{_ as y,D as h,A as g,b as k}from"./index.dD73OAp8.js";import{B as f,u as b}from"./BannerSection.ClrLlJgH.js";import{F as w}from"./FavoriteButton.DCgE5Byr.js";import{L as A}from"./LikeButton.BKJJoEjU.js";import"./useApi.C_apnYbC.js";const B={class:"tips-list"},D={key:0,class:"loading-state"},_={key:1,class:"error-state"},L={class:"error-icon"},T={class:"md3-body-large dinor-text-gray"},z={key:2,class:"empty-state"},j={class:"empty-icon"},C={key:3,class:"content"},F={class:"tips-grid"},M=["onClick"],E={class:"tip-icon"},S={class:"tip-content"},x={class:"tip-title md3-title-medium"},I={key:0,class:"tip-description md3-body-medium dinor-text-gray"},R={class:"tip-meta"},V={key:0,class:"time"},q={class:"tip-stats"},U={class:"stat"},$={class:"stat"},G={key:0,class:"stat"};const H=y({name:"TipsList",components:{FavoriteButton:w,LikeButton:A,AuthModal:g,BannerSection:f,DinorIcon:h},setup(){const t=m(),{banners:e,loadBannersForContentType:i}=b(),a=d(()=>e.value),s=c([]),n=c(!1),o=c(null),l=c(!1),r=async()=>{n.value=!0,o.value=null;try{const t=await k.getTips();if(!t.success)throw new Error(t.message||"Failed to fetch tips");s.value=t.data}catch(t){o.value=t.message,console.error("Error fetching tips:",t)}finally{n.value=!1}},v=t=>{const{type:e,id:i,liked:a,count:n}=t.detail;if("tip"===e){const t=s.value.find(t=>t.id==i);t&&(t.is_liked=a,t.likes_count=n)}};return u(async()=>{await i("tips",!0),r(),window.addEventListener("like-updated",v)}),p(()=>{window.removeEventListener("like-updated",v)}),{tips:s,loading:n,error:o,showAuthModal:l,bannersByType:a,goToTip:e=>{t.push(`/tip/${e}`)},retry:()=>{o.value=null,r()},getDifficultyLabel:t=>({beginner:"Débutant",intermediate:"Intermédiaire",advanced:"Avancé"}[t]||t),getShortDescription:t=>{if(!t)return"";const e=t.replace(/<[^>]*>/g,"");return e.length>150?e.substring(0,150)+"...":e},formatDate:t=>new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})}}},[["render",function(d,c,u,p,m,y){const h=i("BannerSection"),g=i("DinorIcon"),k=i("LikeButton"),f=i("FavoriteButton"),b=i("AuthModal");return v(),t("div",B,[e(h,{type:"tips",section:"hero",banners:p.bannersByType},null,8,["banners"]),p.loading?(v(),t("div",D,c[6]||(c[6]=[a("div",{class:"loading-spinner"},null,-1),a("p",null,"Chargement des astuces...",-1)]))):p.error?(v(),t("div",_,[a("div",L,[e(g,{name:"error",size:32})]),c[7]||(c[7]=a("h2",{class:"md3-title-large"},"Erreur de chargement",-1)),a("p",T,s(p.error),1),a("button",{onClick:c[0]||(c[0]=(...t)=>p.retry&&p.retry(...t)),class:"btn-secondary"},"Réessayer")])):p.loading||0!==p.tips.length?(v(),t("div",C,[a("div",F,[(v(!0),t(n,null,o(p.tips,i=>(v(),t("div",{key:i.id,class:"tip-card md3-card md3-ripple",onClick:t=>p.goToTip(i.id)},[a("div",E,[e(g,{name:"lightbulb",size:24})]),a("div",S,[a("h3",x,s(i.title),1),i.content?(v(),t("p",I,s(p.getShortDescription(i.content)),1)):l("",!0),a("div",R,[i.created_at?(v(),t("div",V,[e(g,{name:"schedule",size:14}),a("span",null,s(p.formatDate(i.created_at)),1)])):l("",!0)]),a("div",q,[a("div",U,[e(k,{type:"tip","item-id":i.id,"initial-liked":i.is_liked||!1,"initial-count":i.likes_count||0,"show-count":!0,size:"small",variant:"minimal",onAuthRequired:c[1]||(c[1]=t=>p.showAuthModal=!0),onClick:c[2]||(c[2]=r(()=>{},["stop"]))},null,8,["item-id","initial-liked","initial-count"])]),a("div",$,[e(f,{type:"tip","item-id":i.id,"initial-favorited":!1,"initial-count":i.favorites_count||0,"show-count":!0,size:"small",variant:"minimal",onAuthRequired:c[3]||(c[3]=t=>p.showAuthModal=!0),onClick:c[4]||(c[4]=r(()=>{},["stop"]))},null,8,["item-id","initial-count"])]),i.category?(v(),t("div",G,[e(g,{name:"category",size:18}),a("span",null,s(i.category.name),1)])):l("",!0)])])],8,M))),128))])])):(v(),t("div",z,[a("div",j,[e(g,{name:"lightbulb",size:32})]),c[8]||(c[8]=a("h2",{class:"md3-title-medium"},"Aucune astuce trouvée",-1)),c[9]||(c[9]=a("p",{class:"md3-body-medium dinor-text-gray"}," Aucune astuce n'est disponible pour le moment. ",-1))])),e(b,{modelValue:p.showAuthModal,"onUpdate:modelValue":c[5]||(c[5]=t=>p.showAuthModal=t)},null,8,["modelValue"])])}],["__scopeId","data-v-2efca3fa"]]);export{H as default};
