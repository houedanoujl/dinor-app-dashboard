import{e,p as a,f as t,y as l,l as s,t as n,I as r,g as i,F as o,B as c,n as u,b as d,r as v,h as p,k as m,o as y}from"./vendor.Ckj8GOAf.js";import{_ as f,b as g}from"./index.BzhA8_-u.js";import{B as b,u as h}from"./BannerSection.Bq1H5INP.js";import{S as F}from"./SearchAndFilters.DEu3bWKw.js";import"./useApi.BWVZTY0A.js";const k={class:"events-list"},_={class:"filters-toggle"},C={class:"material-symbols-outlined"},w={class:"emoji-fallback"},T={class:"filters-container"},E={key:0,class:"loading-state"},A={key:1,class:"error-state"},L={key:2,class:"content"},j={key:0,class:"empty-state"},S={class:"md3-body-medium dinor-text-gray"},x={key:1,class:"events-container"},B=["onClick"],Q={class:"event-image"},D=["src","alt"],I={class:"event-status"},R={class:"event-content"},U={class:"event-header"},N={class:"event-title"},P={key:0,class:"event-price"},q={key:0,class:"free-badge"},z={key:1,class:"price"},G={key:0,class:"event-description"},O={class:"event-details"},$={class:"detail"},H={key:0,class:"detail"},M={key:1,class:"detail"},X={key:2,class:"detail"},J={key:1,class:"participants-info"};const K=f({name:"EventsList",components:{SearchAndFilters:F,BannerSection:b},setup(){const e=m(),{banners:a,loadBannersForContentType:t}=h(),l=d(()=>a.value),s=v([]),n=v([]),r=v(!1),i=v(null),o=v(""),c=v(!1),u=v(null),y=v({eventType:null,eventFormat:null,price:null,status:null}),f=d(()=>{let e=s.value;if(o.value.trim()){const a=o.value.toLowerCase();e=e.filter(e=>{var t,l,s,n,r,i;return(null==(t=e.title)?void 0:t.toLowerCase().includes(a))||(null==(l=e.description)?void 0:l.toLowerCase().includes(a))||(null==(s=e.short_description)?void 0:s.toLowerCase().includes(a))||(null==(n=e.location)?void 0:n.toLowerCase().includes(a))||(null==(r=e.city)?void 0:r.toLowerCase().includes(a))||(null==(i=e.organizer_name)?void 0:i.toLowerCase().includes(a))})}return u.value&&(e=e.filter(e=>e.category_id===u.value)),y.value.eventType&&(e=e.filter(e=>e.event_type===y.value.eventType)),y.value.eventFormat&&(e=e.filter(e=>e.event_format===y.value.eventFormat)),y.value.price&&("free"===y.value.price?e=e.filter(e=>e.is_free):"paid"===y.value.price&&(e=e.filter(e=>!e.is_free))),y.value.status&&(e=e.filter(e=>e.status===y.value.status)),e}),b=d(()=>Object.values(y.value).some(e=>null!==e)),F=d(()=>[{key:"eventType",label:"Type d'événement",icon:"category",allLabel:"Tous les types",options:[{value:"conference",label:"Conférence"},{value:"workshop",label:"Atelier"},{value:"seminar",label:"Séminaire"},{value:"cooking_class",label:"Cours de cuisine"},{value:"tasting",label:"Dégustation"},{value:"festival",label:"Festival"},{value:"competition",label:"Concours"},{value:"networking",label:"Networking"},{value:"exhibition",label:"Exposition"},{value:"party",label:"Fête"}]},{key:"eventFormat",label:"Format",icon:"computer",allLabel:"Tous les formats",options:[{value:"in_person",label:"En présentiel"},{value:"online",label:"En ligne"},{value:"hybrid",label:"Hybride"}]},{key:"price",label:"Tarif",icon:"payments",allLabel:"Tous les tarifs",options:[{value:"free",label:"Gratuit"},{value:"paid",label:"Payant"}]},{key:"status",label:"Statut",icon:"info",allLabel:"Tous les statuts",options:[{value:"active",label:"Actif"},{value:"upcoming",label:"À venir"},{value:"completed",label:"Terminé"}]}]),k=async()=>{r.value=!0,i.value=null;try{const e=await g.getEvents();if(!e.success)throw new Error(e.message||"Failed to fetch events");s.value=e.data}catch(e){i.value=e.message,console.error("Error fetching events:",e)}finally{r.value=!1}},_=async()=>{try{const e=await g.getEventCategories();e.success&&(n.value=e.data)}catch(e){console.warn("Error fetching event categories:",e)}};return p(async()=>{await t("events",!0),k(),_()}),{events:s,categories:n,loading:r,error:i,searchQuery:o,selectedCategory:u,selectedFilters:y,filteredEvents:f,hasActiveFilters:b,eventFilters:F,showFilters:c,bannersByType:l,goToEvent:a=>{e.push(`/event/${a}`)},retry:()=>{i.value=null,k(),_()},updateAdditionalFilter:({key:e,value:a})=>{y.value[e]=a},clearAllFilters:()=>{o.value="",u.value=null,y.value={eventType:null,eventFormat:null,price:null,status:null}},getStatusClass:e=>({active:"status-active",cancelled:"status-cancelled",completed:"status-completed",upcoming:"status-upcoming"}[e]||"status-default"),getStatusLabel:e=>({active:"Actif",cancelled:"Annulé",completed:"Terminé",upcoming:"À venir"}[e]||"Non défini"),getEventTypeLabel:e=>({festival:"Festival",cooking_class:"Cours de cuisine",tasting:"Dégustation",workshop:"Atelier",conference:"Conférence"}[e]||e),formatDate:e=>e?new Date(e).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}):"",formatTime:e=>e?new Date(`2000-01-01T${e}`).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}):"",formatPrice:(e,a="XOF")=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:a}).format(e),handleImageError:e=>{e.target.src="/images/default-event.jpg"}}}},[["render",function(d,v,p,m,f,g){const b=s("BannerSection"),h=s("SearchAndFilters");return y(),e("div",k,[a(b,{type:"events",section:"hero",banners:m.bannersByType},null,8,["banners"]),t("div",_,[t("button",{onClick:v[0]||(v[0]=e=>m.showFilters=!m.showFilters),class:"toggle-btn"},[t("span",C,n(m.showFilters?"expand_less":"expand_more"),1),t("span",w,n(m.showFilters?"▲":"▼"),1),t("span",null,n(m.showFilters?"Masquer les filtres":"Afficher les filtres"),1)])]),l(t("div",T,[a(h,{searchQuery:m.searchQuery,"onUpdate:searchQuery":v[1]||(v[1]=e=>m.searchQuery=e),selectedCategory:m.selectedCategory,"onUpdate:selectedCategory":v[2]||(v[2]=e=>m.selectedCategory=e),"search-placeholder":"Rechercher un événement...",categories:m.categories,"additional-filters":m.eventFilters,"selected-filters":m.selectedFilters,"results-count":m.filteredEvents.length,"item-type":"événement","onUpdate:additionalFilter":m.updateAdditionalFilter},null,8,["searchQuery","selectedCategory","categories","additional-filters","selected-filters","results-count","onUpdate:additionalFilter"])],512),[[r,m.showFilters]]),m.loading?(y(),e("div",E,v[6]||(v[6]=[t("div",{class:"loading-spinner"},null,-1),t("p",null,"Chargement des événements...",-1)]))):m.error?(y(),e("div",A,[v[7]||(v[7]=t("div",{class:"error-icon"},[t("span",{class:"material-symbols-outlined"},"error"),t("span",{class:"emoji-fallback"},"⚠️")],-1)),v[8]||(v[8]=t("p",{class:"md3-body-large dinor-text-gray"},"Erreur lors du chargement des événements.",-1)),t("button",{onClick:v[3]||(v[3]=(...e)=>m.retry&&m.retry(...e)),class:"retry-btn"}," Réessayer ")])):(y(),e("div",L,[m.filteredEvents.length||m.loading?(y(),e("div",x,[(y(!0),e(o,null,c(m.filteredEvents,a=>(y(),e("article",{key:a.id,onClick:e=>m.goToEvent(a.id),class:"event-card"},[t("div",Q,[t("img",{src:a.featured_image_url||"/images/default-event.jpg",alt:a.title,loading:"lazy",onError:v[5]||(v[5]=(...e)=>m.handleImageError&&m.handleImageError(...e))},null,40,D),t("div",I,[t("span",{class:u(m.getStatusClass(a.status))},n(m.getStatusLabel(a.status)),3)])]),t("div",R,[t("div",U,[t("h3",N,n(a.title),1),a.price?(y(),e("div",P,[a.is_free?(y(),e("span",q,"Gratuit")):(y(),e("span",z,n(m.formatPrice(a.price,a.currency)),1))])):i("",!0)]),a.short_description?(y(),e("p",G,n(a.short_description),1)):i("",!0),t("div",O,[t("div",$,[v[11]||(v[11]=t("span",{class:"material-symbols-outlined"},"calendar_today",-1)),v[12]||(v[12]=t("span",{class:"emoji-fallback"},"📅",-1)),t("span",null,n(m.formatDate(a.start_date)),1)]),a.start_time?(y(),e("div",H,[v[13]||(v[13]=t("span",{class:"material-symbols-outlined"},"schedule",-1)),v[14]||(v[14]=t("span",{class:"emoji-fallback"},"⏰",-1)),t("span",null,n(m.formatTime(a.start_time)),1)])):i("",!0),a.location?(y(),e("div",M,[v[15]||(v[15]=t("span",{class:"material-symbols-outlined"},"location_on",-1)),v[16]||(v[16]=t("span",{class:"emoji-fallback"},"📍",-1)),t("span",null,n(a.location),1)])):i("",!0),a.event_type?(y(),e("div",X,[v[17]||(v[17]=t("span",{class:"material-symbols-outlined"},"category",-1)),v[18]||(v[18]=t("span",{class:"emoji-fallback"},"🏷️",-1)),t("span",null,n(m.getEventTypeLabel(a.event_type)),1)])):i("",!0)]),a.max_participants?(y(),e("div",J,[v[19]||(v[19]=t("span",{class:"material-symbols-outlined"},"group",-1)),v[20]||(v[20]=t("span",{class:"emoji-fallback"},"👥",-1)),t("span",null,n(a.participants_count||0)+" / "+n(a.max_participants)+" participants",1)])):i("",!0)])],8,B))),128))])):(y(),e("div",j,[v[9]||(v[9]=t("div",{class:"empty-icon"},[t("span",{class:"material-symbols-outlined"},"calendar_today"),t("span",{class:"emoji-fallback"},"📅")],-1)),v[10]||(v[10]=t("h2",{class:"md3-title-medium"},"Aucun événement trouvé",-1)),t("p",S,n(m.searchQuery||m.selectedCategory||m.hasActiveFilters?"Aucun événement ne correspond à vos critères de recherche.":"Aucun événement n'est disponible pour le moment."),1),m.searchQuery||m.selectedCategory||m.hasActiveFilters?(y(),e("button",{key:0,onClick:v[4]||(v[4]=(...e)=>m.clearAllFilters&&m.clearAllFilters(...e)),class:"clear-filters-btn"}," Effacer tous les filtres ")):i("",!0)]))]))])}],["__scopeId","data-v-9b619adb"]]);export{K as default};
