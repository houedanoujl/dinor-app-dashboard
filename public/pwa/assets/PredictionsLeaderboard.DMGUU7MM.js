import{_ as s,A as e,u as a,d as t}from"./index.Bsia8KuI.js";import{h as r,i,k as l,j as c,q as n,l as d,t as o,e as u,F as p,E as m,f as h,A as v,r as y,g as k,o as g}from"./vendor.Bvrl98ec.js";const b={class:"predictions-leaderboard"},_={class:"md3-main-content"},f={key:0,class:"loading-container"},C={key:1,class:"leaderboard-content"},S={key:0,class:"user-stats-card"},A={class:"user-stats-header"},w={class:"stats-grid"},L={class:"stat-item"},z={class:"stat-value"},P={class:"stat-item"},M={class:"stat-value"},x={class:"stat-item"},U={class:"stat-value"},q={class:"stat-item"},j={class:"stat-value"},V={key:0,class:"rank-change"},E={key:1,class:"auth-prompt"},I={class:"auth-prompt-content"},R={class:"top-players-section"},D={key:0,class:"podium"},T={class:"podium-rank"},B={class:"podium-info"},$={class:"player-name"},F={class:"player-points"},N={class:"player-accuracy"},G={key:1,class:"leaderboard-list"},H={class:"rank-number"},J={class:"player-info"},K={class:"player-name"},O={key:0,class:"you-badge"},Q={class:"player-details"},W={class:"detail-item"},X={class:"detail-item"},Y={class:"player-stats"},Z={class:"points"},ss={class:"accuracy"},es={key:0,class:"rank-change-indicator"},as={key:2,class:"empty-leaderboard"},ts={class:"empty-icon"},rs={class:"refresh-section"},is=["disabled"],ls={key:0},cs={key:1};const ns=s({name:"PredictionsLeaderboard",emits:["update-header"],components:{AuthModal:e},setup(s,{emit:e}){const r=a(),i=t(),l=y([]),c=y([]),n=y(null),d=y(!0),o=y(!1),u=y(!1),p=async()=>{try{const[s,e]=await Promise.all([r.get("/leaderboard"),r.get("/leaderboard/top?limit=10")]);s.success&&(l.value=s.data),e.success&&(c.value=e.data)}catch(s){console.error("Erreur lors du chargement du classement:",s)}},m=async()=>{if(i.isAuthenticated)try{const s=await r.get("/leaderboard/my-stats");s.success&&(n.value=s.data)}catch(s){console.error("Erreur lors du chargement des stats utilisateur:",s)}},h=async()=>{d.value=!0,await Promise.all([p(),m()]),d.value=!1};return k(()=>{h(),e("update-header",{title:"Classement",showBack:!0,backPath:"/predictions"})}),{leaderboard:l,topPlayers:c,userStats:n,loading:d,refreshing:o,showAuthModal:u,authStore:i,refreshLeaderboard:async()=>{o.value=!0;try{(await r.post("/leaderboard/refresh")).success&&await h()}catch(s){console.error("Erreur lors de la mise à jour:",s)}finally{o.value=!1}},isCurrentUser:s=>i.isAuthenticated&&s.user_id===i.userId,getRankClass:s=>1===s?"rank-gold":2===s?"rank-silver":3===s?"rank-bronze":s<=10?"rank-top10":"",getPodiumIconComponent:s=>{switch(s){case 1:return"LucideCrown";case 2:return"LucideMedal";case 3:return"LucideAward";default:return"LucideStar"}},handleAuthenticated:()=>{u.value=!1,m()}}}},[["render",function(s,e,a,t,y,k){const ns=d("LucideStar"),ds=d("LucideTrendingUp"),os=d("LucideTrendingDown"),us=d("LucideUser"),ps=d("LucideChevronUp"),ms=d("LucideChevronDown"),hs=d("LucideBarChart3"),vs=d("LucideRefreshCw"),ys=d("AuthModal");return g(),r("div",b,[i("main",_,[t.loading?(g(),r("div",f,e[3]||(e[3]=[i("div",{class:"md3-circular-progress"},null,-1),i("p",{class:"md3-body-large"},"Chargement du classement...",-1)]))):(g(),r("div",C,[e[14]||(e[14]=i("div",{class:"leaderboard-header"},[i("h1",{class:"md3-title-large dinor-text-primary"},"Classement"),i("p",{class:"md3-body-medium dinor-text-gray"},"Découvrez qui sont les meilleurs pronostiqueurs!")],-1)),t.authStore.isAuthenticated&&t.userStats?(g(),r("div",S,[i("div",A,[e[4]||(e[4]=i("h2",{class:"md3-title-medium"},"Vos statistiques",-1)),i("div",{class:n(["user-rank-badge",t.getRankClass(t.userStats.current_position)])},[l(ns,{size:20}),i("span",null,o(t.userStats.current_position?`#${t.userStats.current_position}`:"Non classé"),1)],2)]),i("div",w,[i("div",L,[i("div",z,o(t.userStats.total_points),1),e[5]||(e[5]=i("div",{class:"stat-label"},"Points",-1))]),i("div",P,[i("div",M,o(t.userStats.total_predictions),1),e[6]||(e[6]=i("div",{class:"stat-label"},"Pronostics",-1))]),i("div",x,[i("div",U,o(t.userStats.accuracy_percentage)+"%",1),e[7]||(e[7]=i("div",{class:"stat-label"},"Précision",-1))]),i("div",q,[i("div",j,o(t.userStats.correct_scores),1),e[8]||(e[8]=i("div",{class:"stat-label"},"Scores exacts",-1))])]),0!==t.userStats.rank_change?(g(),r("div",V,[t.userStats.rank_change>0?(g(),u(ds,{key:0,size:20,class:"rank-up"})):(g(),u(os,{key:1,size:20,class:"rank-down"})),i("span",null,o(Math.abs(t.userStats.rank_change))+" position"+o(Math.abs(t.userStats.rank_change)>1?"s":""),1)])):c("",!0)])):t.authStore.isAuthenticated?c("",!0):(g(),r("div",E,[i("div",I,[l(us,{size:48}),e[9]||(e[9]=i("h3",{class:"md3-title-medium"},"Connectez-vous",-1)),e[10]||(e[10]=i("p",{class:"md3-body-medium"},"Connectez-vous pour voir vos statistiques et votre position dans le classement",-1)),i("button",{onClick:e[0]||(e[0]=s=>t.showAuthModal=!0),class:"btn-primary"}," Se connecter ")])])),i("div",R,[e[13]||(e[13]=i("h2",{class:"md3-title-medium dinor-text-primary"},"Top 10",-1)),t.topPlayers.length?(g(),r("div",D,[(g(!0),r(p,null,m(t.topPlayers.slice(0,3),(s,e)=>(g(),r("div",{key:s.id,class:n(["podium-item",`rank-${e+1}`])},[i("div",T,[(g(),u(h(t.getPodiumIconComponent(e+1)),{size:32}))]),i("div",B,[i("div",$,o(s.user.name),1),i("div",F,o(s.total_points)+" pts",1),i("div",N,o(s.accuracy_percentage)+"% précision",1)])],2))),128))])):c("",!0),t.leaderboard.length?(g(),r("div",G,[(g(!0),r(p,null,m(t.leaderboard,(s,e)=>(g(),r("div",{key:s.id,class:n(["leaderboard-item",{"current-user":t.isCurrentUser(s)}])},[i("div",H,[i("span",{class:n(["rank-badge",t.getRankClass(e+1)])},o(e+1),3)]),i("div",J,[i("div",K,[v(o(s.user.name)+" ",1),t.isCurrentUser(s)?(g(),r("span",O,"Vous")):c("",!0)]),i("div",Q,[i("span",W,o(s.total_predictions)+" pronostics",1),i("span",X,o(s.correct_scores)+" scores exacts",1)])]),i("div",Y,[i("div",Z,o(s.total_points)+" pts",1),i("div",ss,o(s.accuracy_percentage)+"%",1)]),s.rank_change?(g(),r("div",es,[s.rank_change>0?(g(),u(ps,{key:0,size:16,class:"rank-up"})):(g(),u(ms,{key:1,size:16,class:"rank-down"})),i("span",null,o(Math.abs(s.rank_change)),1)])):c("",!0)],2))),128))])):(g(),r("div",as,[i("div",ts,[l(hs,{size:48})]),e[11]||(e[11]=i("h3",{class:"md3-title-medium"},"Aucun classement",-1)),e[12]||(e[12]=i("p",{class:"md3-body-medium dinor-text-gray"},"Le classement apparaîtra dès que les premiers pronostics seront faits.",-1))]))]),i("div",rs,[i("button",{onClick:e[1]||(e[1]=(...s)=>t.refreshLeaderboard&&t.refreshLeaderboard(...s)),disabled:t.refreshing,class:"btn-secondary refresh-btn"},[l(vs,{size:20}),t.refreshing?(g(),r("span",ls,"Mise à jour...")):(g(),r("span",cs,"Actualiser le classement"))],8,is)])]))]),l(ys,{modelValue:t.showAuthModal,"onUpdate:modelValue":e[2]||(e[2]=s=>t.showAuthModal=s),onAuthenticated:t.handleAuthenticated},null,8,["modelValue","onAuthenticated"])])}],["__scopeId","data-v-a961bc16"]]);export{ns as default};
