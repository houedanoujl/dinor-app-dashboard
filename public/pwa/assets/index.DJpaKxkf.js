const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Home.Du9FguLP.js","assets/vendor.CgTKjNNK.js","assets/useApi.CdDFkX3O.js","assets/BannerSection.CAZNiHOq.js","assets/BannerSection.hXsewFe2.css","assets/LikeButton.CUeMSxan.js","assets/LikeButton.Cxg4SQ2v.css","assets/Home.BQTJSwcD.css","assets/RecipesList.DRthvgZu.js","assets/SearchAndFilters.Du8oB3Fb.js","assets/SearchAndFilters.BtyA_H3d.css","assets/RecipesList.B1eUzoRy.css","assets/RecipeDetail.D0mj4iiH.js","assets/useComments.Bp6N9YRo.js","assets/Badge.DafUQRlF.js","assets/Badge.Id9DJ0yZ.css","assets/FavoriteButton.DeF1KCrM.js","assets/FavoriteButton.CJo52RHZ.css","assets/RecipeDetail.DdAzDlS4.css","assets/TipsList.BeTqAp-c.js","assets/TipsList.Cubx72i1.css","assets/TipDetail.JE04GtUK.js","assets/TipDetail.Lgfflgvx.css","assets/EventsList.CXAHH82f.js","assets/EventsList.CbJQnL3v.css","assets/EventDetail.nxB9YPed.js","assets/EventDetail.Bnc6hQw4.css","assets/PagesList.CcuBOXYV.js","assets/PagesList.C8e3BZ9t.css","assets/DinorTV.DWqjpANd.js","assets/DinorTV.B_QjgwLu.css","assets/WebEmbed.BTc4-gUO.js","assets/WebEmbed.CKL2zDmX.css","assets/Profile.ljDOh6gz.js","assets/Profile.DjXiUyff.css","assets/TermsOfService.Bip55IiF.js","assets/TermsOfService.DiEZV5Dq.css","assets/PrivacyPolicy.DcFy1qKT.js","assets/PrivacyPolicy.DeflSHSI.css","assets/CookiePolicy.CfTQYa8X.js","assets/CookiePolicy.CBPAEsFF.css","assets/Predictions.CsYJpsy_.js","assets/Predictions.BKY_LyuX.css","assets/PredictionsTeams.DbbI8WGT.js","assets/PredictionsTeams.Bxaa6x5e.css","assets/PredictionsLeaderboard.DkhXjq0y.js","assets/PredictionsLeaderboard.8cjXLrtZ.css","assets/Tournaments.BTCep8XF.js","assets/Tournaments.D85W8BP-.css"])))=>i.map(i=>d[i]);
import{c as e,a as t,r as o,d as a,b as n,e as r,f as s,g as i,t as l,n as c,o as u,u as d,w as p,h as m,i as h,j as v,k as g,l as f,F as y,m as w,p as b,q as A,s as S,v as I,T as k,x as E,y as _,z as P,A as T,B as C,C as L,D as R,E as x,G as D}from"./vendor.CgTKjNNK.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const O={},q=function(e,t,o){let a=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),o=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));a=Promise.allSettled(t.map(e=>{if((e=function(e){return"/pwa/"+e}(e))in O)return;O[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":"modulepreload",t||(n.as="script"),n.crossOrigin="",n.href=e,o&&n.setAttribute("nonce",o),document.head.appendChild(n),t?new Promise((t,o)=>{n.addEventListener("load",t),n.addEventListener("error",()=>o(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function n(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return a.then(t=>{for(const e of t||[])"rejected"===e.status&&n(e.reason);return e().catch(n)})},$=[{path:"/",name:"home",component:()=>q(()=>import("./Home.Du9FguLP.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])),meta:{title:"Accueil"}},{path:"/home",redirect:"/"},{path:"/recipes",name:"recipes",component:()=>q(()=>import("./RecipesList.DRthvgZu.js"),__vite__mapDeps([8,1,3,2,4,9,10,5,6,11])),meta:{title:"Recettes"}},{path:"/recipe/:id",name:"recipe-detail",component:()=>q(()=>import("./RecipeDetail.D0mj4iiH.js"),__vite__mapDeps([12,1,13,14,15,16,17,5,6,18])),meta:{title:"Détail Recette"},props:!0},{path:"/tips",name:"tips",component:()=>q(()=>import("./TipsList.BeTqAp-c.js"),__vite__mapDeps([19,1,3,2,4,16,17,5,6,20])),meta:{title:"Astuces"}},{path:"/tip/:id",name:"tip-detail",component:()=>q(()=>import("./TipDetail.JE04GtUK.js"),__vite__mapDeps([21,1,13,14,15,22])),meta:{title:"Détail Astuce"},props:!0},{path:"/events",name:"events",component:()=>q(()=>import("./EventsList.CXAHH82f.js"),__vite__mapDeps([23,1,3,2,4,9,10,24])),meta:{title:"Événements"}},{path:"/event/:id",name:"event-detail",component:()=>q(()=>import("./EventDetail.nxB9YPed.js"),__vite__mapDeps([25,1,13,26])),meta:{title:"Détail Événement"},props:!0},{path:"/pages",name:"pages",component:()=>q(()=>import("./PagesList.CcuBOXYV.js"),__vite__mapDeps([27,1,28])),meta:{title:"Pages"}},{path:"/dinor-tv",name:"dinor-tv",component:()=>q(()=>import("./DinorTV.DWqjpANd.js"),__vite__mapDeps([29,1,3,2,4,16,17,30])),meta:{title:"Dinor TV"}},{path:"/video/:id",redirect:e=>"/dinor-tv"},{path:"/web-embed",name:"web-embed",component:()=>q(()=>import("./WebEmbed.BTc4-gUO.js"),__vite__mapDeps([31,1,2,32])),meta:{title:"Web Embed"}},{path:"/profile",name:"profile",component:()=>q(()=>import("./Profile.ljDOh6gz.js"),__vite__mapDeps([33,1,34])),meta:{title:"Profil"}},{path:"/terms",name:"terms-of-service",component:()=>q(()=>import("./TermsOfService.Bip55IiF.js"),__vite__mapDeps([35,1,36])),meta:{title:"Conditions Générales d'Utilisation"}},{path:"/privacy",name:"privacy-policy",component:()=>q(()=>import("./PrivacyPolicy.DcFy1qKT.js"),__vite__mapDeps([37,1,38])),meta:{title:"Politique de Confidentialité"}},{path:"/cookies",name:"cookie-policy",component:()=>q(()=>import("./CookiePolicy.CfTQYa8X.js"),__vite__mapDeps([39,1,40])),meta:{title:"Politique des Cookies"}},{path:"/predictions",name:"predictions",component:()=>q(()=>import("./Predictions.CsYJpsy_.js"),__vite__mapDeps([41,1,42])),meta:{title:"Pronostics"}},{path:"/predictions/teams",name:"predictions-teams",component:()=>q(()=>import("./PredictionsTeams.DbbI8WGT.js"),__vite__mapDeps([43,1,44])),meta:{title:"Équipes"}},{path:"/predictions/leaderboard",name:"predictions-leaderboard",component:()=>q(()=>import("./PredictionsLeaderboard.DkhXjq0y.js"),__vite__mapDeps([45,1,46])),meta:{title:"Classement"}},{path:"/predictions/tournaments",name:"predictions-tournaments",component:()=>q(()=>import("./Tournaments.BTCep8XF.js"),__vite__mapDeps([47,1,48])),meta:{title:"Tournois"}},{path:"/:pathMatch(.*)*",redirect:"/"}],M=e({history:t("/pwa/"),routes:$});M.beforeEach((e,t,o)=>{e.meta.title&&(document.title=`${e.meta.title} - Dinor App`),o()});const F=()=>{const e=o(!1),t=o(!1),a={facebook:(e,t)=>`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(e)}`,twitter:(e,t,o)=>`https://twitter.com/intent/tweet?url=${encodeURIComponent(e)}&text=${encodeURIComponent(o||t)}`,whatsapp:(e,t,o)=>`https://wa.me/?text=${encodeURIComponent((o||t)+" "+e)}`,linkedin:(e,t,o)=>`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(e)}`,telegram:(e,t,o)=>`https://t.me/share/url?url=${encodeURIComponent(e)}&text=${encodeURIComponent(o||t)}`,email:(e,t,o)=>`mailto:?subject=${encodeURIComponent(t)}&body=${encodeURIComponent((o||t)+"\n\n"+e)}`,pinterest:(e,t,o)=>`https://pinterest.com/pin/create/button/?url=${encodeURIComponent(e)}&description=${encodeURIComponent(t)}${o?"&media="+encodeURIComponent(o):""}`},n=async t=>{if(navigator.share)try{return e.value=!0,await navigator.share({title:t.title,text:t.text||t.title,url:t.url||window.location.href}),!0}catch(o){return"AbortError"!==o.name&&console.error("Erreur de partage:",o),!1}finally{e.value=!1}return!1};return{isSharing:e,showShareModal:t,share:async e=>{await n(e)||(t.value=!0)},shareNative:n,shareToSocial:async(e,t)=>{console.log("🌐 [useSocialShare] shareToSocial appelé avec:",{platform:e,data:t});const{url:o=window.location.href,title:n=document.title,text:r,image:s}=t;if(a[e]){const l=a[e](o,n,r,s);if(console.log("🔗 [useSocialShare] URL de partage générée:",l),window.innerWidth>768&&"email"!==e){console.log("💻 [useSocialShare] Ouverture en popup (desktop)");const e=600,t=400,o=(window.innerWidth-e)/2,a=(window.innerHeight-t)/2;window.open(l,"share-popup",`width=${e},height=${t},left=${o},top=${a},toolbar=no,menubar=no`)}else console.log("📱 [useSocialShare] Ouverture en nouvel onglet (mobile/email)"),window.open(l,"_blank");if(t.type&&t.id)try{await fetch("/api/v1/shares/track",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({type:t.type,id:t.id,platform:e})})}catch(i){console.error("Erreur lors du tracking du partage:",i)}"undefined"!=typeof gtag&&gtag("event","share",{method:e,content_type:t.type||"content",item_id:t.id})}else console.error("❌ [useSocialShare] Plateforme non supportée:",e)},copyLink:async(e=window.location.href)=>{try{return await navigator.clipboard.writeText(e),!0}catch(t){const a=document.createElement("textarea");a.value=e,a.style.position="fixed",a.style.left="-999999px",document.body.appendChild(a),a.select();try{return document.execCommand("copy"),document.body.removeChild(a),!0}catch(o){return document.body.removeChild(a),!1}}},closeShareModal:()=>{t.value=!1},updateOpenGraphTags:e=>{const{title:t,description:o,image:a,url:n}=e;document.querySelectorAll('meta[property^="og:"]').forEach(e=>e.remove());const r=document.getElementsByTagName("head")[0];if(t){const e=document.createElement("meta");e.setAttribute("property","og:title"),e.content=t,r.appendChild(e)}if(o){const e=document.createElement("meta");e.setAttribute("property","og:description"),e.content=o,r.appendChild(e)}if(a){const e=document.createElement("meta");e.setAttribute("property","og:image"),e.content=a.startsWith("http")?a:`${window.location.origin}${a}`,r.appendChild(e)}const s=document.createElement("meta");s.setAttribute("property","og:url"),s.content=n||window.location.href,r.appendChild(s);const i=document.createElement("meta");i.setAttribute("property","og:type"),i.content="article",r.appendChild(i);const l=document.createElement("meta");l.setAttribute("property","og:site_name"),l.content="Dinor",r.appendChild(l)}}},V=a("cache",()=>{const e=o(new Map),t=o(new Map),a=o(3e5);function n(o){const a=t.value.get(o);return!a||Date.now()>a?(e.value.delete(o),t.value.delete(o),null):e.value.get(o)}function r(){const o=Date.now();for(const[a,n]of t.value.entries())o>n&&(e.value.delete(a),t.value.delete(a))}return setInterval(r,3e4),{defaultTTL:a,set:function(o,n,r=a.value){e.value.set(o,n),t.value.set(o,Date.now()+r)},get:n,has:function(e){return null!==n(e)},remove:function(o){e.value.delete(o),t.value.delete(o)},clear:function(){e.value.clear(),t.value.clear()},clearExpired:r,getCacheInfo:function(){return{size:e.value.size,keys:Array.from(e.value.keys()),expired:Array.from(t.value.entries()).filter(([,e])=>Date.now()>e).map(([e])=>e)}}}}),j=a("api",()=>{const e=o(new Map),t=o(new Map),a=o(`${window.location.origin}/api/v1`);V();const r=N();const s=n(()=>t=>e.value.get(t)||!1),i=n(()=>e=>t.value.get(e)||null);function l(t,o){o?e.value.set(t,!0):e.value.delete(t)}function c(e,o){o?t.value.set(e,o):t.value.delete(e)}async function u(e,t={}){const o=`${e}_${JSON.stringify(t)}`;console.log("🌐 [API Store] Nouvelle requête:",{endpoint:e,options:t,cacheKey:o}),console.log("🌐 [API Store] Communication directe avec l'API (cache désactivé)"),l(o,!0),c(o,null);try{const o=`${a.value}${e}`;console.log("📡 [API Store] URL complète:",o);const s={headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest",...t.headers},...t};r.token&&(s.headers.Authorization=`Bearer ${r.token}`,console.log("🔐 [API Store] Token d'authentification ajouté")),console.log("⚙️ [API Store] Configuration de la requête:",s),console.log("🚀 [API Store] Envoi de la requête fetch...");const i=await fetch(o,s);if(console.log("📩 [API Store] Réponse reçue:",{status:i.status,ok:i.ok}),!i.ok){if(console.error("❌ [API Store] Erreur HTTP:",i.status,i.statusText),401===i.status){console.warn("🔐 [API Store] Erreur 401 - Session expirée ou utilisateur non connecté"),r.token&&(console.log("🗑️ [API Store] Suppression de la session expirée"),r.clearAuth());const e=new Error("Vous devez être connecté pour effectuer cette action. Veuillez vous connecter ou créer un compte.");throw e.type="AUTH_REQUIRED",e.status=401,e.actionRequired="LOGIN_OR_REGISTER",e}let e=null;try{e=await i.json(),console.log("📄 [API Store] Données d'erreur détaillées:",e)}catch(n){console.warn("⚠️ [API Store] Impossible de parser les données d'erreur JSON")}let t=`Erreur ${i.status}`;switch(i.status){case 403:t="Accès non autorisé. Vous n'avez pas les permissions nécessaires.";break;case 404:t="Ressource non trouvée.";break;case 422:t=(null==e?void 0:e.message)?e.message:"Données invalides. Veuillez vérifier vos informations.";break;case 429:t="Trop de requêtes. Veuillez patienter avant de réessayer.";break;case 500:t="Erreur du serveur. Veuillez réessayer plus tard.";break;case 503:t="Service temporairement indisponible. Veuillez réessayer plus tard.";break;default:t=`Erreur de connexion (${i.status}). Veuillez vérifier votre connexion internet.`}const o=new Error(t);throw o.status=i.status,o.type="HTTP_ERROR",e&&(o.response={data:e}),o}console.log("🔄 [API Store] Parsing JSON...");const l=await i.json();return console.log("✅ [API Store] Données JSON reçues:",l),l}catch(s){throw console.error("💥 [API Store] Erreur lors de la requête:",s),c(o,s.message),s}finally{l(o,!1),console.log("🏁 [API Store] Fin de la requête:",e)}}function d(e){console.log("🗑️ [API Store] Invalidation du cache:",e,"- Cache désactivé, requête directe à l'API"),"serviceWorker"in navigator&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({type:"INVALIDATE_CACHE",pattern:e})}return"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",e=>{e.data&&"CACHE_INVALIDATED"===e.data.type&&(console.log("🔄 [API Store] Cache invalidé par le Service Worker:",e.data),d(e.data.pattern||""))}),{loading:e,errors:t,baseURL:a,isLoading:s,getError:i,setLoading:l,setError:c,request:u,get:async function(e,t={},o={}){const a=new URLSearchParams(t).toString();return u(a?`${e}?${a}`:e,{...o,method:"GET"})},getFresh:async function(e,t={},o={}){const a=new URLSearchParams(t).toString();return u(a?`${e}?${a}`:e,{...o,method:"GET"})},post:async function(e,t,o={}){return u(e,{...o,method:"POST",body:JSON.stringify(t)})},put:async function(e,t,o={}){return u(e,{...o,method:"PUT",body:JSON.stringify(t)})},del:async function(e,t={}){return u(e,{...t,method:"DELETE"})},invalidateCache:d,forceRefresh:function(){console.log("🔄 [API Store] Rechargement forcé demandé - Cache désactivé, requête directe à l'API"),"serviceWorker"in navigator&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({type:"FORCE_REFRESH"})},clearAllCache:function(){console.log("🗑️ [API Store] Suppression de tout le cache - Cache désactivé, requête directe à l'API"),"serviceWorker"in navigator&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({type:"CLEAR_ALL_CACHE"})},checkPWACache:async function(e,t={}){try{const o=`${e}_${JSON.stringify(t.params||{})}`,a=await fetch("/api/pwa/cache/get",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({key:o})});if(a.ok){const e=await a.json();if(e.success&&e.cached)return e.data}}catch(o){console.log("ℹ️ [API Store] Cache PWA non accessible:",o.message)}return null},setPWACache:async function(e,t,o={}){try{const a=`${e}_${JSON.stringify(o.params||{})}`,n=o.cacheTTL||3600;await fetch("/api/pwa/cache/set",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({key:a,value:t,ttl:n})})}catch(a){console.log("ℹ️ [API Store] Cache PWA non accessible pour la sauvegarde")}}}});console.log("🚀 [Auth Store] Store d'authentification chargé avec les modifications!");const N=a("auth",()=>{const e=o(JSON.parse(localStorage.getItem("auth_user")||"null")),t=o(localStorage.getItem("auth_token")||null),a=o(!1),r=o(null),s=j(),i=n(()=>!!t.value&&!!e.value),l=n(()=>{var t;return(null==(t=e.value)?void 0:t.name)||""}),c=n(()=>{var t;return(null==(t=e.value)?void 0:t.email)||""}),u=e=>{t.value=e,e?localStorage.setItem("auth_token",e):localStorage.removeItem("auth_token")},d=t=>{e.value=t,t?localStorage.setItem("auth_user",JSON.stringify(t)):localStorage.removeItem("auth_user")},p=()=>{const o=localStorage.getItem("auth_token"),a=localStorage.getItem("auth_user");if(o&&a){t.value=o;try{const t=JSON.parse(a);t&&"object"==typeof t?(e.value=t,console.log("🔍 [Auth Store] Utilisateur restauré:",t)):(console.warn("🔍 [Auth Store] Données utilisateur invalides"),m())}catch(n){console.error("🔍 [Auth Store] Erreur parsing utilisateur:",n),m()}}},m=()=>{e.value=null,t.value=null,localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user")};return p(),{user:e,token:t,loading:a,error:r,isAuthenticated:i,userName:l,userEmail:c,register:async e=>{a.value=!0,r.value=null;try{console.log("🔐 [Auth] Tentative d'inscription avec les données:",e),console.log("🔐 [Auth] Store API utilisé:",!!s);const t=await s.post("/auth/register",e);if(console.log("📄 [Auth] Données de réponse:",t),t.success)return u(t.data.token),d(t.data.user),console.log("✅ [Auth] Inscription réussie pour:",t.data.user.name),{success:!0,user:t.data.user};throw new Error(t.message||"Erreur lors de l'inscription")}catch(t){return console.error("❌ [Auth] Erreur d'inscription:",t.message),console.error("❌ [Auth] Stack trace:",t.stack),r.value=t.message,{success:!1,error:t.message}}finally{a.value=!1}},login:async t=>{if(i.value)return console.log("✅ [Auth] Utilisateur déjà connecté, pas besoin de se reconnecter"),{success:!0,user:e.value};a.value=!0,r.value=null;try{console.log("🔐 [Auth] Tentative de connexion pour:",t.email);const e=await s.post("/auth/login",t);if(console.log("📩 [Auth] Réponse de connexion:",{success:e.success}),e.success)return u(e.data.token),d(e.data.user),console.log("✅ [Auth] Connexion réussie pour:",e.data.user.name),{success:!0,user:e.data.user};throw new Error(e.message||"Erreur lors de la connexion")}catch(o){return console.error("❌ [Auth] Erreur de connexion:",o.message),r.value=o.message,{success:!1,error:o.message}}finally{a.value=!1}},logout:async()=>{a.value=!0;try{t.value&&await s.post("/auth/logout")}catch(e){console.error("Erreur lors de la déconnexion:",e)}finally{m(),a.value=!1,console.log("👋 [Auth] Déconnexion terminée")}},getProfile:async()=>{if(!t.value)return null;try{const e=await s.get("/auth/profile");if(e.success)return d(e.data),e.data}catch(e){console.error("Erreur lors de la récupération du profil:",e),e.message.includes("401")&&m()}return null},clearAuth:m,initAuth:p}});const U=new class{constructor(){this.baseURL=this.getBaseURL()}getBaseURL(){return`${window.location.origin}/api/v1`}async request(e,t={}){const o=`${this.baseURL}${e}`,a=localStorage.getItem("auth_token");console.log("🔐 [API] Token d'authentification:",a?"***existe***":"null");const n={headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest",...a&&{Authorization:`Bearer ${a}`},...t.headers},...t};n.body&&"object"==typeof n.body&&(n.body=JSON.stringify(n.body)),console.log("📡 [API] Requête vers:",e,{method:t.method||"GET",hasAuthToken:!!a,headers:{...n.headers,Authorization:a?"***Bearer token***":void 0}});try{const t=await fetch(o,n);if(console.log("📡 [API] Réponse reçue:",{status:t.status,statusText:t.statusText,ok:t.ok}),!t.ok){401===t.status&&console.error("🔒 [API] Erreur 401 - Token invalide ou manquant");const e=await t.text();throw new Error(`HTTP error! status: ${t.status}, message: ${e}`)}const a=await t.json();return console.log("✅ [API] Réponse JSON:",{success:a.success,endpoint:e}),a}catch(r){throw console.error("❌ [API] Erreur de requête:",{endpoint:e,error:r.message,status:r.status}),r}}clearCache(){console.log("🗑️ [API] Nettoyage complet du cache"),"serviceWorker"in navigator&&"caches"in window&&caches.keys().then(e=>{e.forEach(e=>{(e.includes("api")||e.includes("dinor"))&&(console.log("🗑️ [API] Suppression cache SW:",e),caches.delete(e))})})}invalidateCache(e){console.log("🗑️ [API] Cache invalidé pour le pattern:",e,"- Cache désactivé, requête directe à l'API")}async requestFresh(e,t={}){const o=`${this.baseURL}${e}`,a=localStorage.getItem("auth_token");console.log("🔄 [API] Requête fraîche vers:",e);const n={headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest","Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0",...a&&{Authorization:`Bearer ${a}`},...t.headers},...t};n.body&&"object"==typeof n.body&&(n.body=JSON.stringify(n.body));try{const t=await fetch(o,n);if(console.log("📡 [API] Réponse fraîche reçue:",{status:t.status,statusText:t.statusText,ok:t.ok}),!t.ok){401===t.status&&console.error("🔒 [API] Erreur 401 - Token invalide ou manquant");const e=await t.text();throw new Error(`HTTP error! status: ${t.status}, message: ${e}`)}const a=await t.json();return console.log("✅ [API] Réponse fraîche JSON:",{success:a.success,endpoint:e}),a}catch(r){throw console.error("❌ [API] Erreur de requête fraîche:",{endpoint:e,error:r.message,status:r.status}),r}}async getRecipes(e={}){const t=new URLSearchParams(e).toString(),o="/recipes"+(t?`?${t}`:"");return this.request(o)}async getRecipe(e){return this.request(`/recipes/${e}`)}async getRecipesFresh(e={}){const t=new URLSearchParams(e).toString(),o="/recipes"+(t?`?${t}`:"");return this.requestFresh(o)}async getRecipeFresh(e){return this.requestFresh(`/recipes/${e}`)}async getTips(e={}){const t=new URLSearchParams(e).toString(),o="/tips"+(t?`?${t}`:"");return this.request(o)}async getTip(e){return this.request(`/tips/${e}`)}async getTipsFresh(e={}){const t=new URLSearchParams(e).toString(),o="/tips"+(t?`?${t}`:"");return this.requestFresh(o)}async getTipFresh(e){return this.requestFresh(`/tips/${e}`)}async getEvents(e={}){const t=new URLSearchParams(e).toString(),o="/events"+(t?`?${t}`:"");return this.request(o)}async getEvent(e){return this.request(`/events/${e}`)}async getEventsFresh(e={}){const t=new URLSearchParams(e).toString(),o="/events"+(t?`?${t}`:"");return this.requestFresh(o)}async getEventFresh(e){return this.requestFresh(`/events/${e}`)}async getPages(e={}){const t=new URLSearchParams(e).toString(),o="/pages"+(t?`?${t}`:"");return this.request(o)}async getPage(e){return this.request(`/pages/${e}`)}async getVideos(e={}){const t=new URLSearchParams(e).toString(),o="/dinor-tv"+(t?`?${t}`:"");return this.request(o)}async getVideo(e){return this.request(`/dinor-tv/${e}`)}async getVideosFresh(e={}){const t=new URLSearchParams(e).toString(),o="/dinor-tv"+(t?`?${t}`:"");return this.requestFresh(o)}async getVideoFresh(e){return this.requestFresh(`/dinor-tv/${e}`)}async toggleLike(e,t){const o=await this.request(`/${e}/${t}/like`,{method:"POST"});return console.log("🔄 [API] Communication directe avec l'API pour toggle like:",e,t),o}async getComments(e,t){return this.request(`/${e}/${t}/comments`)}async addComment(e,t,o){return this.request(`/${e}/${t}/comments`,{method:"POST",body:JSON.stringify({content:o})})}async getCategories(){return this.request("/categories")}async getEventCategories(){return this.request("/categories/events")}async getRecipeCategories(){return this.request("/categories/recipes")}async search(e,t=null){const o={q:e};t&&(o.type=t);const a=new URLSearchParams(o).toString();return this.request(`/search?${a}`)}async getFavorites(e={}){const t=new URLSearchParams(e).toString(),o="/favorites"+(t?`?${t}`:"");return this.request(o)}async toggleFavorite(e,t){return this.request("/favorites/toggle",{method:"POST",body:JSON.stringify({type:e,id:t})})}async checkFavorite(e,t){const o=new URLSearchParams({type:e,id:t});return this.request(`/favorites/check?${o}`)}async removeFavorite(e){return this.request(`/favorites/${e}`,{method:"DELETE"})}},H=(e,t)=>{const o=e.__vccOpts||e;for(const[a,n]of t)o[a]=n;return o},W={name:"CacheRefreshButton",props:{showText:{type:Boolean,default:!1},variant:{type:String,default:"icon",validator:e=>["icon","text","full"].includes(e)},size:{type:String,default:"medium",validator:e=>["small","medium","large"].includes(e)},pattern:{type:String,default:""}},emits:["refresh","error"],setup(e,{emit:t}){const a=j(),r=o(!1),s=n(()=>r.value?"Actualisation...":"Actualiser"),i=n(()=>(r.value,"refresh")),l=n(()=>r.value?"Actualisation en cours...":e.pattern?`Actualiser le cache pour ${e.pattern}`:"Actualiser tout le cache"),c=(e,t="info")=>{const o=document.createElement("div");o.className=`cache-notification ${t}`,o.textContent=e,Object.assign(o.style,{position:"fixed",top:"20px",right:"20px",padding:"12px 16px",borderRadius:"8px",color:"white",fontSize:"14px",fontWeight:"500",zIndex:"9999",transform:"translateX(100%)",transition:"transform 0.3s ease",maxWidth:"300px",wordWrap:"break-word"}),o.style.backgroundColor="success"===t?"#10B981":"error"===t?"#EF4444":"#3B82F6",document.body.appendChild(o),setTimeout(()=>{o.style.transform="translateX(0)"},100),setTimeout(()=>{o.style.transform="translateX(100%)",setTimeout(()=>{o.parentNode&&o.parentNode.removeChild(o)},300)},3e3)};return{loading:r,buttonText:s,icon:i,tooltip:l,handleRefresh:async()=>{if(!r.value){r.value=!0;try{if(console.log("🔄 Début de l'actualisation du cache..."),e.pattern)"function"==typeof a.invalidateCache?(a.invalidateCache(e.pattern),console.log("🔄 Cache invalidé pour le pattern:",e.pattern)):console.warn("⚠️ Méthode invalidateCache non disponible");else if("function"==typeof a.forceRefresh)a.forceRefresh(),console.log("🔄 Rechargement forcé du cache");else{if("function"!=typeof a.clearAllCache)return console.warn("⚠️ Aucune méthode de refresh disponible"),void window.location.reload();a.clearAllCache(),console.log("🔄 Cache complètement vidé")}await new Promise(e=>setTimeout(e,1e3)),t("refresh",{success:!0,pattern:e.pattern}),c("Cache actualisé avec succès","success"),setTimeout(()=>{window.location.reload()},1500)}catch(o){console.error("❌ Erreur lors de l'actualisation du cache:",o),t("error",o),c("Erreur lors de l'actualisation","error")}finally{r.value=!1}}}}}},B=["disabled","title"],z={class:"material-icons"},G={key:0,class:"btn-text"},J={key:1,class:"loading-spinner"};const X=H(W,[["render",function(e,t,o,a,n,d){return u(),r("button",{onClick:t[0]||(t[0]=(...e)=>a.handleRefresh&&a.handleRefresh(...e)),disabled:a.loading,class:c(["cache-refresh-btn",{loading:a.loading}]),title:a.tooltip},[s("i",z,l(a.icon),1),o.showText?(u(),r("span",G,l(a.buttonText),1)):i("",!0),a.loading?(u(),r("div",J)):i("",!0)],10,B)}],["__scopeId","data-v-689d0eb4"]]),K={name:"AppHeader",components:{CacheRefreshButton:X},props:{title:{type:String,required:!0},showFavorite:{type:Boolean,default:!1},favoriteType:{type:String,validator:e=>["recipe","tip","event","dinor_tv"].includes(e)},favoriteItemId:{type:[Number,String]},initialFavorited:{type:Boolean,default:!1},showShare:{type:Boolean,default:!1},backPath:{type:String,default:null}},emits:["favorite-updated","share","back","auth-required"],setup(e,{emit:t}){const a=g(),r=d(),s=N(),i=n(()=>!1),l=o("/images/LOGO_DINOR_monochrome.svg"),c=o(e.initialFavorited),u=o(!1),h=n(()=>"/"!==r.path),v=n(()=>{const t=s.isAuthenticated&&e.favoriteType&&e.favoriteItemId;return console.log("🔍 [AppHeader] canInteractWithFavorites:",{isAuthenticated:s.isAuthenticated,favoriteType:e.favoriteType,favoriteItemId:e.favoriteItemId,result:t}),t}),f=n(()=>{if("/"===r.path)return"Dinor";if(e.title)return e.title;const t={"/recipes":"Recettes","/tips":"Astuces","/events":"Événements","/dinor-tv":"Dinor TV","/pages":"Pages"};for(const[e,o]of Object.entries(t))if(r.path===e||r.path.startsWith(e+"/"))return o;return"Dinor"}),y=async()=>{if(console.log("📊 [AppHeader] === CHARGEMENT STATUT FAVORI ==="),console.log("📊 [AppHeader] Vérifications:",{isAuthenticated:s.isAuthenticated,favoriteType:e.favoriteType,favoriteItemId:e.favoriteItemId}),!s.isAuthenticated||!e.favoriteType||!e.favoriteItemId)return console.log("📊 [AppHeader] Conditions non remplies, favori = false"),void(c.value=!1);try{console.log("📡 [AppHeader] Vérification API du statut favori...");const t=await U.checkFavorite(e.favoriteType,e.favoriteItemId);console.log("📡 [AppHeader] Réponse statut favori:",t),t.success&&(c.value=t.is_favorited,console.log("✅ [AppHeader] Statut favori chargé:",t.is_favorited))}catch(t){console.warn("⚠️ [AppHeader] Erreur lors de la vérification du statut favori:",t)}console.log("📊 [AppHeader] === FIN CHARGEMENT STATUT FAVORI ===")};return p(()=>s.isAuthenticated,(e,t)=>{console.log("👀 [AppHeader] Watch authStore.isAuthenticated changé:",{oldValue:t,newValue:e,user:s.user,token:s.token?"***existe***":null}),e?(console.log("✅ [AppHeader] Utilisateur connecté - chargement statut favori"),y()):(console.log("❌ [AppHeader] Utilisateur déconnecté - favori = false"),c.value=!1)}),p(()=>e.initialFavorited,(e,t)=>{console.log("👀 [AppHeader] Watch initialFavorited changé:",{oldVal:t,newVal:e}),c.value=e}),p(()=>[e.favoriteType,e.favoriteItemId],([t,o],[a,n])=>{console.log("👀 [AppHeader] Watch favoriteType/ItemId changé:",{oldType:a,newType:t,oldId:n,newId:o,isAuthenticated:s.isAuthenticated}),s.isAuthenticated&&e.favoriteType&&e.favoriteItemId&&(console.log("🔄 [AppHeader] Rechargement statut favori suite à changement props"),y())}),m(()=>{console.log("🚀 [AppHeader] Composant monté - état initial:",{isAuthenticated:s.isAuthenticated,favoriteType:e.favoriteType,favoriteItemId:e.favoriteItemId,initialFavorited:e.initialFavorited}),s.isAuthenticated&&e.favoriteType&&e.favoriteItemId&&(console.log("🔄 [AppHeader] Chargement initial du statut favori"),y())}),{showBackButton:h,displayTitle:f,isFavorited:c,favoriteLoading:u,canInteractWithFavorites:v,handleBack:()=>{e.backPath?a.push(e.backPath):a.go(-1),t("back")},handleFavoriteToggle:async()=>{var o,a;console.log("🌟 [AppHeader] === DÉBUT TOGGLE FAVORI ==="),console.log("🌟 [AppHeader] Props reçues:",{type:e.favoriteType,itemId:e.favoriteItemId,showFavorite:e.showFavorite}),console.log("🔐 [AppHeader] État d'authentification détaillé:",{"authStore.isAuthenticated":s.isAuthenticated,"authStore.user":s.user,"authStore.token":s.token?"***existe***":null,"localStorage.auth_token":localStorage.getItem("auth_token")?"***existe***":null,"localStorage.auth_user":localStorage.getItem("auth_user")?"***existe***":null});const n=localStorage.getItem("auth_token"),r=localStorage.getItem("auth_user");if(n&&r&&!s.isAuthenticated&&(console.log("🔄 [AppHeader] Réinitialisation de l'auth store détectée"),s.initAuth(),await new Promise(e=>setTimeout(e,100)),console.log("🔄 [AppHeader] État après réinitialisation:",{"authStore.isAuthenticated":s.isAuthenticated,"authStore.user":s.user})),!s.isAuthenticated)return console.log("🔒 [AppHeader] Utilisateur non connecté - affichage modal auth"),void t("auth-required");if(!e.favoriteType||!e.favoriteItemId)return void console.error("❌ [AppHeader] Type ou ID manquant pour les favoris:",{favoriteType:e.favoriteType,favoriteItemId:e.favoriteItemId});if(u.value)return void console.log("⏳ [AppHeader] Déjà en cours de chargement");u.value=!0;const i=c.value;c.value=!c.value,console.log("🔄 [AppHeader] Mise à jour optimiste:",{previousState:i,newState:c.value});try{console.log("📡 [AppHeader] Envoi requête API toggle favori...");const n=await U.toggleFavorite(e.favoriteType,e.favoriteItemId);if(console.log("📡 [AppHeader] Réponse API reçue:",n),!n.success)throw new Error(n.message||"Erreur lors de la mise à jour des favoris");c.value=n.is_favorited,t("favorite-updated",{isFavorited:c.value,favoritesCount:(null==(o=n.data)?void 0:o.total_favorites)||0}),console.log("🌟 [AppHeader] Toggle favori réussi:",{type:e.favoriteType,id:e.favoriteItemId,favorited:c.value,favoritesCount:(null==(a=n.data)?void 0:a.total_favorites)||0})}catch(l){console.error("❌ [AppHeader] Erreur toggle favori:",l),console.error("❌ [AppHeader] Détails erreur:",{message:l.message,status:l.status,response:l.response}),c.value=i,console.log("🔄 [AppHeader] Rollback vers état précédent:",i),(l.message.includes("401")||401===l.status)&&(console.log("🔒 [AppHeader] Erreur 401 - redirection vers auth"),t("auth-required"))}finally{u.value=!1,console.log("🌟 [AppHeader] === FIN TOGGLE FAVORI ===")}},handleShare:()=>{t("share")},handleLogoError:()=>{if(console.error("❌ [AppHeader] Erreur de chargement du logo DINOR"),console.log("🔍 [AppHeader] Chemin testé:",l.value),console.log("📁 [AppHeader] Vérifiez que le fichier existe dans public/images/"),console.log("🔄 [AppHeader] Tentative avec chemin alternatif..."),"/images/LOGO_DINOR_monochrome.svg"===l.value)l.value="./images/LOGO_DINOR_monochrome.svg",console.log("🔄 [AppHeader] Nouvel essai avec:",l.value);else{console.error("💥 [AppHeader] Impossible de charger le logo externe"),console.log("🔄 [AppHeader] Utilisation du logo fallback SVG inline");const e=document.querySelector(".dinor-logo"),t=document.querySelector(".dinor-logo-fallback");e&&(e.style.display="none",console.log("👁️ [AppHeader] Logo externe masqué")),t&&(t.style.display="block",console.log("✅ [AppHeader] Logo fallback SVG affiché"))}},logoSrc:l,isDevelopment:i}}},Q={class:"md3-top-app-bar"},Y={class:"md3-app-bar-container"},Z={class:"md3-app-bar-title"},ee={class:"dinor-logo-container"},te={class:"logo-section"},oe=["src"],ae={class:"dinor-logo-fallback",style:{display:"none"},viewBox:"0 0 120 50",xmlns:"http://www.w3.org/2000/svg"},ne={class:"title-section"},re={class:"md3-title-large dinor-text-primary"},se={class:"md3-app-bar-actions"},ie=["disabled","title"],le={key:0,class:"loading-spinner-header"},ce={class:"material-icons"},ue={class:"emoji-fallback"};const de=H(K,[["render",function(e,t,o,a,n,d){const p=f("CacheRefreshButton");return u(),r("nav",Q,[s("div",Y,[a.showBackButton?(u(),r("button",{key:0,onClick:t[0]||(t[0]=(...e)=>a.handleBack&&a.handleBack(...e)),class:"md3-icon-button"},t[4]||(t[4]=[s("i",{class:"material-icons"},"arrow_back",-1),s("span",{class:"emoji-fallback"},"⬅️",-1)]))):i("",!0),s("div",Z,[s("div",ee,[s("div",te,[s("img",{src:a.logoSrc,alt:"Dinor",class:"dinor-logo",onError:t[1]||(t[1]=(...e)=>a.handleLogoError&&a.handleLogoError(...e))},null,40,oe),(u(),r("svg",ae,t[5]||(t[5]=[s("text",{x:"15",y:"32","font-family":"Arial, sans-serif","font-size":"22","font-weight":"bold",fill:"white"},"DINOR",-1)])))]),s("div",ne,[s("h1",re,l(a.displayTitle),1)])])]),s("div",se,[a.isDevelopment?(u(),h(p,{key:0,size:"small"})):i("",!0),v(e.$slots,"actions",{},()=>[o.showFavorite?(u(),r("button",{key:0,onClick:t[2]||(t[2]=(...e)=>a.handleFavoriteToggle&&a.handleFavoriteToggle(...e)),class:c(["md3-icon-button",{liked:a.isFavorited,loading:a.favoriteLoading}]),disabled:a.favoriteLoading||!a.canInteractWithFavorites,title:a.isFavorited?"Retirer des favoris":"Ajouter aux favoris"},[a.favoriteLoading?(u(),r("div",le)):(u(),r(y,{key:1},[s("i",ce,l(a.isFavorited?"favorite":"favorite_border"),1),s("span",ue,l(a.isFavorited?"❤️":"🤍"),1)],64))],10,ie)):i("",!0),o.showShare?(u(),r("button",{key:1,onClick:t[3]||(t[3]=(...e)=>a.handleShare&&a.handleShare(...e)),class:"md3-icon-button"},t[6]||(t[6]=[s("i",{class:"material-icons"},"share",-1),s("span",{class:"emoji-fallback"},"📤",-1)]))):i("",!0)])])])])}],["__scopeId","data-v-42166ba7"]]),pe={class:"bottom-navigation"},me={class:"nav-items"},he={class:"nav-icon"},ve={class:"material-icons"},ge={class:"emoji-fallback"},fe={class:"nav-label"};const ye=H({name:"BottomNavigation",setup(){const e=d();g();return{navItems:o([{name:"all",path:"/",icon:"apps",label:"Accueil"},{name:"recipes",path:"/recipes",icon:"restaurant",label:"Recettes"},{name:"tips",path:"/tips",icon:"lightbulb",label:"Astuces"},{name:"events",path:"/events",icon:"event",label:"Événements"},{name:"dinor-tv",path:"/dinor-tv",icon:"play_circle",label:"DinorTV"},{name:"pages",path:"/pages",icon:"web",label:"Web"},{name:"profile",path:"/profile",icon:"person",label:"Profil"}]),isActive:t=>e.path===t||"/"!==t&&e.path.startsWith(t),getEmojiForIcon:e=>({apps:"🏠",home:"🏠",restaurant:"🍴",lightbulb:"💡",event:"📅",calendar_today:"📅",tv:"📺",play_circle:"📺",web:"🌐",person:"👤",menu_book:"📖",info:"ℹ️",settings:"⚙️"}[e]||"•")}}},[["render",function(e,t,o,a,n,i){const d=f("router-link");return u(),r("nav",pe,[s("div",me,[(u(!0),r(y,null,w(a.navItems,e=>(u(),h(d,{key:e.name,to:e.path,class:c(["nav-item",{active:a.isActive(e.path)}])},{default:b(()=>[s("div",he,[s("i",ve,l(e.icon),1),s("span",ge,l(a.getEmojiForIcon(e.icon)),1)]),s("span",fe,l(e.label),1)]),_:2},1032,["to","class"]))),128))])])}],["__scopeId","data-v-df7f11c2"]]),we=a("app",()=>{const e=o(!1),t=o(null),a=o(navigator.onLine),n=o(null),r=o(!1);function s(e){a.value=e}function i(e){n.value=e}function l(e){r.value=e}return{loading:e,error:t,online:a,installPromptEvent:n,isInstalled:r,setLoading:function(t){e.value=t},setError:function(e){t.value=e},clearError:function(){t.value=null},setOnlineStatus:s,setInstallPromptEvent:i,setInstallationStatus:l,showInstallPrompt:async function(){if(!n.value)return!1;try{const e="accepted"===(await n.value.prompt()).outcome;return e&&(l(!0),i(null)),e}catch(e){return console.error("Install prompt failed:",e),!1}},initializeNetworkListeners:function(){window.addEventListener("online",()=>s(!0)),window.addEventListener("offline",()=>s(!1))},initializePWAListeners:function(){window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),i(e)}),window.addEventListener("appinstalled",()=>{l(!0),i(null)}),window.matchMedia("(display-mode: standalone)").matches&&l(!0)}}}),be={class:"prompt-content"},Ae={class:"prompt-actions"};const Se=H({name:"InstallPrompt",setup(){const e=we(),t=o(!1),a=o(!1),r=n(()=>e.installPromptEvent&&!e.isInstalled&&!a.value);return m(()=>{sessionStorage.getItem("pwa-install-dismissed")?a.value=!0:setTimeout(()=>{r.value&&(t.value=!0)},3e3)}),{showPrompt:r,visible:t,installApp:async()=>{await e.showInstallPrompt()&&(t.value=!1)},dismissPrompt:()=>{a.value=!0,t.value=!1,sessionStorage.setItem("pwa-install-dismissed","true")}}}},[["render",function(e,t,o,a,n,l){return a.showPrompt?(u(),r("div",{key:0,class:c(["install-prompt",{visible:a.visible}])},[s("div",be,[t[2]||(t[2]=s("div",{class:"prompt-icon"},[s("span",{class:"material-symbols-outlined"},"download")],-1)),t[3]||(t[3]=s("div",{class:"prompt-text"},[s("h3",null,"Installer Dinor App"),s("p",null,"Installez l'app pour une meilleure expérience")],-1)),s("div",Ae,[s("button",{onClick:t[0]||(t[0]=(...e)=>a.dismissPrompt&&a.dismissPrompt(...e)),class:"btn-dismiss"}," Plus tard "),s("button",{onClick:t[1]||(t[1]=(...e)=>a.installApp&&a.installApp(...e)),class:"btn-install"}," Installer ")])])],2)):i("",!0)}],["__scopeId","data-v-003a7eb4"]]),Ie={name:"LoadingScreen",props:{visible:{type:Boolean,default:!0},duration:{type:Number,default:3e3}},emits:["complete"],setup(e,{emit:t}){const a=o(e.visible),r=o(0),s=o(!1),i=o("/images/LOGO_DINOR_monochrome.svg"),l=[{text:"Dinor se prépare...",sub:"Chargement de l'application"},{text:"Presque prêt !",sub:"Finalisation en cours"},{text:"C'est parti !",sub:"Bienvenue sur Dinor"}],c=o(0),u=n(()=>{var e;return(null==(e=l[c.value])?void 0:e.text)||"Chargement..."}),d=n(()=>{var e;return(null==(e=l[c.value])?void 0:e.sub)||""}),p=o([]);let h=null,v=null;const g=()=>{a.value=!1,setTimeout(()=>{t("complete")},500)};return m(()=>{(()=>{p.value=[];for(let e=0;e<12;e++)p.value.push({id:e,style:{left:100*Math.random()+"%",animationDelay:3*Math.random()+"s",animationDuration:3+4*Math.random()+"s",transform:`scale(${.3+.7*Math.random()})`}})})(),e.visible&&(h=setInterval(()=>{if(r.value<100){const e=8*Math.random()+2;r.value=Math.min(100,r.value+e)}else clearInterval(h),setTimeout(()=>{g()},500)},e.duration/20),v=setInterval(()=>{c.value=(c.value+1)%l.length},e.duration/3))}),A(()=>{h&&clearInterval(h),v&&clearInterval(v)}),{isVisible:a,progress:r,logoError:s,logoSrc:i,loadingText:u,loadingSubtext:d,bubbles:p,handleLogoError:()=>{console.warn("❌ [LoadingScreen] Logo externe non trouvé, utilisation du fallback"),s.value=!0}}}},ke={class:"bubbles-container"},Ee={class:"loading-content"},_e={class:"logo-container"},Pe={class:"logo-wrapper"},Te=["src"],Ce={key:1,class:"loading-logo-fallback",viewBox:"0 0 200 80",xmlns:"http://www.w3.org/2000/svg"},Le={class:"loading-text"},Re={class:"progress-container"},xe={class:"progress-bar"},De={class:"progress-text"};const Oe=H(Ie,[["render",function(e,t,o,a,n,i){return u(),r("div",{class:c(["loading-screen",{"fade-out":!a.isVisible}])},[s("div",ke,[(u(!0),r(y,null,w(a.bubbles,e=>(u(),r("div",{key:e.id,class:"bubble",style:S(e.style)},null,4))),128))]),s("div",Ee,[s("div",_e,[s("div",Pe,[a.logoError?(u(),r("svg",Ce,t[1]||(t[1]=[s("text",{x:"30",y:"50","font-family":"Arial, sans-serif","font-size":"32","font-weight":"bold",fill:"white"},"DINOR",-1)]))):(u(),r("img",{key:0,src:a.logoSrc,alt:"Dinor",class:"loading-logo",onError:t[0]||(t[0]=(...e)=>a.handleLogoError&&a.handleLogoError(...e))},null,40,Te)),t[2]||(t[2]=s("div",{class:"logo-shine"},null,-1))]),s("div",Le,[s("h2",null,l(a.loadingText),1),s("p",null,l(a.loadingSubtext),1)])]),s("div",Re,[s("div",xe,[s("div",{class:"progress-fill",style:S({width:a.progress+"%"})},null,4),t[3]||(t[3]=s("div",{class:"progress-glow"},null,-1))]),s("div",De,l(Math.round(a.progress))+"%",1)])])],2)}],["__scopeId","data-v-b702d20a"]]),qe={class:"share-modal-content"},$e={class:"share-buttons"},Me=["onClick","aria-label"],Fe={class:"share-btn-label"},Ve={class:"share-link"},je=["value"],Ne={class:"material-icons"},Ue=H({__name:"ShareModal",props:{modelValue:{type:Boolean,default:!1},shareData:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,d=t,{shareToSocial:m,copyLink:v}=F(),g=o(null),f=o(!1),A=n(()=>window.location.href),T=[{id:"facebook",name:"Facebook",icon:"fab fa-facebook-f",color:"#1877f2"},{id:"twitter",name:"X (Twitter)",icon:"fab fa-x-twitter",color:"#1da1f2"},{id:"whatsapp",name:"WhatsApp",icon:"fab fa-whatsapp",color:"#25d366"},{id:"linkedin",name:"LinkedIn",icon:"fab fa-linkedin-in",color:"#0077b5"},{id:"telegram",name:"Telegram",icon:"fab fa-telegram-plane",color:"#0088cc"},{id:"pinterest",name:"Pinterest",icon:"fab fa-pinterest-p",color:"#e60023"},{id:"email",name:"Email",icon:"fas fa-envelope",color:"#ea4335"}],C=()=>{d("update:modelValue",!1)},L=e=>{e.target===e.currentTarget&&C()},R=async()=>{console.log("📋 [ShareModal] handleCopyLink appelé");const e=a.shareData.url||A.value;console.log("🔗 [ShareModal] URL à copier:",e);await v(e)?(console.log("✅ [ShareModal] Lien copié avec succès!"),f.value=!0,setTimeout(()=>{f.value=!1},2e3)):console.error("❌ [ShareModal] Échec de la copie du lien")};return p(()=>a.modelValue,e=>{e||(f.value=!1)}),(t,o)=>(u(),h(E,{to:"body"},[I(k,{name:"modal"},{default:b(()=>[e.modelValue?(u(),r("div",{key:0,class:"share-modal-overlay",onClick:L},[s("div",{class:"share-modal",onClick:o[0]||(o[0]=_(()=>{},["stop"]))},[s("div",{class:"share-modal-header"},[o[2]||(o[2]=s("h3",null,"Partager",-1)),s("button",{class:"close-btn",onClick:C,"aria-label":"Fermer"},o[1]||(o[1]=[s("i",{class:"material-icons"},"close",-1)]))]),s("div",qe,[s("div",$e,[(u(),r(y,null,w(T,e=>s("button",{key:e.id,onClick:t=>{return o=e.id,console.log("🚀 [ShareModal] shareToNetwork appelé avec platform:",o),console.log("📋 [ShareModal] shareData:",a.shareData),m(o,a.shareData),void setTimeout(()=>C(),500);var o},class:c(["share-btn",e.id]),"aria-label":`Partager sur ${e.name}`,style:S({"--network-color":e.color})},[s("i",{class:c([e.icon,"share-icon"])},null,2),s("span",Fe,l(e.name),1)],14,Me)),64))]),s("div",Ve,[s("input",{type:"text",value:e.shareData.url||A.value,readonly:"",ref_key:"linkInput",ref:g,class:"share-link-input"},null,8,je),s("button",{onClick:R,class:c(["copy-btn",{copied:f.value}])},[s("i",Ne,l(f.value?"check":"content_copy"),1),P(" "+l(f.value?"Copié!":"Copier"),1)],2)])])])])):i("",!0)]),_:1})]))}},[["__scopeId","data-v-4dca5d9e"]]),He={class:"auth-modal-header"},We={class:"auth-modal-content"},Be={key:0,class:"create-account-suggestion"},ze={class:"form-group"},Ge=["disabled"],Je={class:"form-group"},Xe=["disabled"],Ke=["disabled"],Qe={class:"form-group"},Ye=["disabled"],Ze={class:"form-group"},et=["disabled"],tt={class:"form-group"},ot=["disabled"],at={class:"form-group"},nt=["disabled"],rt=["disabled"],st={class:"auth-toggle"},it={key:0},lt={key:1},ct=H({__name:"AuthModal",props:{modelValue:{type:Boolean,default:!1},initialMessage:{type:String,default:""}},emits:["update:modelValue","authenticated"],setup(e,{emit:t}){const a=e,d=t,m=N(),v=o(!0),g=o(!1),f=o(""),y=T({email:"",password:""}),w=T({name:"",email:"",password:"",password_confirmation:""}),A=n(()=>a.initialMessage?a.initialMessage:m.error),S=n(()=>a.initialMessage&&!a.initialMessage.includes("erreur"));p(()=>m.error,e=>{e&&(e.includes("utilisateur introuvable")||e.includes("email not found")||e.includes("Invalid credentials")||e.includes("compte n'existe pas"))?(g.value=!0,f.value=y.email):g.value=!1});const x=()=>{d("update:modelValue",!1),O()},D=e=>{e.target===e.currentTarget&&x()},O=()=>{y.email="",y.password="",w.name="",w.email="",w.password="",w.password_confirmation="",m.error=null,g.value=!1,f.value=""},q=()=>{f.value&&(w.email=f.value),v.value=!1,g.value=!1,m.error=null},$=async()=>{if(m.isAuthenticated)return console.log("✅ [Auth Modal] Utilisateur déjà connecté, fermeture du modal"),d("authenticated",m.user),void x();g.value=!1;const e=await m.login(y);e.success&&(d("authenticated",e.user),x())},M=async()=>{const e=await m.register(w);e.success&&(d("authenticated",e.user),x())};return(t,o)=>(u(),h(E,{to:"body"},[I(k,{name:"modal"},{default:b(()=>[e.modelValue?(u(),r("div",{key:0,class:"auth-modal-overlay",onClick:D},[s("div",{class:"auth-modal",onClick:o[8]||(o[8]=_(()=>{},["stop"]))},[s("div",He,[s("h3",null,l(v.value?"Connexion":"Inscription"),1),s("button",{class:"close-btn",onClick:x,"aria-label":"Fermer"},o[9]||(o[9]=[s("span",{class:"material-symbols-outlined"},"close",-1)]))]),s("div",We,[A.value?(u(),r("div",{key:0,class:c(["error-message",{"info-message":S.value}])},[P(l(A.value)+" ",1),g.value?(u(),r("div",Be,[o[10]||(o[10]=s("p",null,"Ce compte n'existe pas encore.",-1)),s("button",{onClick:q,class:"create-account-btn"}," Créer un compte maintenant ")])):i("",!0)],2)):i("",!0),v.value?(u(),r("form",{key:1,onSubmit:_($,["prevent"]),class:"auth-form"},[s("div",ze,[o[11]||(o[11]=s("label",{for:"email"},"Email",-1)),C(s("input",{id:"email","onUpdate:modelValue":o[0]||(o[0]=e=>y.email=e),type:"email",required:"",disabled:L(m).loading,class:"form-input",placeholder:"votre@email.com"},null,8,Ge),[[R,y.email]])]),s("div",Je,[o[12]||(o[12]=s("label",{for:"password"},"Mot de passe",-1)),C(s("input",{id:"password","onUpdate:modelValue":o[1]||(o[1]=e=>y.password=e),type:"password",required:"",disabled:L(m).loading,class:"form-input",placeholder:"Votre mot de passe"},null,8,Xe),[[R,y.password]])]),s("button",{type:"submit",disabled:L(m).loading,class:"submit-btn"},l(L(m).loading?"Connexion...":"Se connecter"),9,Ke)],32)):(u(),r("form",{key:2,onSubmit:_(M,["prevent"]),class:"auth-form"},[s("div",Qe,[o[13]||(o[13]=s("label",{for:"name"},"Nom",-1)),C(s("input",{id:"name","onUpdate:modelValue":o[2]||(o[2]=e=>w.name=e),type:"text",required:"",disabled:L(m).loading,class:"form-input",placeholder:"Votre nom"},null,8,Ye),[[R,w.name]])]),s("div",Ze,[o[14]||(o[14]=s("label",{for:"register-email"},"Email",-1)),C(s("input",{id:"register-email","onUpdate:modelValue":o[3]||(o[3]=e=>w.email=e),type:"email",required:"",disabled:L(m).loading,class:"form-input",placeholder:"votre@email.com"},null,8,et),[[R,w.email]])]),s("div",tt,[o[15]||(o[15]=s("label",{for:"register-password"},"Mot de passe",-1)),C(s("input",{id:"register-password","onUpdate:modelValue":o[4]||(o[4]=e=>w.password=e),type:"password",required:"",disabled:L(m).loading,class:"form-input",placeholder:"Au moins 8 caractères"},null,8,ot),[[R,w.password]])]),s("div",at,[o[16]||(o[16]=s("label",{for:"password-confirmation"},"Confirmer le mot de passe",-1)),C(s("input",{id:"password-confirmation","onUpdate:modelValue":o[5]||(o[5]=e=>w.password_confirmation=e),type:"password",required:"",disabled:L(m).loading,class:"form-input",placeholder:"Confirmez votre mot de passe"},null,8,nt),[[R,w.password_confirmation]])]),s("button",{type:"submit",disabled:L(m).loading,class:"submit-btn"},l(L(m).loading?"Inscription...":"S'inscrire"),9,rt)],32)),s("div",st,[v.value?(u(),r("p",it,[o[17]||(o[17]=P(" Pas encore de compte ? ")),s("button",{onClick:o[6]||(o[6]=e=>v.value=!1),class:"toggle-btn"},"S'inscrire")])):(u(),r("p",lt,[o[18]||(o[18]=P(" Déjà un compte ? ")),s("button",{onClick:o[7]||(o[7]=e=>v.value=!0),class:"toggle-btn"},"Se connecter")]))])])])])):i("",!0)]),_:1})]))}},[["__scopeId","data-v-51929462"]]),ut={key:1,id:"app"},dt={class:"app-container"};const pt=H({name:"App",components:{AppHeader:de,BottomNavigation:ye,InstallPrompt:Se,LoadingScreen:Oe,ShareModal:Ue,AuthModal:ct},setup(){const e=d(),t=g(),{share:a,showShareModal:r}=F();N();const s=o({}),i=o(!1),l=o("Dinor"),c=o(!1),u=o(null),h=o(null),v=o(!1),f=o(!1),y=o(null),w=n(()=>["/","/recipes","/tips","/events","/pages","/dinor-tv"].some(t=>e.path===t||"/"!==t&&e.path.startsWith(t))),b=()=>{"/"===e.path?(l.value="Dinor",c.value=!1,f.value=!1,y.value=null):"/recipes"===e.path?(l.value="Recettes",c.value=!1,f.value=!1,y.value=null):"/tips"===e.path?(l.value="Astuces",c.value=!1,f.value=!1,y.value=null):"/events"===e.path?(l.value="Événements",c.value=!1,f.value=!1,y.value=null):"/dinor-tv"===e.path?(l.value="Dinor TV",c.value=!1,f.value=!1,y.value=null):"/pages"===e.path?(l.value="Pages",c.value=!1,f.value=!1,y.value=null):e.path.startsWith("/recipe/")?(l.value="Recette",c.value=!0,f.value=!0,y.value="/recipes"):e.path.startsWith("/tip/")?(l.value="Astuce",c.value=!0,f.value=!0,y.value="/tips"):e.path.startsWith("/event/")?(l.value="Événement",c.value=!0,f.value=!0,y.value="/events"):(l.value="Dinor",c.value=!1,f.value=!1,y.value="/")};p(()=>e.path,b,{immediate:!0});const A=o(null);b();const S=o(!0);return m(()=>{console.log("🚀 [App] Application démarrée avec loading screen")}),{showBottomNav:w,currentPageTitle:l,showFavoriteButton:c,favoriteType:u,favoriteItemId:h,isContentFavorited:v,showShareButton:f,backPath:y,currentView:A,updateHeader:e=>{e.title&&(l.value=e.title),void 0!==e.showFavorite&&(c.value=e.showFavorite),void 0!==e.favoriteType&&(u.value=e.favoriteType),void 0!==e.favoriteItemId&&(h.value=e.favoriteItemId),void 0!==e.isContentFavorited&&(v.value=e.isContentFavorited),void 0!==e.showShare&&(f.value=e.showShare),void 0!==e.backPath&&(y.value=e.backPath)},handleLike:()=>{A.value&&A.value.toggleLike&&A.value.toggleLike()},handleShare:()=>{console.log("🎯 [App] handleShare appelé!");const t={title:l.value||"Dinor",text:`Découvrez ${l.value} sur Dinor`,url:window.location.href};e.path.startsWith("/recipe/")?(t.text="Découvrez cette délicieuse recette sur Dinor",t.type="recipe",t.id=e.params.id):e.path.startsWith("/tip/")?(t.text="Découvrez cette astuce pratique sur Dinor",t.type="tip",t.id=e.params.id):e.path.startsWith("/event/")&&(t.text="Ne manquez pas cet événement sur Dinor",t.type="event",t.id=e.params.id),s.value=t,console.log("🚀 [App] Déclenchement du partage avec:",t),a(t)},handleBack:()=>{y.value?t.push(y.value):t.go(-1)},handleFavoriteUpdate:e=>{console.log("🌟 [App] Favori mis à jour:",e),v.value=e.isFavorited,A.value&&A.value.handleFavoriteUpdate&&A.value.handleFavoriteUpdate(e)},handleAuthRequired:()=>{console.log("🔒 [App] Authentification requise"),i.value=!0},showLoading:S,onLoadingComplete:()=>{S.value=!1,console.log("🎉 [App] Chargement terminé, app prête !")},showShareModal:r,currentShareData:s,showAuthModal:i}}},[["render",function(e,t,o,a,n,l){const d=f("LoadingScreen"),p=f("AppHeader"),m=f("router-view"),v=f("BottomNavigation"),g=f("InstallPrompt"),w=f("ShareModal"),b=f("AuthModal");return u(),r(y,null,[a.showLoading?(u(),h(d,{key:0,visible:a.showLoading,duration:2500,onComplete:a.onLoadingComplete},null,8,["visible","onComplete"])):i("",!0),a.showLoading?i("",!0):(u(),r("div",ut,[s("div",dt,[I(p,{title:a.currentPageTitle,"show-favorite":a.showFavoriteButton,"favorite-type":a.favoriteType,"favorite-item-id":a.favoriteItemId,"initial-favorited":a.isContentFavorited,"show-share":a.showShareButton,"back-path":a.backPath,onFavoriteUpdated:a.handleFavoriteUpdate,onShare:a.handleShare,onBack:a.handleBack,onAuthRequired:a.handleAuthRequired},null,8,["title","show-favorite","favorite-type","favorite-item-id","initial-favorited","show-share","back-path","onFavoriteUpdated","onShare","onBack","onAuthRequired"]),s("main",{class:c(["main-content",{"with-bottom-nav":a.showBottomNav,"with-header":!0}])},[I(m,{onUpdateHeader:a.updateHeader,onLike:a.handleLike,onShare:a.handleShare,ref:"currentView"},null,8,["onUpdateHeader","onLike","onShare"])],2),a.showBottomNav?(u(),h(v,{key:0})):i("",!0),I(g),I(w,{modelValue:a.showShareModal,"onUpdate:modelValue":t[0]||(t[0]=e=>a.showShareModal=e),"share-data":a.currentShareData},null,8,["modelValue","share-data"]),I(b,{modelValue:a.showAuthModal,"onUpdate:modelValue":t[1]||(t[1]=e=>a.showAuthModal=e)},null,8,["modelValue"])])]))],64)}]]);const mt=new class{constructor(){this.isInitialized=!1,"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?(this.appId=null,this.devMode=!0,console.log("🔧 OneSignal: Mode développement - notifications désactivées")):(this.appId="7703701f-3c33-408d-99e0-db5c4da8918a",this.devMode=!1,this.init())}async init(){if(this.devMode)console.log("🔧 OneSignal: Initialisation ignorée en mode développement");else try{window.OneSignalDeferred=window.OneSignalDeferred||[],OneSignalDeferred.push(async e=>{await e.init({appId:this.appId,allowLocalhostAsSecureOrigin:!0}),this.isInitialized=!0,console.log("✅ OneSignal initialisé avec succès"),this.setupEventListeners(),await this.requestPermission()})}catch(e){console.error("❌ Erreur lors de l'initialisation OneSignal:",e)}}setupEventListeners(){this.devMode||window.OneSignalDeferred.push(e=>{e.Notifications.addEventListener("receive",e=>{console.log("📱 Notification reçue:",e),this.onNotificationReceived(e)}),e.Notifications.addEventListener("click",e=>{console.log("👆 Notification cliquée:",e),this.onNotificationClicked(e)}),e.Notifications.addEventListener("permissionChange",e=>{console.log("🔔 Permission changée:",e),this.onPermissionChanged(e)})})}async requestPermission(){return this.devMode?(console.log("🔧 OneSignal: Permission ignorée en mode développement"),!1):new Promise(e=>{window.OneSignalDeferred.push(async t=>{try{const o=await t.Notifications.requestPermission();console.log("🔔 Permission notifications:",o),e(o)}catch(o){console.error("❌ Erreur permission:",o),e(!1)}})})}async getUserId(){return new Promise(e=>{window.OneSignalDeferred.push(async t=>{try{const o=await t.User.PushSubscription.id;e(o)}catch(o){console.error("❌ Erreur getUserId:",o),e(null)}})})}async isSubscribed(){return new Promise(e=>{window.OneSignalDeferred.push(async t=>{try{const o=await t.User.PushSubscription.optedIn;e(o)}catch(o){console.error("❌ Erreur isSubscribed:",o),e(!1)}})})}async addTags(e){return new Promise(t=>{window.OneSignalDeferred.push(async o=>{try{await o.User.addTags(e),console.log("🏷️ Tags ajoutés:",e),t(!0)}catch(a){console.error("❌ Erreur addTags:",a),t(!1)}})})}onNotificationReceived(e){var t;const o=e.notification;(null==(t=o.additionalData)?void 0:t.showAlert)&&this.showCustomAlert(o)}onNotificationClicked(e){var t;const o=e.notification;o.launchURL?window.location.href=o.launchURL:(null==(t=o.additionalData)?void 0:t.url)&&(window.location.href=o.additionalData.url)}onPermissionChanged(e){e?(console.log("🔔 Notifications activées"),this.showPermissionGrantedMessage()):console.log("🔕 Notifications désactivées")}showCustomAlert(e){const t=document.createElement("div");t.className="custom-notification-toast",t.innerHTML=`\n            <div class="toast-content">\n                <h4>${e.title}</h4>\n                <p>${e.body}</p>\n            </div>\n        `,t.style.cssText="\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            background: #333;\n            color: white;\n            padding: 15px;\n            border-radius: 8px;\n            max-width: 300px;\n            z-index: 10000;\n            box-shadow: 0 4px 12px rgba(0,0,0,0.3);\n        ",document.body.appendChild(t),setTimeout(()=>{t.remove()},5e3)}showPermissionGrantedMessage(){console.log("✅ Vous recevrez maintenant les notifications Dinor !")}},ht=x(pt),vt=D();ht.use(vt),ht.use(M);const gt=we();function ft(){console.log("🔍 [Main] Vérification du chargement de Material Symbols...");const e=document.createElement("span");e.className="material-symbols-outlined",e.textContent="home",e.style.position="absolute",e.style.left="-9999px",e.style.top="-9999px",e.style.visibility="hidden",document.body.appendChild(e),setTimeout(()=>{const t=window.getComputedStyle(e).getPropertyValue("font-family");console.log("📝 [Main] Font family détectée:",t);t.includes("Material Symbols Outlined")||t.includes("Material Symbols")?(console.log("✅ [Main] Material Symbols détecté et fonctionnel"),document.documentElement.classList.remove("force-emoji")):(console.log("⚠️ [Main] Material Symbols non détecté, activation des emoji..."),document.documentElement.classList.add("force-emoji")),document.body.removeChild(e)},100)}function yt(){navigator.onLine?(document.body.classList.remove("offline"),gt.setOnlineStatus(!0)):(document.body.classList.add("offline"),gt.setOnlineStatus(!1))}window.toggleEmojiMode=function(){document.documentElement.classList.contains("force-emoji")?(document.documentElement.classList.remove("force-emoji"),console.log("✅ [Main] Mode icônes Material Symbols activé")):(document.documentElement.classList.add("force-emoji"),console.log("🎭 [Main] Mode emoji forcé activé"))},document.fonts&&document.fonts.ready?document.fonts.ready.then(()=>{setTimeout(ft,500)}):setTimeout(ft,2e3),window.addEventListener("load",()=>{setTimeout(ft,1e3)}),console.log("🚀 [Main] Système de détection Material Symbols initialisé"),console.log("💡 [Main] Tapez toggleEmojiMode() dans la console pour basculer entre icônes et emoji"),ht.mount("#app"),ht.config.errorHandler=(e,t,o)=>{console.error("Global error:",e,o)},"serviceWorker"in navigator&&navigator.serviceWorker.register("/pwa/sw.js").then(e=>{console.log("Service Worker registered:",e)}).catch(e=>{console.error("Service Worker registration failed:",e)}),"ontouchstart"in window&&document.body.classList.add("touch-device"),window.addEventListener("online",yt),window.addEventListener("offline",yt),yt(),console.log("🔔 [Main] Initialisation du service OneSignal..."),window.oneSignalService=mt;export{ct as A,X as C,Ue as S,H as _,j as a,U as b,we as c,F as d,N as u};
