import{e,f as a,v as s,g as t,t as i,B as n,D as r,p as o,z as c,l,F as d,m as u,n as m,y as p,r as h,b as v,w as g,h as y,o as _}from"./vendor.CgTKjNNK.js";import{_ as b,A as f,a as k,u as w}from"./index.XHIxoS6z.js";const M={class:"predictions"},S={class:"md3-main-content"},A={key:0,class:"loading-container"},P={key:1,class:"predictions-content"},C={key:0,class:"current-match-section"},T={class:"match-card featured"},x={class:"match-header"},z={class:"match-teams"},E={class:"team home-team"},D=["src","alt"],I={key:1,class:"team-logo-placeholder"},V={class:"team-name"},q={class:"match-vs"},j={class:"match-date"},F={class:"team away-team"},$=["src","alt"],R={key:1,class:"team-logo-placeholder"},L={class:"team-name"},U={key:0,class:"prediction-status can-predict"},B={key:1,class:"prediction-status closed"},H={key:0,class:"prediction-form"},O={class:"score-inputs"},W={class:"score-input"},G={class:"md3-body-small"},N={class:"score-input"},X={class:"md3-body-small"},J=["disabled"],K={key:0},Q={key:1},Y={key:1,class:"auth-required"},Z={key:2,class:"user-prediction"},ee={class:"prediction-display"},ae={class:"prediction-score"},se={class:"prediction-winner"},te={key:1,class:"no-match-section"},ie={class:"no-match-card"},ne={class:"suggestions-grid"},re={class:"tournaments-section"},oe={class:"section-header"},ce={key:0,class:"tournaments-loading"},le={key:1,class:"tournaments-grid"},de=["onClick"],ue={class:"tournament-header"},me={class:"tournament-name"},pe={class:"tournament-description"},he={class:"tournament-info"},ve={class:"info-item"},ge={key:0,class:"info-item"},ye={class:"info-item"},_e={class:"tournament-actions"},be=["onClick","disabled"],fe={key:0},ke={key:1},we=["onClick"],Me={key:2,class:"tournament-closed"},Se={key:2,class:"no-tournaments-enhanced"},Ae={class:"fallback-actions"},Pe={class:"fallback-info"},Ce={class:"fallback-list"},Te={key:0},xe={class:"fallback-cta"},ze={class:"quick-actions"};const Ee=b({name:"Predictions",emits:["update-header"],components:{AuthModal:f},setup(e,{emit:a}){const s=k(),t=w(),i=h(null),n=h(null),r=h(!0),o=h(!1),c=h(!1),l=h([]),d=h(!0),u=h(null),m=h({homeScore:0,awayScore:0}),p=v(()=>null!==m.value.homeScore&&null!==m.value.awayScore&&m.value.homeScore>=0&&m.value.awayScore>=0),_=async()=>{if(t.isAuthenticated&&i.value)try{const e=await s.get(`/predictions/match/${i.value.id}`);e.success&&e.data&&(n.value=e.data,m.value={homeScore:e.data.predicted_home_score,awayScore:e.data.predicted_away_score})}catch(e){console.error("Erreur lors du chargement de la prédiction:",e)}};g(()=>t.isAuthenticated,e=>{e?_():n.value=null});return y(()=>{(async()=>{try{const e=await s.get("/matches/current/match");e.success&&e.data&&(i.value=e.data,await _())}catch(e){console.error("Erreur lors du chargement du match:",e)}finally{r.value=!1}})(),(async()=>{try{const e=await s.get("/tournaments/featured");e.success&&(l.value=e.data||[])}catch(e){console.error("Erreur lors du chargement des tournois:",e)}finally{d.value=!1}})(),a("update-header",{title:"Pronostics",showBack:!1})}),{currentMatch:i,userPrediction:n,loading:r,submitting:o,showAuthModal:c,prediction:m,canSubmitPrediction:p,authStore:t,featuredTournaments:l,loadingTournaments:d,registering:u,submitPrediction:async()=>{var e;if(p.value&&!o.value){o.value=!0;try{const e={football_match_id:i.value.id,predicted_home_score:m.value.homeScore,predicted_away_score:m.value.awayScore};let a;a=n.value?await s.put(`/predictions/${n.value.id}`,e):await s.post("/predictions",e),a.success&&(n.value=a.data,console.log("Pronostic enregistré avec succès!"))}catch(a){console.error("Erreur lors de l'envoi du pronostic:",a),(null==(e=a.message)?void 0:e.includes("401"))&&(c.value=!0)}finally{o.value=!1}}},registerToTournament:async e=>{var a;if(t.isAuthenticated){u.value=e.id;try{(await s.post(`/tournaments/${e.id}/register`,{})).success&&(e.user_is_participant=!0,e.can_register=!1,e.participants_count+=1,console.log("Inscription réussie au tournoi!"))}catch(i){console.error("Erreur lors de l'inscription:",i),(null==(a=i.message)?void 0:a.includes("401"))&&(c.value=!0)}finally{u.value=null}}else c.value=!0},openTournament:e=>{console.log("Ouverture du tournoi:",e.name)},viewTournamentLeaderboard:e=>{console.log("Classement du tournoi:",e.name)},formatMatchDate:e=>new Date(e).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),formatTournamentDate:e=>{const a=new Date(e),s=new Date,t=Math.ceil((a-s)/864e5);return t<0?"Terminé":0===t?"Aujourd'hui":1===t?"Demain":t<7?`Dans ${t} jours`:a.toLocaleDateString("fr-FR",{day:"numeric",month:"short"})},formatPrize:(e,a)=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:a||"XOF",minimumFractionDigits:0}).format(e),getPredictedWinnerText:e=>{var a,s,t,n;switch(e){case"home":return(null==(s=null==(a=i.value)?void 0:a.home_team)?void 0:s.name)||"Domicile";case"away":return(null==(n=null==(t=i.value)?void 0:t.away_team)?void 0:n.name)||"Extérieur";case"draw":return"Match nul";default:return"Inconnu"}},handleImageError:e=>{e.target.style.display="none"},handleAuthenticated:()=>{c.value=!1,_()}}}},[["render",function(h,v,g,y,b,f){const k=l("router-link"),w=l("AuthModal");return _(),e("div",M,[a("main",S,[y.loading?(_(),e("div",A,v[12]||(v[12]=[a("div",{class:"md3-circular-progress"},null,-1),a("p",{class:"md3-body-large"},"Chargement des matchs...",-1)]))):(_(),e("div",P,[v[46]||(v[46]=a("div",{class:"predictions-header"},[a("h1",{class:"md3-title-large dinor-text-primary"},"Pronostics"),a("p",{class:"md3-body-medium dinor-text-gray"},"Pariez sur vos matchs favoris et gagnez des points!")],-1)),y.currentMatch?(_(),e("div",C,[v[22]||(v[22]=a("h2",{class:"md3-title-medium dinor-text-primary"},"Match en cours",-1)),a("div",T,[a("div",x,[a("div",z,[a("div",E,[y.currentMatch.home_team.logo_url?(_(),e("img",{key:0,src:y.currentMatch.home_team.logo_url,alt:y.currentMatch.home_team.name,class:"team-logo",onError:v[0]||(v[0]=(...e)=>y.handleImageError&&y.handleImageError(...e))},null,40,D)):(_(),e("div",I,v[13]||(v[13]=[a("i",{class:"material-icons"},"sports_soccer",-1)]))),a("span",V,i(y.currentMatch.home_team.name),1)]),a("div",q,[v[14]||(v[14]=a("span",{class:"vs-text"},"VS",-1)),a("div",j,i(y.formatMatchDate(y.currentMatch.match_date)),1)]),a("div",F,[y.currentMatch.away_team.logo_url?(_(),e("img",{key:0,src:y.currentMatch.away_team.logo_url,alt:y.currentMatch.away_team.name,class:"team-logo",onError:v[1]||(v[1]=(...e)=>y.handleImageError&&y.handleImageError(...e))},null,40,$)):(_(),e("div",R,v[15]||(v[15]=[a("i",{class:"material-icons"},"sports_soccer",-1)]))),a("span",L,i(y.currentMatch.away_team.name),1)])]),y.currentMatch.can_predict?(_(),e("div",U,v[16]||(v[16]=[a("i",{class:"material-icons"},"check_circle",-1),a("span",null,"Prédictions ouvertes",-1)]))):(_(),e("div",B,v[17]||(v[17]=[a("i",{class:"material-icons"},"cancel",-1),a("span",null,"Prédictions fermées",-1)])))]),y.currentMatch.can_predict&&y.authStore.isAuthenticated?(_(),e("div",H,[v[19]||(v[19]=a("h3",{class:"md3-title-small"},"Votre pronostic",-1)),a("div",O,[a("div",W,[a("label",G,i(y.currentMatch.home_team.short_name||y.currentMatch.home_team.name),1),n(a("input",{"onUpdate:modelValue":v[2]||(v[2]=e=>y.prediction.homeScore=e),type:"number",min:"0",max:"20",class:"score-field"},null,512),[[r,y.prediction.homeScore,void 0,{number:!0}]])]),v[18]||(v[18]=a("div",{class:"score-separator"},"-",-1)),a("div",N,[a("label",X,i(y.currentMatch.away_team.short_name||y.currentMatch.away_team.name),1),n(a("input",{"onUpdate:modelValue":v[3]||(v[3]=e=>y.prediction.awayScore=e),type:"number",min:"0",max:"20",class:"score-field"},null,512),[[r,y.prediction.awayScore,void 0,{number:!0}]])])]),a("button",{onClick:v[4]||(v[4]=(...e)=>y.submitPrediction&&y.submitPrediction(...e)),disabled:!y.canSubmitPrediction||y.submitting,class:"btn-primary prediction-submit"},[y.submitting?(_(),e("span",K,"Envoi...")):(_(),e("span",Q,i(y.userPrediction?"Modifier":"Valider")+" le pronostic",1))],8,J)])):y.currentMatch.can_predict&&!y.authStore.isAuthenticated?(_(),e("div",Y,[v[20]||(v[20]=a("p",{class:"md3-body-medium"},"Connectez-vous pour faire votre pronostic",-1)),a("button",{onClick:v[5]||(v[5]=e=>y.showAuthModal=!0),class:"btn-primary"}," Se connecter ")])):t("",!0),y.userPrediction?(_(),e("div",Z,[v[21]||(v[21]=a("h3",{class:"md3-title-small"},"Votre pronostic actuel",-1)),a("div",ee,[a("span",ae,i(y.userPrediction.predicted_home_score)+" - "+i(y.userPrediction.predicted_away_score),1),a("span",se," Gagnant prédit: "+i(y.getPredictedWinnerText(y.userPrediction.predicted_winner)),1)])])):t("",!0)])])):(_(),e("div",te,[a("div",ie,[v[26]||(v[26]=a("div",{class:"no-match-icon"},[a("i",{class:"material-icons"},"sports_soccer")],-1)),v[27]||(v[27]=a("h2",{class:"md3-title-medium"},"Aucun match en cours",-1)),v[28]||(v[28]=a("p",{class:"md3-body-medium dinor-text-gray"}," Il n'y a pas de match disponible pour le moment, mais vous pouvez : ",-1)),a("div",ne,[a("div",{class:"suggestion-card",onClick:v[6]||(v[6]=e=>h.$router.push("/predictions/tournaments"))},v[23]||(v[23]=[a("div",{class:"suggestion-icon"},[a("i",{class:"material-icons"},"emoji_events")],-1),a("h3",{class:"suggestion-title"},"Explorer les tournois",-1),a("p",{class:"suggestion-desc"},"Rejoignez des tournois et participez aux compétitions",-1)])),a("div",{class:"suggestion-card",onClick:v[7]||(v[7]=e=>h.$router.push("/predictions/leaderboard"))},v[24]||(v[24]=[a("div",{class:"suggestion-icon"},[a("i",{class:"material-icons"},"leaderboard")],-1),a("h3",{class:"suggestion-title"},"Voir le classement",-1),a("p",{class:"suggestion-desc"},"Consultez les performances des autres joueurs",-1)])),a("div",{class:"suggestion-card",onClick:v[8]||(v[8]=e=>h.$router.push("/predictions/my-predictions"))},v[25]||(v[25]=[a("div",{class:"suggestion-icon"},[a("i",{class:"material-icons"},"history")],-1),a("h3",{class:"suggestion-title"},"Historique",-1),a("p",{class:"suggestion-desc"},"Revoyez vos anciens pronostics et statistiques",-1)]))])])])),a("div",re,[a("div",oe,[v[30]||(v[30]=a("h2",{class:"md3-title-medium dinor-text-primary"},"Tournois en cours",-1)),s(k,{to:"/predictions/tournaments",class:"view-all-link"},{default:o(()=>v[29]||(v[29]=[c(" Voir tout ")])),_:1,__:[29]})]),y.loadingTournaments?(_(),e("div",ce,v[31]||(v[31]=[a("div",{class:"md3-circular-progress"},null,-1),a("p",{class:"md3-body-small"},"Chargement des tournois...",-1)]))):y.featuredTournaments.length>0?(_(),e("div",le,[(_(!0),e(d,null,u(y.featuredTournaments,s=>(_(),e("div",{key:s.id,class:"tournament-card",onClick:e=>y.openTournament(s)},[a("div",ue,[a("h3",me,i(s.name),1),a("span",{class:m(["tournament-status",s.status])},i(s.status_label),3)]),a("p",pe,i(s.description),1),a("div",he,[a("div",ve,[v[32]||(v[32]=a("i",{class:"material-icons"},"group",-1)),a("span",null,i(s.participants_count)+" participants",1)]),s.prize_pool>0?(_(),e("div",ge,[v[33]||(v[33]=a("i",{class:"material-icons"},"emoji_events",-1)),a("span",null,i(y.formatPrize(s.prize_pool,s.currency)),1)])):t("",!0),a("div",ye,[v[34]||(v[34]=a("i",{class:"material-icons"},"schedule",-1)),a("span",null,i(y.formatTournamentDate(s.end_date)),1)])]),a("div",_e,[s.can_register?(_(),e("button",{key:0,onClick:p(e=>y.registerToTournament(s),["stop"]),disabled:y.registering===s.id,class:"btn-primary btn-small"},[y.registering===s.id?(_(),e("span",fe,"Inscription...")):(_(),e("span",ke,"Participer"))],8,be)):s.user_is_participant?(_(),e("button",{key:1,onClick:p(e=>y.viewTournamentLeaderboard(s),["stop"]),class:"btn-secondary btn-small"}," Mon classement ",8,we)):(_(),e("span",Me,"Inscriptions fermées"))])],8,de))),128))])):(_(),e("div",Se,[v[41]||(v[41]=a("div",{class:"no-tournaments-icon"},[a("i",{class:"material-icons"},"emoji_events")],-1)),v[42]||(v[42]=a("h3",{class:"md3-title-medium"},"Aucun tournoi disponible",-1)),v[43]||(v[43]=a("p",{class:"md3-body-medium dinor-text-gray"}," Les tournois apparaîtront ici dès qu'ils seront disponibles. ",-1)),a("div",Ae,[a("div",Pe,[v[38]||(v[38]=a("h4",{class:"md3-title-small"},"En attendant :",-1)),a("ul",Ce,[v[36]||(v[36]=a("li",null,[a("i",{class:"material-icons"},"notifications"),a("span",null,"Activez les notifications pour être prévenu des nouveaux tournois")],-1)),v[37]||(v[37]=a("li",null,[a("i",{class:"material-icons"},"schedule"),a("span",null,"Revenez régulièrement pour ne manquer aucune compétition")],-1)),y.authStore.isAuthenticated?t("",!0):(_(),e("li",Te,v[35]||(v[35]=[a("i",{class:"material-icons"},"person",-1),a("span",null,"Créez un compte pour participer aux prochains tournois",-1)])))])]),a("div",xe,[y.authStore.isAuthenticated?(_(),e("button",{key:1,onClick:v[10]||(v[10]=(...e)=>h.loadFeaturedTournaments&&h.loadFeaturedTournaments(...e)),class:"btn-secondary"},v[40]||(v[40]=[a("i",{class:"material-icons"},"refresh",-1),a("span",null,"Actualiser",-1)]))):(_(),e("button",{key:0,onClick:v[9]||(v[9]=e=>y.showAuthModal=!0),class:"btn-primary"},v[39]||(v[39]=[a("i",{class:"material-icons"},"person_add",-1),a("span",null,"Créer un compte",-1)])))])])]))]),a("div",ze,[s(k,{to:"/predictions/leaderboard",class:"quick-action-card"},{default:o(()=>v[44]||(v[44]=[a("i",{class:"material-icons"},"leaderboard",-1),a("div",{class:"action-text"},[a("h3",{class:"md3-title-small"},"Classement"),a("p",{class:"md3-body-small"},"Voir les meilleurs pronostiqueurs")],-1)])),_:1,__:[44]}),s(k,{to:"/predictions/my-predictions",class:"quick-action-card"},{default:o(()=>v[45]||(v[45]=[a("i",{class:"material-icons"},"history",-1),a("div",{class:"action-text"},[a("h3",{class:"md3-title-small"},"Mes prédictions"),a("p",{class:"md3-body-small"},"Historique et statistiques")],-1)])),_:1,__:[45]})])]))]),s(w,{modelValue:y.showAuthModal,"onUpdate:modelValue":v[11]||(v[11]=e=>y.showAuthModal=e),onAuthenticated:y.handleAuthenticated},null,8,["modelValue","onAuthenticated"])])}],["__scopeId","data-v-d53ca346"]]);export{Ee as default};
