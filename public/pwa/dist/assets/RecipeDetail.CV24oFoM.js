import{b as e,p as t,d as i,i as a,j as s,e as r,t as n,F as c,g as o,D as l,E as d,f as m,m as p,u,h as g,o as y}from"./vendor.CHp--hJi.js";import{u as v}from"./api.DDhRmwxM.js";import{_ as h,A as k}from"./index.B8aG9rpS.js";import{B as b}from"./Badge.BDl1NHcF.js";const f={class:"recipe-detail"},x={class:"md3-main-content"},w={key:0,class:"loading-container"},_={key:1,class:"recipe-content"},L={class:"recipe-hero"},j=["src","alt"],C={class:"recipe-overlay dinor-gradient-primary"},D={class:"recipe-badges"},B={class:"recipe-info"},E={class:"recipe-stats"},I={class:"stat-item"},A={class:"md3-body-medium"},R={class:"stat-item"},S={class:"md3-body-medium"},T={class:"stat-item"},H={class:"md3-body-medium"},$={class:"stat-item"},q={class:"md3-body-medium"},M={key:0,class:"recipe-description"},z=["innerHTML"],P={key:1,class:"recipe-ingredients"},F={class:"ingredients-list"},O={class:"md3-body-medium"},U={key:2,class:"recipe-instructions"},V=["innerHTML"],G={class:"comments-section"},J={class:"md3-title-medium dinor-text-primary"},K={class:"add-comment-form"},N=["disabled"],Q={key:0,class:"comments-list"},W={class:"comment-header"},X={class:"comment-author md3-body-medium"},Y={class:"comment-date md3-body-small dinor-text-gray"},Z={class:"comment-content md3-body-medium"},ee={key:1,class:"empty-comments"},te={key:2,class:"error-state"};const ie=h({name:"RecipeDetail",components:{AppHeader:k,Badge:b},props:{id:{type:String,required:!0}},setup(e){const t=u();g();const i=v(),a=m(null),s=m([]),r=m(!0),n=m(!1),c=m(""),o=async()=>{try{const t=await i.get("/comments",{type:"recipe",id:e.id});t.success&&(s.value=t.data)}catch(t){console.error("Erreur lors du chargement des commentaires:",t)}},l=async()=>{try{const t=await i.get("/likes/check",{type:"recipe",id:e.id});n.value=t.success&&t.data.liked}catch(t){console.error("Erreur lors de la vérification du like:",t)}};return p(()=>{(async()=>{try{const t=await i.get(`/recipes/${e.id}`);t.success&&(a.value=t.data,await o(),await l())}catch(t){console.error("Erreur lors du chargement de la recette:",t)}finally{r.value=!1}})()}),{recipe:a,comments:s,loading:r,userLiked:n,newComment:c,toggleLike:async()=>{try{const t=await i.request("/likes/toggle",{method:"POST",body:{likeable_type:"recipe",likeable_id:e.id}});t.success&&(n.value=!n.value,a.value&&(a.value.likes_count=t.data.total_likes))}catch(t){console.error("Erreur lors du toggle like:",t)}},addComment:async()=>{if(c.value.trim())try{(await i.request("/comments",{method:"POST",body:{type:"recipe",id:e.id,content:c.value,author_name:"Utilisateur"}})).success&&(await o(),c.value="")}catch(t){console.error("Erreur lors de l'ajout du commentaire:",t)}},shareRecipe:()=>{navigator.share&&a.value?navigator.share({title:a.value.title,text:a.value.description,url:window.location.href}):(navigator.clipboard.writeText(window.location.href),alert("Lien copié dans le presse-papiers!"))},goBack:()=>{t.push("/recipes")},getDifficultyLabel:e=>({beginner:"Débutant",intermediate:"Intermédiaire",advanced:"Avancé"}[e]||"Débutant"),formatDate:e=>new Date(e).toLocaleDateString("fr-FR"),handleImageError:e=>{e.target.src="/images/default-recipe.jpg"},formatInstructions:e=>e?"string"==typeof e?e:Array.isArray(e)?e.map((e,t)=>"object"==typeof e&&e.step?`<div class="instruction-step">\n              <h4>Étape ${t+1}</h4>\n              <p>${e.step}</p>\n            </div>`:"string"==typeof e?`<div class="instruction-step">\n              <h4>Étape ${t+1}</h4>\n              <p>${e}</p>\n            </div>`:`<div class="instruction-step"><p>${e}</p></div>`).join(""):e.toString():""}}},[["render",function(m,p,u,g,v,h){var k;const b=a("AppHeader"),ie=a("Badge");return y(),e("div",f,[t(b,{title:(null==(k=g.recipe)?void 0:k.title)||"Recette","show-like":!0,"show-share":!0,"is-liked":g.userLiked,"back-path":"/recipes",onLike:g.toggleLike,onShare:g.shareRecipe,onBack:g.goBack},null,8,["title","is-liked","onLike","onShare","onBack"]),i("main",x,[g.loading?(y(),e("div",w,p[4]||(p[4]=[i("div",{class:"md3-circular-progress"},null,-1),i("p",{class:"md3-body-large"},"Chargement de la recette...",-1)]))):g.recipe?(y(),e("div",_,[i("div",L,[i("img",{src:g.recipe.image||"/images/default-recipe.jpg",alt:g.recipe.title,class:"recipe-hero-image",onError:p[0]||(p[0]=(...e)=>g.handleImageError&&g.handleImageError(...e))},null,40,j),i("div",C,[i("div",D,[g.recipe.difficulty_level?(y(),s(ie,{key:0,text:g.getDifficultyLabel(g.recipe.difficulty_level),icon:"restaurant",variant:"secondary",size:"medium"},null,8,["text"])):r("",!0),g.recipe.category?(y(),s(ie,{key:1,text:g.recipe.category.name,icon:"tag",variant:"neutral",size:"medium"},null,8,["text"])):r("",!0)])])]),i("div",B,[i("div",E,[i("div",I,[p[5]||(p[5]=i("i",{class:"material-icons dinor-text-secondary"},"schedule",-1)),i("span",A,n(g.recipe.cooking_time)+"min",1)]),i("div",R,[p[6]||(p[6]=i("i",{class:"material-icons dinor-text-secondary"},"people",-1)),i("span",S,n(g.recipe.servings)+" pers.",1)]),i("div",T,[p[7]||(p[7]=i("i",{class:"material-icons dinor-text-secondary"},"favorite",-1)),i("span",H,n(g.recipe.likes_count||0),1)]),i("div",$,[p[8]||(p[8]=i("i",{class:"material-icons dinor-text-secondary"},"comment",-1)),i("span",q,n(g.recipe.comments_count||0),1)])]),g.recipe.description?(y(),e("div",M,[p[9]||(p[9]=i("h2",{class:"md3-title-medium dinor-text-primary"},"Description",-1)),i("p",{class:"md3-body-large dinor-text-gray",innerHTML:g.recipe.description},null,8,z)])):r("",!0),g.recipe.ingredients&&g.recipe.ingredients.length?(y(),e("div",P,[p[10]||(p[10]=i("h2",{class:"md3-title-medium dinor-text-primary"},"Ingrédients",-1)),i("ul",F,[(y(!0),e(c,null,o(g.recipe.ingredients,t=>(y(),e("li",{key:t.id,class:"ingredient-item"},[i("span",O,n(t.quantity)+" "+n(t.unit)+" "+n(t.name),1)]))),128))])])):r("",!0),g.recipe.instructions?(y(),e("div",U,[p[11]||(p[11]=i("h2",{class:"md3-title-medium dinor-text-primary"},"Instructions",-1)),i("div",{class:"md3-body-large dinor-text-gray",innerHTML:g.formatInstructions(g.recipe.instructions)},null,8,V)])):r("",!0),i("div",G,[i("h2",J,"Commentaires ("+n(g.comments.length)+")",1),i("div",K,[l(i("textarea",{"onUpdate:modelValue":p[1]||(p[1]=e=>g.newComment=e),placeholder:"Ajoutez votre commentaire...",class:"md3-textarea",rows:"3"},"              ",512),[[d,g.newComment]]),i("button",{onClick:p[2]||(p[2]=(...e)=>g.addComment&&g.addComment(...e)),class:"btn-primary",disabled:!g.newComment.trim()}," Publier ",8,N)]),g.comments.length?(y(),e("div",Q,[(y(!0),e(c,null,o(g.comments,t=>(y(),e("div",{key:t.id,class:"comment-item"},[i("div",W,[i("span",X,n(t.author_name),1),i("span",Y,n(g.formatDate(t.created_at)),1)]),i("p",Z,n(t.content),1)]))),128))])):(y(),e("div",ee,p[12]||(p[12]=[i("p",{class:"md3-body-medium dinor-text-gray"},"Aucun commentaire pour le moment.",-1)])))])])])):(y(),e("div",te,[p[13]||(p[13]=i("div",{class:"error-icon"},[i("i",{class:"material-icons"},"error_outline")],-1)),p[14]||(p[14]=i("h2",{class:"md3-title-large"},"Recette introuvable",-1)),p[15]||(p[15]=i("p",{class:"md3-body-large dinor-text-gray"},"La recette demandée n'existe pas ou a été supprimée.",-1)),i("button",{onClick:p[3]||(p[3]=(...e)=>g.goBack&&g.goBack(...e)),class:"btn-primary"},"Retour")]))])])}],["__scopeId","data-v-04eb0282"]]);export{ie as default};
