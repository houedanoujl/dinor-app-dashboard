import{g as e,h as s,i as a,b as t,d as r,z as l,k as i,A as c,t as n,n as o,F as u,r as d,y as p,j as y,q as v,x as g,o as f}from"./vendor.2V9jEnd_.js";import{a as h}from"./api.uSn_et4s.js";import{_ as m,u as k}from"./main.BY4l8fPY.js";const C=e("recipes",()=>{const e=s([]),t=s(null),r=s(!1),l=s(null),i=s(""),c=s(null),n=s({current_page:1,last_page:1,per_page:12,total:0}),o=a(()=>{let s=e.value;if(i.value){const e=i.value.toLowerCase();s=s.filter(s=>{var a,t;return s.title.toLowerCase().includes(e)||(null==(a=s.short_description)?void 0:a.toLowerCase().includes(e))||(null==(t=s.tags)?void 0:t.some(s=>s.toLowerCase().includes(e)))})}return c.value&&(s=s.filter(e=>e.category_id===c.value)),s}),u=a(()=>e.value.filter(e=>e.is_featured));return{recipes:e,currentRecipe:t,loading:r,error:l,searchQuery:i,selectedCategory:c,pagination:n,filteredRecipes:o,featuredRecipes:u,fetchRecipes:async function(s={}){r.value=!0,l.value=null;try{const a=await h.getRecipes(s);if(!a.success)throw new Error(a.message||"Failed to fetch recipes");e.value=a.data,a.meta&&(n.value=a.meta)}catch(a){l.value=a.message,console.error("Error fetching recipes:",a)}finally{r.value=!1}},fetchRecipe:async function(e){r.value=!0,l.value=null;try{const s=await h.getRecipe(e);if(!s.success)throw new Error(s.message||"Failed to fetch recipe");t.value=s.data}catch(s){l.value=s.message,console.error("Error fetching recipe:",s)}finally{r.value=!1}},toggleLike:async function(s){try{const a=await h.toggleLike("recipes",s);if(a.success){const r=e.value.find(e=>e.id===s);return r&&(r.is_liked=a.data.is_liked,r.likes_count=a.data.likes_count),t.value&&t.value.id===s&&(t.value.is_liked=a.data.is_liked,t.value.likes_count=a.data.likes_count),a.data}}catch(a){return console.error("Error toggling like:",a),{success:!1}}},setSearchQuery:function(e){i.value=e},setSelectedCategory:function(e){c.value=e},clearFilters:function(){i.value="",c.value=null},clearCurrentRecipe:function(){t.value=null},clearError:function(){l.value=null}}}),_={class:"recipes-list"},R={class:"page-header"},b={class:"header-content"},w={class:"search-container"},L={class:"search-input-wrapper"},Q={key:0,class:"loading-state"},S={key:1,class:"error-state"},E={key:2,class:"content"},z={key:0,class:"filters"},j={class:"filter-chips"},F=["onClick"],x={key:1,class:"results-info"},A={key:0},D={key:2,class:"empty-state"},T={key:0},V={key:1},q={key:3,class:"recipes-grid"},I=["onClick"],M={class:"recipe-image"},N=["src","alt"],P={class:"recipe-overlay"},U={class:"recipe-meta"},W={key:0,class:"time"},$={key:1,class:"difficulty"},B={class:"recipe-content"},G={class:"recipe-title"},H={key:0,class:"recipe-description"},J={class:"recipe-stats"},K={class:"stat"},O={key:0,class:"stat"};const X=m({name:"RecipesList",setup(){const e=g(),s=C(),t=k(),r=a({get:()=>s.searchQuery,set:e=>s.setSearchQuery(e)}),l=a({get:()=>s.selectedCategory,set:e=>s.setSelectedCategory(e)}),i=a(()=>s.loading),c=a(()=>s.error),n=a(()=>s.filteredRecipes),o=a(()=>[]),u=async()=>{await s.fetchRecipes()};return y(()=>{u(),t.initializePWAListeners(),t.initializeNetworkListeners()}),v(r,e=>{}),{searchQuery:r,selectedCategory:l,loading:i,error:c,filteredRecipes:n,categories:o,goToRecipe:s=>{e.push(`/recipe/${s}`)},clearSearch:()=>{r.value=""},setSelectedCategory:e=>{l.value=e},retry:()=>{s.clearError(),u()},getDifficultyLabel:e=>({easy:"Facile",medium:"Moyen",hard:"Difficile"}[e]||e)}}},[["render",function(e,s,a,y,v,g){var h;return f(),t("div",_,[r("header",R,[r("div",b,[s[7]||(s[7]=r("h1",null,"Recettes",-1)),r("div",w,[r("div",L,[s[6]||(s[6]=r("span",{class:"material-symbols-outlined search-icon"},"search",-1)),l(r("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>y.searchQuery=e),type:"text",placeholder:"Rechercher une recette...",class:"search-input"},null,512),[[c,y.searchQuery]]),y.searchQuery?(f(),t("button",{key:0,onClick:s[1]||(s[1]=(...e)=>y.clearSearch&&y.clearSearch(...e)),class:"clear-search","aria-label":"Effacer la recherche"},s[5]||(s[5]=[r("span",{class:"material-symbols-outlined"},"close",-1)]))):i("",!0)])])])]),y.loading?(f(),t("div",Q,s[8]||(s[8]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"Chargement des recettes...",-1)]))):y.error?(f(),t("div",S,[s[9]||(s[9]=r("div",{class:"error-icon"},[r("span",{class:"material-symbols-outlined"},"error")],-1)),r("p",null,n(y.error),1),r("button",{onClick:s[2]||(s[2]=(...e)=>y.retry&&y.retry(...e)),class:"retry-btn"}," Réessayer ")])):(f(),t("div",E,[(null==(h=y.categories)?void 0:h.length)?(f(),t("div",z,[r("div",j,[r("button",{onClick:s[3]||(s[3]=e=>y.setSelectedCategory(null)),class:o(["filter-chip",{active:!y.selectedCategory}])}," Toutes ",2),(f(!0),t(u,null,d(y.categories,e=>(f(),t("button",{key:e.id,onClick:s=>y.setSelectedCategory(e.id),class:o(["filter-chip",{active:y.selectedCategory===e.id}])},n(e.name),11,F))),128))])])):i("",!0),y.filteredRecipes.length?(f(),t("div",x,[p(n(y.filteredRecipes.length)+" recette"+n(y.filteredRecipes.length>1?"s":"")+" ",1),y.searchQuery?(f(),t("span",A,' pour "'+n(y.searchQuery)+'"',1)):i("",!0)])):i("",!0),y.filteredRecipes.length||y.loading?(f(),t("div",q,[(f(!0),t(u,null,d(y.filteredRecipes,e=>(f(),t("article",{key:e.id,onClick:s=>y.goToRecipe(e.id),class:"recipe-card"},[r("div",M,[r("img",{src:e.featured_image_url||"/images/default-recipe.jpg",alt:e.title,loading:"lazy"},null,8,N),r("div",P,[r("div",U,[e.preparation_time?(f(),t("span",W,[s[12]||(s[12]=r("span",{class:"material-symbols-outlined"},"schedule",-1)),p(" "+n(e.preparation_time)+"min ",1)])):i("",!0),e.difficulty?(f(),t("span",$,n(y.getDifficultyLabel(e.difficulty)),1)):i("",!0)])])]),r("div",B,[r("h3",G,n(e.title),1),e.short_description?(f(),t("p",H,n(e.short_description),1)):i("",!0),r("div",J,[r("div",K,[s[13]||(s[13]=r("span",{class:"material-symbols-outlined"},"favorite",-1)),r("span",null,n(e.likes_count||0),1)]),e.servings?(f(),t("div",O,[s[14]||(s[14]=r("span",{class:"material-symbols-outlined"},"group",-1)),r("span",null,n(e.servings),1)])):i("",!0)])])],8,I))),128))])):(f(),t("div",D,[s[10]||(s[10]=r("div",{class:"empty-icon"},[r("span",{class:"material-symbols-outlined"},"restaurant")],-1)),s[11]||(s[11]=r("h3",null,"Aucune recette trouvée",-1)),y.searchQuery?(f(),t("p",T," Essayez avec d'autres mots-clés ou parcourez toutes les recettes. ")):(f(),t("p",V," Les recettes seront bientôt disponibles. ")),y.searchQuery?(f(),t("button",{key:2,onClick:s[4]||(s[4]=(...e)=>y.clearSearch&&y.clearSearch(...e)),class:"clear-search-btn"}," Voir toutes les recettes ")):i("",!0)]))]))])}],["__scopeId","data-v-96fee90b"]]);export{X as default};
