import{d as e,f as a,v as i,e as s,t as l,z as t,F as o,i as d,D as r,j as n,y as c,r as u,b as v,m,o as f}from"./vendor.BeqKZlTx.js";import{a as p}from"./api.70uutYeQ.js";import{F as y}from"./FavoriteButton.C_r4gVRX.js";import{A as h}from"./AuthModal.BDSOLoMC.js";import{_ as g}from"./index.W0j3SMuK.js";import"./api.DeptcIQc.js";const b={class:"dinor-tv"},V={key:0,class:"loading-state"},k={key:1,class:"error-state"},w={class:"md3-body-large dinor-text-gray"},_={key:2,class:"content"},j={key:0,class:"live-section"},E={class:"live-grid"},D=["onClick"],M={class:"video-thumbnail"},A=["src","alt"],C={class:"video-info"},S={class:"video-title"},$={key:0,class:"video-description"},F={class:"video-meta"},I={key:0,class:"viewers"},T={key:1,class:"scheduled"},x={class:"videos-section"},R={key:0,class:"empty-state"},z={key:1,class:"videos-grid"},L={key:0,class:"featured-video md3-card"},B=["src","alt"],U={class:"video-info"},q={class:"video-title md3-title-medium"},P={key:0,class:"video-description md3-body-medium dinor-text-gray"},G={class:"video-meta"},H={class:"views-count"},J={class:"video-date"},K={class:"regular-videos"},N=["onClick"],O={class:"video-thumbnail"},Q=["src","alt"],W={key:0,class:"video-duration"},X={class:"video-info"},Y={class:"video-title md3-title-small"},Z={class:"video-meta"},ee={class:"views-count"},ae={class:"video-date"},ie={class:"video-player"},se=["src","title"],le={class:"video-details"},te={key:0};const oe=g({name:"DinorTV",components:{FavoriteButton:y,AuthModal:h},setup(){const e=u([]),a=u(null),i=u(!1),s=u(null),l=u(!1),t=v(()=>e.value.filter(e=>e.is_live)),o=v(()=>e.value.find(e=>e.is_featured)||e.value[0]||null),d=v(()=>{const a=o.value;return a?e.value.filter(e=>e.id!==a.id):e.value}),r=async()=>{i.value=!0,s.value=null;try{const a=await p.getVideos();if(!a.success)throw new Error(a.message||"Failed to fetch videos");e.value=a.data}catch(a){s.value=a.message,console.error("Error fetching videos:",a)}finally{i.value=!1}};return m(()=>{r()}),{videos:e,liveVideos:t,featuredVideo:o,regularVideos:d,selectedVideo:a,loading:i,error:s,showAuthModal:l,retry:()=>{s.value=null,r()},playVideo:e=>{a.value=e,document.body.style.overflow="hidden"},closeVideo:()=>{a.value=null,document.body.style.overflow="auto"},getVideoThumbnail:e=>{if(!e)return"/images/default-video.jpg";const a=e.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\n?#]+)/);return a?`https://img.youtube.com/vi/${a[1]}/maxresdefault.jpg`:"/images/default-video.jpg"},getEmbedUrl:e=>{if(!e)return"";const a=e.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\n?#]+)/);return a?`https://www.youtube.com/embed/${a[1]}?autoplay=1`:e},getShortDescription:e=>{if(!e)return"";const a=e.replace(/<[^>]*>/g,"");return a.length>100?a.substring(0,100)+"...":a},formatDuration:e=>{if(!e)return"";const a=Math.floor(e/3600),i=Math.floor(e%3600/60),s=e%60;return a>0?`${a}:${i.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`:`${i}:${s.toString().padStart(2,"0")}`},formatDate:e=>e?new Date(e).toLocaleDateString("fr-FR",{year:"numeric",month:"short",day:"numeric"}):"",formatTime:e=>e?new Date(e).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}):"",formatViews:e=>e&&0!==e?1===e?"1 vue":e<1e3?`${e} vues`:e<1e6?`${Math.floor(e/1e3)}k vues`:`${Math.floor(e/1e6)}M vues`:"0 vue",handleImageError:e=>{e.target.src="/images/default-video-thumbnail.jpg"}}}},[["render",function(u,v,m,p,y,h){const g=n("FavoriteButton"),oe=n("AuthModal");return f(),e("div",b,[p.loading?(f(),e("div",V,v[11]||(v[11]=[s("div",{class:"loading-spinner"},null,-1),s("p",null,"Chargement des vid√©os...",-1)]))):p.error?(f(),e("div",k,[v[12]||(v[12]=s("div",{class:"error-icon"},[s("span",{class:"material-symbols-outlined"},"error"),s("span",{class:"emoji-fallback"},"‚ö†Ô∏è")],-1)),v[13]||(v[13]=s("h2",{class:"md3-title-large"},"Erreur de chargement",-1)),s("p",w,l(p.error),1),s("button",{onClick:v[0]||(v[0]=(...e)=>p.retry&&p.retry(...e)),class:"btn-secondary"},"R√©essayer")])):(f(),e("div",_,[p.liveVideos.length?(f(),e("section",j,[v[17]||(v[17]=s("h2",{class:"section-title"},[s("span",{class:"live-indicator"}),t(" En Direct ")],-1)),s("div",E,[(f(!0),e(o,null,d(p.liveVideos,i=>(f(),e("article",{key:i.id,onClick:e=>p.playVideo(i),class:"video-card live-card"},[s("div",M,[s("img",{src:i.thumbnail_url||p.getVideoThumbnail(i.video_url),alt:i.title,loading:"lazy"},null,8,A),v[14]||(v[14]=r('<div class="video-overlay" data-v-af49ff5e><div class="play-button" data-v-af49ff5e><span class="material-symbols-outlined" data-v-af49ff5e>play_circle</span><span class="emoji-fallback" data-v-af49ff5e>‚ñ∂Ô∏è</span></div><div class="live-badge" data-v-af49ff5e><span class="live-dot" data-v-af49ff5e></span> LIVE </div></div>',1))]),s("div",C,[s("h3",S,l(i.title),1),i.description?(f(),e("p",$,l(p.getShortDescription(i.description)),1)):a("",!0),s("div",F,[i.viewers_count?(f(),e("span",I,[v[15]||(v[15]=s("span",{class:"material-symbols-outlined"},"visibility",-1)),v[16]||(v[16]=s("span",{class:"emoji-fallback"},"üëÅÔ∏è",-1)),t(" "+l(i.viewers_count)+" spectateurs ",1)])):a("",!0),i.scheduled_at?(f(),e("span",T," Programm√© √† "+l(p.formatTime(i.scheduled_at)),1)):a("",!0)])])],8,D))),128))])])):a("",!0),s("section",x,[v[25]||(v[25]=s("h2",{class:"section-title"},"Toutes les vid√©os",-1)),p.videos.length||p.loading?(f(),e("div",z,[p.featuredVideo?(f(),e("div",L,[s("div",{class:"video-thumbnail",onClick:v[2]||(v[2]=e=>p.playVideo(p.featuredVideo))},[s("img",{src:p.featuredVideo.thumbnail||"/images/default-video-thumbnail.jpg",alt:p.featuredVideo.title,onError:v[1]||(v[1]=(...e)=>p.handleImageError&&p.handleImageError(...e))},null,40,B),v[19]||(v[19]=r('<div class="play-overlay" data-v-af49ff5e><div class="play-button" data-v-af49ff5e><span class="material-symbols-outlined" data-v-af49ff5e>play_circle</span><span class="emoji-fallback" data-v-af49ff5e>‚ñ∂Ô∏è</span></div></div><div class="video-badge featured-badge" data-v-af49ff5e><span data-v-af49ff5e>√Ä la une</span></div>',2))]),s("div",U,[s("h2",q,l(p.featuredVideo.title),1),p.featuredVideo.description?(f(),e("p",P,l(p.featuredVideo.description),1)):a("",!0),s("div",G,[s("div",H,[v[20]||(v[20]=s("span",{class:"material-symbols-outlined"},"visibility",-1)),v[21]||(v[21]=s("span",{class:"emoji-fallback"},"üëÅÔ∏è",-1)),s("span",null,l(p.formatViews(p.featuredVideo.views_count)),1)]),s("div",J,[s("span",null,l(p.formatDate(p.featuredVideo.created_at)),1)]),i(g,{type:"dinor_tv","item-id":p.featuredVideo.id,"initial-favorited":!1,"initial-count":p.featuredVideo.favorites_count||0,"show-count":!0,size:"medium",onAuthRequired:v[3]||(v[3]=e=>p.showAuthModal=!0)},null,8,["item-id","initial-count"])])])])):a("",!0),s("div",K,[(f(!0),e(o,null,d(p.regularVideos,t=>(f(),e("div",{key:t.id,class:"video-card md3-card md3-ripple",onClick:e=>p.playVideo(t)},[s("div",O,[s("img",{src:t.thumbnail||"/images/default-video-thumbnail.jpg",alt:t.title,onError:v[4]||(v[4]=(...e)=>p.handleImageError&&p.handleImageError(...e))},null,40,Q),v[22]||(v[22]=s("div",{class:"play-overlay"},[s("div",{class:"play-button"},[s("span",{class:"material-symbols-outlined"},"play_circle"),s("span",{class:"emoji-fallback"},"‚ñ∂Ô∏è")])],-1)),t.duration?(f(),e("div",W,l(p.formatDuration(t.duration)),1)):a("",!0)]),s("div",X,[s("h3",Y,l(t.title),1),s("div",Z,[s("div",ee,[v[23]||(v[23]=s("span",{class:"material-symbols-outlined"},"visibility",-1)),v[24]||(v[24]=s("span",{class:"emoji-fallback"},"üëÅÔ∏è",-1)),s("span",null,l(p.formatViews(t.views_count)),1)]),s("div",ae,[s("span",null,l(p.formatDate(t.created_at)),1)]),i(g,{type:"dinor_tv","item-id":t.id,"initial-favorited":!1,"initial-count":t.favorites_count||0,"show-count":!0,size:"small",variant:"minimal",onAuthRequired:v[5]||(v[5]=e=>p.showAuthModal=!0),onClick:v[6]||(v[6]=c(()=>{},["stop"]))},null,8,["item-id","initial-count"])])])],8,N))),128))])])):(f(),e("div",R,v[18]||(v[18]=[s("div",{class:"empty-icon"},[s("span",{class:"material-symbols-outlined"},"play_circle")],-1),s("h3",null,"Aucune vid√©o disponible",-1),s("p",null,"Les vid√©os culinaires seront bient√¥t disponibles.",-1)])))])])),p.selectedVideo?(f(),e("div",{key:3,class:"video-modal",onClick:v[9]||(v[9]=(...e)=>p.closeVideo&&p.closeVideo(...e))},[s("div",{class:"modal-content",onClick:v[8]||(v[8]=c(()=>{},["stop"]))},[s("button",{onClick:v[7]||(v[7]=(...e)=>p.closeVideo&&p.closeVideo(...e)),class:"close-button"},v[26]||(v[26]=[s("span",{class:"material-symbols-outlined"},"close",-1),s("span",{class:"emoji-fallback"},"‚úñÔ∏è",-1)])),s("div",ie,[s("iframe",{src:p.getEmbedUrl(p.selectedVideo.video_url),title:p.selectedVideo.title,frameborder:"0",allowfullscreen:""},null,8,se)]),s("div",le,[s("h3",null,l(p.selectedVideo.title),1),p.selectedVideo.description?(f(),e("p",te,l(p.selectedVideo.description),1)):a("",!0)])])])):a("",!0),i(oe,{modelValue:p.showAuthModal,"onUpdate:modelValue":v[10]||(v[10]=e=>p.showAuthModal=e)},null,8,["modelValue"])])}],["__scopeId","data-v-af49ff5e"]]);export{oe as default};
