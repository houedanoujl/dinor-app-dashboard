import{b as e,p as t,d as a,i as s,e as n,t as i,y as o,D as r,E as l,F as c,g as d,f as m,m as v,u,h as p,o as y}from"./vendor.CHp--hJi.js";import{u as g}from"./api.DDhRmwxM.js";import{_ as h,A as k}from"./index.B8aG9rpS.js";const b={class:"event-detail"},f={class:"md3-main-content"},_={key:0,class:"loading-container"},x={key:1,class:"event-content"},w={key:0,class:"event-hero"},E=["src","alt"],C={class:"event-overlay dinor-gradient-primary"},D={class:"event-badges"},L={key:0,class:"md3-chip event-location"},j={key:1,class:"md3-chip event-category"},A={class:"event-info"},H={class:"event-stats"},B={class:"stat-item"},I={class:"md3-body-medium"},S={key:0,class:"stat-item"},$={class:"md3-body-medium"},q={class:"stat-item"},F={class:"md3-body-medium"},R={class:"stat-item"},T={class:"md3-body-medium"},M={class:"event-details"},P={class:"detail-item"},U={class:"md3-body-medium"},z={key:0},V={key:1},G={key:0},J={key:0,class:"detail-item"},K={class:"md3-body-medium"},N={key:0,class:"event-description"},O=["innerHTML"],Q={key:1,class:"event-registration"},W={key:0,class:"registration-info"},X={class:"md3-body-small dinor-text-gray"},Y={class:"comments-section"},Z={class:"md3-title-medium dinor-text-primary"},ee={class:"add-comment-form"},te=["disabled"],ae={key:0,class:"comments-list"},se={class:"comment-header"},ne={class:"comment-author md3-body-medium"},ie={class:"comment-date md3-body-small dinor-text-gray"},oe={class:"comment-content md3-body-medium"},re={key:1,class:"empty-comments"},le={key:2,class:"error-state"},ce={class:"error-actions"};const de=h({name:"EventDetail",components:{AppHeader:k},props:{id:{type:String,required:!0}},setup(e){const t=u();p();const a=g(),s=m(null),n=m([]),i=m(!0),o=m(!1),r=m(""),l=async()=>{try{const t=await a.get("/comments",{type:"event",id:e.id});t.success&&(n.value=t.data)}catch(t){console.error("Erreur lors du chargement des commentaires:",t)}},c=async()=>{try{const t=await a.get("/likes/check",{type:"event",id:e.id});o.value=t.success&&t.data.liked}catch(t){console.error("Erreur lors de la vérification du like:",t)}};return v(()=>{(async()=>{try{const t=await a.get(`/events/${e.id}`);t.success&&(s.value=t.data,await l(),await c())}catch(t){console.error("Erreur lors du chargement de l'événement:",t)}finally{i.value=!1}})()}),{event:s,comments:n,loading:i,userLiked:o,newComment:r,toggleLike:async()=>{try{const t=await a.post("/likes/toggle",{likeable_type:"event",likeable_id:e.id});t.success&&(o.value=!o.value,s.value&&(s.value.likes_count=t.data.total_likes))}catch(t){console.error("Erreur lors du toggle like:",t)}},addComment:async()=>{if(r.value.trim())try{(await a.post("/comments",{type:"event",id:e.id,content:r.value,author_name:"Utilisateur"})).success&&(await l(),r.value="")}catch(t){console.error("Erreur lors de l'ajout du commentaire:",t)}},shareEvent:()=>{navigator.share&&s.value?navigator.share({title:s.value.title,text:s.value.content,url:window.location.href}):(navigator.clipboard.writeText(window.location.href),alert("Lien copié dans le presse-papiers!"))},goBack:()=>{t.push("/events")},goHome:()=>{t.push("/")},formatEventDate:e=>new Date(e).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),formatDate:e=>new Date(e).toLocaleDateString("fr-FR"),handleImageError:e=>{e.target.src="/images/default-recipe.jpg"},formatContent:e=>e?"string"==typeof e?e:Array.isArray(e)?e.map((e,t)=>"object"==typeof e&&e.step?`<div class="content-step">\n              <h4>Étape ${t+1}</h4>\n              <p>${e.step}</p>\n            </div>`:"string"==typeof e?`<div class="content-step">\n              <p>${e}</p>\n            </div>`:`<div class="content-step"><p>${e}</p></div>`).join(""):e.toString():""}}},[["render",function(m,v,u,p,g,h){var k;const de=s("AppHeader");return y(),e("div",b,[t(de,{title:(null==(k=p.event)?void 0:k.title)||"Événement","show-like":!0,"show-share":!0,"is-liked":p.userLiked,"back-path":"/events",onLike:p.toggleLike,onShare:p.shareEvent,onBack:p.goBack},null,8,["title","is-liked","onLike","onShare","onBack"]),a("main",f,[p.loading?(y(),e("div",_,v[5]||(v[5]=[a("div",{class:"md3-circular-progress"},null,-1),a("p",{class:"md3-body-large"},"Chargement de l'événement...",-1)]))):p.event?(y(),e("div",x,[p.event.image?(y(),e("div",w,[a("img",{src:p.event.image||"/images/default-recipe.jpg",alt:p.event.title,class:"event-hero-image",onError:v[0]||(v[0]=(...e)=>p.handleImageError&&p.handleImageError(...e))},null,40,E),a("div",C,[a("div",D,[p.event.location?(y(),e("div",L,[v[6]||(v[6]=a("i",{class:"material-icons"},"location_on",-1)),a("span",null,i(p.event.location),1)])):n("",!0),p.event.category?(y(),e("div",j,[v[7]||(v[7]=a("i",{class:"material-icons"},"tag",-1)),a("span",null,i(p.event.category.name),1)])):n("",!0)])])])):n("",!0),a("div",A,[a("div",H,[a("div",B,[v[8]||(v[8]=a("i",{class:"material-icons dinor-text-secondary"},"event",-1)),a("span",I,i(p.formatEventDate(p.event.start_date)),1)]),p.event.start_time?(y(),e("div",S,[v[9]||(v[9]=a("i",{class:"material-icons dinor-text-secondary"},"schedule",-1)),a("span",$,i(p.event.start_time),1)])):n("",!0),a("div",q,[v[10]||(v[10]=a("i",{class:"material-icons dinor-text-secondary"},"favorite",-1)),a("span",F,i(p.event.likes_count||0),1)]),a("div",R,[v[11]||(v[11]=a("i",{class:"material-icons dinor-text-secondary"},"comment",-1)),a("span",T,i(p.event.comments_count||0),1)])]),a("div",M,[a("div",P,[v[12]||(v[12]=a("h3",{class:"md3-title-small dinor-text-primary"},"Date et Heure",-1)),a("p",U,[o(i(p.formatEventDate(p.event.start_date))+" ",1),p.event.start_time?(y(),e("span",z," à "+i(p.event.start_time),1)):n("",!0),p.event.end_date&&p.event.end_date!==p.event.start_date?(y(),e("span",V,[o(" - "+i(p.formatEventDate(p.event.end_date))+" ",1),p.event.end_time?(y(),e("span",G," à "+i(p.event.end_time),1)):n("",!0)])):n("",!0)])]),p.event.location?(y(),e("div",J,[v[13]||(v[13]=a("h3",{class:"md3-title-small dinor-text-primary"},"Lieu",-1)),a("p",K,i(p.event.location),1)])):n("",!0)]),p.event.content?(y(),e("div",N,[v[14]||(v[14]=a("h2",{class:"md3-title-medium dinor-text-primary"},"Description",-1)),a("div",{class:"md3-body-large dinor-text-gray",innerHTML:p.formatContent(p.event.content)},null,8,O)])):n("",!0),p.event.registration_required?(y(),e("div",Q,[v[15]||(v[15]=a("h3",{class:"md3-title-small dinor-text-primary"},"Inscription",-1)),v[16]||(v[16]=a("p",{class:"md3-body-medium"},[a("i",{class:"material-icons dinor-text-secondary"},"info"),o(" Inscription requise pour cet événement ")],-1)),p.event.max_attendees?(y(),e("div",W,[a("p",X," Places limitées: "+i(p.event.max_attendees)+" personnes maximum ",1)])):n("",!0)])):n("",!0),a("div",Y,[a("h2",Z,"Commentaires ("+i(p.comments.length)+")",1),a("div",ee,[r(a("textarea",{"onUpdate:modelValue":v[1]||(v[1]=e=>p.newComment=e),placeholder:"Ajoutez votre commentaire...",class:"md3-textarea",rows:"3"},"              ",512),[[l,p.newComment]]),a("button",{onClick:v[2]||(v[2]=(...e)=>p.addComment&&p.addComment(...e)),class:"btn-primary",disabled:!p.newComment.trim()}," Publier ",8,te)]),p.comments.length?(y(),e("div",ae,[(y(!0),e(c,null,d(p.comments,t=>(y(),e("div",{key:t.id,class:"comment-item"},[a("div",se,[a("span",ne,i(t.author_name),1),a("span",ie,i(p.formatDate(t.created_at)),1)]),a("p",oe,i(t.content),1)]))),128))])):(y(),e("div",re,v[17]||(v[17]=[a("p",{class:"md3-body-medium dinor-text-gray"},"Aucun commentaire pour le moment.",-1)])))])])])):(y(),e("div",le,[v[18]||(v[18]=a("div",{class:"error-icon"},[a("i",{class:"material-icons"},"error_outline")],-1)),v[19]||(v[19]=a("h2",{class:"md3-title-large"},"Événement introuvable",-1)),v[20]||(v[20]=a("p",{class:"md3-body-large dinor-text-gray"},"L'événement demandé n'existe pas ou a été supprimé.",-1)),a("div",ce,[a("button",{onClick:v[3]||(v[3]=(...e)=>p.goBack&&p.goBack(...e)),class:"btn-secondary"},"Retour aux événements"),a("button",{onClick:v[4]||(v[4]=(...e)=>p.goHome&&p.goHome(...e)),class:"btn-primary"},"Accueil")])]))])])}],["__scopeId","data-v-7dfe9d8d"]]);export{de as default};
