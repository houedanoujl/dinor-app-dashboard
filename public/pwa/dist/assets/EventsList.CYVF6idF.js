import{e,f as t,m as l,n as a,F as s,g as i,t as r,y as n,j as c,p as o,i as u,r as d,b as v,o as p,u as y}from"./vendor.CNJ67EhX.js";import{a as m}from"./api.uSn_et4s.js";import{_ as f}from"./main.a-2UG2Uh.js";const g={class:"search-and-filters"},h={class:"search-container"},b={class:"search-input-wrapper"},k=["value","placeholder"],C={key:0,class:"filters"},F={class:"filter-chips"},_=["onClick"],T={key:1,class:"additional-filters"},A={class:"filter-header"},w={class:"material-symbols-outlined"},L={class:"filter-chips"},E=["onClick"],Q=["onClick"],S={key:2,class:"results-info"},$={key:0};const j={class:"events-list"},D={key:0,class:"loading-state"},x={key:1,class:"error-state"},P={key:2,class:"content"},R={key:0,class:"empty-state"},N={key:0},z={key:1},I={key:1,class:"events-container"},U=["onClick"],O={class:"event-image"},V=["src","alt"],G={class:"event-status"},H={class:"event-content"},X={class:"event-header"},q={class:"event-title"},B={key:0,class:"event-price"},J={key:0,class:"free-badge"},K={key:1,class:"price"},M={key:0,class:"event-description"},W={class:"event-details"},Y={class:"detail"},Z={key:0,class:"detail"},ee={key:1,class:"detail"},te={key:2,class:"detail"},le={key:1,class:"participants-info"};const ae=f({name:"EventsList",components:{SearchAndFilters:f({name:"SearchAndFilters",emits:["update:searchQuery","update:selectedCategory","update:additionalFilter"],props:{searchQuery:{type:String,default:""},searchPlaceholder:{type:String,default:"Rechercher..."},selectedCategory:{type:[Number,String],default:null},categories:{type:Array,default:()=>[]},additionalFilters:{type:Array,default:()=>[]},selectedFilters:{type:Object,default:()=>({})},resultsCount:{type:Number,default:null},itemType:{type:String,default:"élément"}},methods:{getFilterValue(e){return this.selectedFilters[e]||null}}},[["render",function(o,u,d,v,p,y){var m,f;return c(),e("div",g,[t("div",h,[t("div",b,[u[4]||(u[4]=t("span",{class:"material-symbols-outlined search-icon"},"search",-1)),t("input",{value:d.searchQuery,onInput:u[0]||(u[0]=e=>o.$emit("update:searchQuery",e.target.value)),type:"text",placeholder:d.searchPlaceholder,class:"search-input"},null,40,k),d.searchQuery?(c(),e("button",{key:0,onClick:u[1]||(u[1]=e=>o.$emit("update:searchQuery","")),class:"clear-search","aria-label":"Effacer la recherche"},u[3]||(u[3]=[t("span",{class:"material-symbols-outlined"},"close",-1)]))):l("",!0)])]),(null==(m=d.categories)?void 0:m.length)?(c(),e("div",C,[u[5]||(u[5]=t("div",{class:"filter-header"},[t("span",{class:"material-symbols-outlined"},"filter_list"),t("span",null,"Catégories")],-1)),t("div",F,[t("button",{onClick:u[2]||(u[2]=e=>o.$emit("update:selectedCategory",null)),class:a(["filter-chip",{active:!d.selectedCategory}])}," Toutes ",2),(c(!0),e(s,null,i(d.categories,t=>(c(),e("button",{key:t.id,onClick:e=>o.$emit("update:selectedCategory",t.id),class:a(["filter-chip",{active:d.selectedCategory===t.id}])},r(t.name),11,_))),128))])])):l("",!0),(null==(f=d.additionalFilters)?void 0:f.length)?(c(),e("div",T,[(c(!0),e(s,null,i(d.additionalFilters,l=>(c(),e("div",{key:l.key,class:"filter-group"},[t("div",A,[t("span",w,r(l.icon||"tune"),1),t("span",null,r(l.label),1)]),t("div",L,[t("button",{onClick:e=>o.$emit("update:additionalFilter",{key:l.key,value:null}),class:a(["filter-chip",{active:!y.getFilterValue(l.key)}])},r(l.allLabel||"Tous"),11,E),(c(!0),e(s,null,i(l.options,t=>(c(),e("button",{key:t.value,onClick:e=>o.$emit("update:additionalFilter",{key:l.key,value:t.value}),class:a(["filter-chip",{active:y.getFilterValue(l.key)===t.value}])},r(t.label),11,Q))),128))])]))),128))])):l("",!0),null!==d.resultsCount?(c(),e("div",S,[n(r(d.resultsCount)+" "+r(d.itemType)+r(d.resultsCount>1?"s":"")+" ",1),d.searchQuery?(c(),e("span",$,' pour "'+r(d.searchQuery)+'"',1)):l("",!0)])):l("",!0)])}],["__scopeId","data-v-7a0d9b3b"]])},setup(){const e=y(),t=d([]),l=d([]),a=d(!1),s=d(null),i=d(""),r=d(null),n=d({eventType:null,eventFormat:null,price:null,status:null}),c=v(()=>{let e=t.value;if(i.value.trim()){const t=i.value.toLowerCase();e=e.filter(e=>{var l,a,s,i,r,n;return(null==(l=e.title)?void 0:l.toLowerCase().includes(t))||(null==(a=e.description)?void 0:a.toLowerCase().includes(t))||(null==(s=e.short_description)?void 0:s.toLowerCase().includes(t))||(null==(i=e.location)?void 0:i.toLowerCase().includes(t))||(null==(r=e.city)?void 0:r.toLowerCase().includes(t))||(null==(n=e.organizer_name)?void 0:n.toLowerCase().includes(t))})}return r.value&&(e=e.filter(e=>e.category_id===r.value)),n.value.eventType&&(e=e.filter(e=>e.event_type===n.value.eventType)),n.value.eventFormat&&(e=e.filter(e=>e.event_format===n.value.eventFormat)),n.value.price&&("free"===n.value.price?e=e.filter(e=>e.is_free):"paid"===n.value.price&&(e=e.filter(e=>!e.is_free))),n.value.status&&(e=e.filter(e=>e.status===n.value.status)),e}),o=v(()=>Object.values(n.value).some(e=>null!==e)),u=v(()=>[{key:"eventType",label:"Type d'événement",icon:"category",allLabel:"Tous les types",options:[{value:"conference",label:"Conférence"},{value:"workshop",label:"Atelier"},{value:"seminar",label:"Séminaire"},{value:"cooking_class",label:"Cours de cuisine"},{value:"tasting",label:"Dégustation"},{value:"festival",label:"Festival"},{value:"competition",label:"Concours"},{value:"networking",label:"Networking"},{value:"exhibition",label:"Exposition"},{value:"party",label:"Fête"}]},{key:"eventFormat",label:"Format",icon:"computer",allLabel:"Tous les formats",options:[{value:"in_person",label:"En présentiel"},{value:"online",label:"En ligne"},{value:"hybrid",label:"Hybride"}]},{key:"price",label:"Tarif",icon:"payments",allLabel:"Tous les tarifs",options:[{value:"free",label:"Gratuit"},{value:"paid",label:"Payant"}]},{key:"status",label:"Statut",icon:"info",allLabel:"Tous les statuts",options:[{value:"active",label:"Actif"},{value:"upcoming",label:"À venir"},{value:"completed",label:"Terminé"}]}]),f=async()=>{a.value=!0,s.value=null;try{const e=await m.getEvents();if(!e.success)throw new Error(e.message||"Failed to fetch events");t.value=e.data}catch(e){s.value=e.message,console.error("Error fetching events:",e)}finally{a.value=!1}},g=async()=>{try{const e=await m.getCategories();e.success&&(l.value=e.data)}catch(e){console.warn("Error fetching categories:",e)}};return p(()=>{f(),g()}),{events:t,categories:l,loading:a,error:s,searchQuery:i,selectedCategory:r,selectedFilters:n,filteredEvents:c,hasActiveFilters:o,eventFilters:u,goToEvent:t=>{e.push(`/event/${t}`)},retry:()=>{s.value=null,f(),g()},updateAdditionalFilter:({key:e,value:t})=>{n.value[e]=t},clearAllFilters:()=>{i.value="",r.value=null,n.value={eventType:null,eventFormat:null,price:null,status:null}},getStatusClass:e=>({active:"status-active",cancelled:"status-cancelled",completed:"status-completed",upcoming:"status-upcoming"}[e]||"status-default"),getStatusLabel:e=>({active:"Actif",cancelled:"Annulé",completed:"Terminé",upcoming:"À venir"}[e]||"Non défini"),getEventTypeLabel:e=>({festival:"Festival",cooking_class:"Cours de cuisine",tasting:"Dégustation",workshop:"Atelier",conference:"Conférence"}[e]||e),formatDate:e=>e?new Date(e).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}):"",formatTime:e=>e?new Date(`2000-01-01T${e}`).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}):"",formatPrice:(e,t="XOF")=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:t}).format(e)}}},[["render",function(n,d,v,p,y,m){const f=u("SearchAndFilters");return c(),e("div",j,[d[12]||(d[12]=t("header",{class:"page-header"},[t("div",{class:"header-content"},[t("h1",null,"Événements"),t("p",{class:"subtitle"},"Participez à nos événements culinaires")])],-1)),o(f,{searchQuery:p.searchQuery,"onUpdate:searchQuery":d[0]||(d[0]=e=>p.searchQuery=e),selectedCategory:p.selectedCategory,"onUpdate:selectedCategory":d[1]||(d[1]=e=>p.selectedCategory=e),"search-placeholder":"Rechercher un événement...",categories:p.categories,"additional-filters":p.eventFilters,"selected-filters":p.selectedFilters,"results-count":p.filteredEvents.length,"item-type":"événement","onUpdate:additionalFilter":p.updateAdditionalFilter},null,8,["searchQuery","selectedCategory","categories","additional-filters","selected-filters","results-count","onUpdate:additionalFilter"]),p.loading?(c(),e("div",D,d[4]||(d[4]=[t("div",{class:"loading-spinner"},null,-1),t("p",null,"Chargement des événements...",-1)]))):p.error?(c(),e("div",x,[d[5]||(d[5]=t("div",{class:"error-icon"},[t("span",{class:"material-symbols-outlined"},"error")],-1)),t("p",null,r(p.error),1),t("button",{onClick:d[2]||(d[2]=(...e)=>p.retry&&p.retry(...e)),class:"retry-btn"}," Réessayer ")])):(c(),e("div",P,[p.filteredEvents.length||p.loading?(c(),e("div",I,[(c(!0),e(s,null,i(p.filteredEvents,s=>(c(),e("article",{key:s.id,onClick:e=>p.goToEvent(s.id),class:"event-card"},[t("div",O,[t("img",{src:s.featured_image_url||"/images/default-event.jpg",alt:s.title,loading:"lazy"},null,8,V),t("div",G,[t("span",{class:a(p.getStatusClass(s.status))},r(p.getStatusLabel(s.status)),3)])]),t("div",H,[t("div",X,[t("h3",q,r(s.title),1),s.price?(c(),e("div",B,[s.is_free?(c(),e("span",J,"Gratuit")):(c(),e("span",K,r(p.formatPrice(s.price,s.currency)),1))])):l("",!0)]),s.short_description?(c(),e("p",M,r(s.short_description),1)):l("",!0),t("div",W,[t("div",Y,[d[7]||(d[7]=t("span",{class:"material-symbols-outlined"},"calendar_today",-1)),t("span",null,r(p.formatDate(s.start_date)),1)]),s.start_time?(c(),e("div",Z,[d[8]||(d[8]=t("span",{class:"material-symbols-outlined"},"schedule",-1)),t("span",null,r(p.formatTime(s.start_time)),1)])):l("",!0),s.location?(c(),e("div",ee,[d[9]||(d[9]=t("span",{class:"material-symbols-outlined"},"location_on",-1)),t("span",null,r(s.location),1)])):l("",!0),s.event_type?(c(),e("div",te,[d[10]||(d[10]=t("span",{class:"material-symbols-outlined"},"category",-1)),t("span",null,r(p.getEventTypeLabel(s.event_type)),1)])):l("",!0)]),s.max_participants?(c(),e("div",le,[d[11]||(d[11]=t("span",{class:"material-symbols-outlined"},"group",-1)),t("span",null,r(s.participants_count||0)+" / "+r(s.max_participants)+" participants",1)])):l("",!0)])],8,U))),128))])):(c(),e("div",R,[d[6]||(d[6]=t("div",{class:"empty-icon"},[t("span",{class:"material-symbols-outlined"},"event")],-1)),t("h3",null,r(p.searchQuery||p.selectedCategory||p.hasActiveFilters?"Aucun événement trouvé":"Aucun événement disponible"),1),p.searchQuery||p.selectedCategory||p.hasActiveFilters?(c(),e("p",N," Essayez de modifier vos critères de recherche. ")):(c(),e("p",z," Les événements culinaires seront bientôt disponibles. ")),p.searchQuery||p.selectedCategory||p.hasActiveFilters?(c(),e("button",{key:2,onClick:d[3]||(d[3]=(...e)=>p.clearAllFilters&&p.clearAllFilters(...e)),class:"clear-filters-btn"}," Effacer tous les filtres ")):l("",!0)]))]))])}],["__scopeId","data-v-d58e6f5f"]]);export{ae as default};
