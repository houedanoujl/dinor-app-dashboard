import{e,f as a,t as r,r as o,b as s,h as n,o as l,u as t,j as c}from"./vendor.CNJ67EhX.js";import{_ as i}from"./main.a-2UG2Uh.js";const u={class:"web-embed"},d={class:"md3-top-app-bar"},m={class:"md3-app-bar-container"},v={class:"md3-app-bar-title"},b={class:"md3-title-large dinor-text-primary"},p={class:"md3-app-bar-actions"},g={class:"md3-main-content"},f={key:0,class:"loading-container"},y={key:1,class:"error-state"},k={class:"md3-body-large dinor-text-gray"},I={class:"error-actions"},h={key:2,class:"iframe-container"},w=["src"];const L=i({name:"WebEmbed",setup(){const e=t(),a=n(),r=o(null),c=o(!0),i=o(!1),u=o(""),d=o("Page Web"),m=s(()=>{const e=a.query.url;if(!e)return"";try{return new URL(decodeURIComponent(e)),decodeURIComponent(e)}catch(r){return i.value=!0,u.value="URL invalide fournie",""}}),v=()=>{r.value&&m.value&&(c.value=!0,i.value=!1,r.value.src=m.value)};return l(()=>{m.value||(i.value=!0,u.value="Aucune URL fournie pour l'affichage",c.value=!1),setTimeout(()=>{c.value&&(c.value=!1,i.value=!0,u.value="Délai de chargement dépassé")},15e3)}),{webFrame:r,loading:c,error:i,errorMessage:u,pageTitle:d,embedUrl:m,onIframeLoad:()=>{c.value=!1,i.value=!1;try{if(r.value&&r.value.contentDocument){const e=r.value.contentDocument.title;e&&(d.value=e)}}catch(e){console.log("Impossible de récupérer le titre (CORS):",e.message)}},onIframeError:()=>{c.value=!1,i.value=!0,u.value="Impossible de charger la page demandée. Vérifiez que l'URL est correcte et accessible."},refreshPage:v,retryLoad:()=>{v()},openInNewTab:()=>{m.value&&window.open(m.value,"_blank","noopener,noreferrer")},goBack:()=>{e.go(-1)}}}},[["render",function(o,s,n,l,t,i){return c(),e("div",u,[a("nav",d,[a("div",m,[a("button",{onClick:s[0]||(s[0]=(...e)=>l.goBack&&l.goBack(...e)),class:"md3-icon-button"},s[7]||(s[7]=[a("i",{class:"material-icons"},"arrow_back",-1)])),a("div",v,[a("h1",b,r(l.pageTitle),1)]),a("div",p,[a("button",{onClick:s[1]||(s[1]=(...e)=>l.refreshPage&&l.refreshPage(...e)),class:"md3-icon-button"},s[8]||(s[8]=[a("i",{class:"material-icons"},"refresh",-1)])),a("button",{onClick:s[2]||(s[2]=(...e)=>l.openInNewTab&&l.openInNewTab(...e)),class:"md3-icon-button"},s[9]||(s[9]=[a("i",{class:"material-icons"},"open_in_new",-1)]))])])]),a("main",g,[l.loading?(c(),e("div",f,s[10]||(s[10]=[a("div",{class:"md3-circular-progress"},null,-1),a("p",{class:"md3-body-large"},"Chargement de la page...",-1)]))):l.error?(c(),e("div",y,[s[11]||(s[11]=a("div",{class:"error-icon"},[a("i",{class:"material-icons"},"error_outline")],-1)),s[12]||(s[12]=a("h2",{class:"md3-title-large"},"Erreur de chargement",-1)),a("p",k,r(l.errorMessage),1),a("div",I,[a("button",{onClick:s[3]||(s[3]=(...e)=>l.retryLoad&&l.retryLoad(...e)),class:"btn-primary"},"Réessayer"),a("button",{onClick:s[4]||(s[4]=(...e)=>l.goBack&&l.goBack(...e)),class:"btn-secondary"},"Retour")])])):(c(),e("div",h,[a("iframe",{ref:"webFrame",src:l.embedUrl,class:"web-iframe",title:"Page Web Intégrée",frameborder:"0",allowfullscreen:"",onLoad:s[5]||(s[5]=(...e)=>l.onIframeLoad&&l.onIframeLoad(...e)),onError:s[6]||(s[6]=(...e)=>l.onIframeError&&l.onIframeError(...e))},null,40,w)]))])])}],["__scopeId","data-v-f389f6c7"]]);export{L as default};
