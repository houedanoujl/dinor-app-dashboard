import{e as t,f as e,t as a,n as s,m as i,F as o,g as r,A as n,B as c,r as l,o as d,u as m,h as p,j as u}from"./vendor.CNJ67EhX.js";import{_ as g,c as v}from"./main.a-2UG2Uh.js";const y={class:"tip-detail"},h={class:"md3-top-app-bar"},b={class:"md3-app-bar-container"},k={class:"md3-app-bar-title"},f={class:"md3-title-large dinor-text-primary"},w={class:"md3-app-bar-actions"},x={class:"material-icons"},_={class:"md3-main-content"},C={key:0,class:"loading-container"},L={key:1,class:"tip-content"},A={key:0,class:"tip-hero"},j=["src","alt"],D={class:"tip-overlay dinor-gradient-primary"},E={class:"tip-badges"},T={key:0,class:"md3-chip tip-difficulty"},B={key:1,class:"md3-chip tip-category"},H={class:"tip-info"},I={class:"tip-stats"},$={class:"stat-item"},S={class:"md3-body-medium"},F={class:"stat-item"},M={class:"md3-body-medium"},R={class:"stat-item"},U={class:"md3-body-medium"},q={class:"tip-content-text"},z=["innerHTML"],P={key:0,class:"tip-tags"},V={class:"tags-container"},G={class:"comments-section"},J={class:"md3-title-medium dinor-text-primary"},K={class:"add-comment-form"},N=["disabled"],O={key:0,class:"comments-list"},Q={class:"comment-header"},W={class:"comment-author md3-body-medium"},X={class:"comment-date md3-body-small dinor-text-gray"},Y={class:"comment-content md3-body-medium"},Z={key:1,class:"empty-comments"},tt={key:2,class:"error-state"},et={class:"error-actions"};const at=g({name:"TipDetail",props:{id:{type:String,required:!0}},setup(t){const e=m();p();const a=v(),s=l(null),i=l([]),o=l(!0),r=l(!1),n=l(""),c=async()=>{try{const e=await a.get("/comments",{type:"tip",id:t.id});e.success&&(i.value=e.data)}catch(e){console.error("Erreur lors du chargement des commentaires:",e)}},u=async()=>{try{const e=await a.get("/likes/check",{type:"tip",id:t.id});r.value=e.success&&e.data.liked}catch(e){console.error("Erreur lors de la vérification du like:",e)}};return d(()=>{(async()=>{try{const e=await a.get(`/tips/${t.id}`);e.success&&(s.value=e.data,await c(),await u())}catch(e){console.error("Erreur lors du chargement de l'astuce:",e)}finally{o.value=!1}})()}),{tip:s,comments:i,loading:o,userLiked:r,newComment:n,toggleLike:async()=>{try{const e=await a.post("/likes/toggle",{likeable_type:"tip",likeable_id:t.id});e.success&&(r.value=!r.value,s.value&&(s.value.likes_count=e.data.total_likes))}catch(e){console.error("Erreur lors du toggle like:",e)}},addComment:async()=>{if(n.value.trim())try{(await a.post("/comments",{type:"tip",id:t.id,content:n.value,author_name:"Utilisateur"})).success&&(await c(),n.value="")}catch(e){console.error("Erreur lors de l'ajout du commentaire:",e)}},shareTip:()=>{navigator.share&&s.value?navigator.share({title:s.value.title,text:s.value.content,url:window.location.href}):(navigator.clipboard.writeText(window.location.href),alert("Lien copié dans le presse-papiers!"))},goBack:()=>{e.push("/tips")},goHome:()=>{e.push("/")},getDifficultyLabel:t=>({beginner:"Débutant",intermediate:"Intermédiaire",advanced:"Avancé"}[t]||"Débutant"),formatDate:t=>new Date(t).toLocaleDateString("fr-FR"),handleImageError:t=>{t.target.src="/images/default-recipe.jpg"},formatContent:t=>t?"string"==typeof t?t:Array.isArray(t)?t.map((t,e)=>"object"==typeof t&&t.step?`<div class="content-step">\n              <h4>Étape ${e+1}</h4>\n              <p>${t.step}</p>\n            </div>`:"string"==typeof t?`<div class="content-step">\n              <p>${t}</p>\n            </div>`:`<div class="content-step"><p>${t}</p></div>`).join(""):t.toString():""}}},[["render",function(l,d,m,p,g,v){var at;return u(),t("div",y,[e("nav",h,[e("div",b,[e("button",{onClick:d[0]||(d[0]=(...t)=>p.goBack&&p.goBack(...t)),class:"md3-icon-button"},d[8]||(d[8]=[e("i",{class:"material-icons"},"arrow_back",-1)])),e("div",k,[e("h1",f,a((null==(at=p.tip)?void 0:at.title)||"Astuce"),1)]),e("div",w,[e("button",{onClick:d[1]||(d[1]=(...t)=>p.toggleLike&&p.toggleLike(...t)),class:s(["md3-icon-button",{liked:p.userLiked}])},[e("i",x,a(p.userLiked?"favorite":"favorite_border"),1)],2),e("button",{onClick:d[2]||(d[2]=(...t)=>p.shareTip&&p.shareTip(...t)),class:"md3-icon-button"},d[9]||(d[9]=[e("i",{class:"material-icons"},"share",-1)]))])])]),e("main",_,[p.loading?(u(),t("div",C,d[10]||(d[10]=[e("div",{class:"md3-circular-progress"},null,-1),e("p",{class:"md3-body-large"},"Chargement de l'astuce...",-1)]))):p.tip?(u(),t("div",L,[p.tip.image?(u(),t("div",A,[e("img",{src:p.tip.image||"/images/default-recipe.jpg",alt:p.tip.title,class:"tip-hero-image",onError:d[3]||(d[3]=(...t)=>p.handleImageError&&p.handleImageError(...t))},null,40,j),e("div",D,[e("div",E,[p.tip.difficulty_level?(u(),t("div",T,[d[11]||(d[11]=e("i",{class:"material-icons"},"lightbulb",-1)),e("span",null,a(p.getDifficultyLabel(p.tip.difficulty_level)),1)])):i("",!0),p.tip.category?(u(),t("div",B,[d[12]||(d[12]=e("i",{class:"material-icons"},"tag",-1)),e("span",null,a(p.tip.category.name),1)])):i("",!0)])])])):i("",!0),e("div",H,[e("div",I,[e("div",$,[d[13]||(d[13]=e("i",{class:"material-icons dinor-text-secondary"},"schedule",-1)),e("span",S,a(p.tip.estimated_time)+"min",1)]),e("div",F,[d[14]||(d[14]=e("i",{class:"material-icons dinor-text-secondary"},"favorite",-1)),e("span",M,a(p.tip.likes_count||0),1)]),e("div",R,[d[15]||(d[15]=e("i",{class:"material-icons dinor-text-secondary"},"comment",-1)),e("span",U,a(p.tip.comments_count||0),1)])]),e("div",q,[d[16]||(d[16]=e("h2",{class:"md3-title-medium dinor-text-primary"},"Astuce",-1)),e("div",{class:"md3-body-large dinor-text-gray",innerHTML:p.formatContent(p.tip.content)},null,8,z)]),p.tip.tags&&p.tip.tags.length?(u(),t("div",P,[d[17]||(d[17]=e("h3",{class:"md3-title-small dinor-text-primary"},"Tags",-1)),e("div",V,[(u(!0),t(o,null,r(p.tip.tags,e=>(u(),t("span",{key:e,class:"md3-chip"},a(e),1))),128))])])):i("",!0),e("div",G,[e("h2",J,"Commentaires ("+a(p.comments.length)+")",1),e("div",K,[n(e("textarea",{"onUpdate:modelValue":d[4]||(d[4]=t=>p.newComment=t),placeholder:"Ajoutez votre commentaire...",class:"md3-textarea",rows:"3"},"              ",512),[[c,p.newComment]]),e("button",{onClick:d[5]||(d[5]=(...t)=>p.addComment&&p.addComment(...t)),class:"btn-primary",disabled:!p.newComment.trim()}," Publier ",8,N)]),p.comments.length?(u(),t("div",O,[(u(!0),t(o,null,r(p.comments,s=>(u(),t("div",{key:s.id,class:"comment-item"},[e("div",Q,[e("span",W,a(s.author_name),1),e("span",X,a(p.formatDate(s.created_at)),1)]),e("p",Y,a(s.content),1)]))),128))])):(u(),t("div",Z,d[18]||(d[18]=[e("p",{class:"md3-body-medium dinor-text-gray"},"Aucun commentaire pour le moment.",-1)])))])])])):(u(),t("div",tt,[d[19]||(d[19]=e("div",{class:"error-icon"},[e("i",{class:"material-icons"},"error_outline")],-1)),d[20]||(d[20]=e("h2",{class:"md3-title-large"},"Astuce introuvable",-1)),d[21]||(d[21]=e("p",{class:"md3-body-large dinor-text-gray"},"L'astuce demandée n'existe pas ou a été supprimée.",-1)),e("div",et,[e("button",{onClick:d[6]||(d[6]=(...t)=>p.goBack&&p.goBack(...t)),class:"btn-secondary"},"Retour aux astuces"),e("button",{onClick:d[7]||(d[7]=(...t)=>p.goHome&&p.goHome(...t)),class:"btn-primary"},"Accueil")])]))])])}],["__scopeId","data-v-62acf075"]]);export{at as default};
