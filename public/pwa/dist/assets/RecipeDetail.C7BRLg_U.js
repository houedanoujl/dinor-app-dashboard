import{e,f as t,t as a,n as i,m as s,F as r,g as c,A as n,B as o,r as l,o as d,u as m,h as p,j as u}from"./vendor.CNJ67EhX.js";import{_ as g,c as y}from"./main.a-2UG2Uh.js";const v={class:"recipe-detail"},h={class:"md3-top-app-bar"},b={class:"md3-app-bar-container"},k={class:"md3-app-bar-title"},f={class:"md3-title-large dinor-text-primary"},w={class:"md3-app-bar-actions"},x={class:"material-icons"},_={class:"md3-main-content"},L={key:0,class:"loading-container"},C={key:1,class:"recipe-content"},D={class:"recipe-hero"},j=["src","alt"],E={class:"recipe-overlay dinor-gradient-primary"},I={class:"recipe-badges"},R={key:0,class:"md3-chip recipe-difficulty"},T={key:1,class:"md3-chip recipe-category"},A={class:"recipe-info"},B={class:"recipe-stats"},$={class:"stat-item"},S={class:"md3-body-medium"},q={class:"stat-item"},H={class:"md3-body-medium"},M={class:"stat-item"},P={class:"md3-body-medium"},F={class:"stat-item"},O={class:"md3-body-medium"},U={key:0,class:"recipe-description"},z=["innerHTML"],V={key:1,class:"recipe-ingredients"},G={class:"ingredients-list"},J={class:"md3-body-medium"},K={key:2,class:"recipe-instructions"},N=["innerHTML"],Q={class:"comments-section"},W={class:"md3-title-medium dinor-text-primary"},X={class:"add-comment-form"},Y=["disabled"],Z={key:0,class:"comments-list"},ee={class:"comment-header"},te={class:"comment-author md3-body-medium"},ae={class:"comment-date md3-body-small dinor-text-gray"},ie={class:"comment-content md3-body-medium"},se={key:1,class:"empty-comments"},re={key:2,class:"error-state"};const ce=g({name:"RecipeDetail",props:{id:{type:String,required:!0}},setup(e){const t=m();p();const a=y(),i=l(null),s=l([]),r=l(!0),c=l(!1),n=l(""),o=async()=>{try{const t=await a.get("/comments",{type:"recipe",id:e.id});t.success&&(s.value=t.data)}catch(t){console.error("Erreur lors du chargement des commentaires:",t)}},u=async()=>{try{const t=await a.get("/likes/check",{type:"recipe",id:e.id});c.value=t.success&&t.data.liked}catch(t){console.error("Erreur lors de la vérification du like:",t)}};return d(()=>{(async()=>{try{const t=await a.get(`/recipes/${e.id}`);t.success&&(i.value=t.data,await o(),await u())}catch(t){console.error("Erreur lors du chargement de la recette:",t)}finally{r.value=!1}})()}),{recipe:i,comments:s,loading:r,userLiked:c,newComment:n,toggleLike:async()=>{try{const t=await request("/api/v1/likes/toggle",{method:"POST",body:{likeable_type:"recipe",likeable_id:e.id}});t.success&&(c.value=!c.value,i.value&&(i.value.likes_count=t.data.total_likes))}catch(t){console.error("Erreur lors du toggle like:",t)}},addComment:async()=>{if(n.value.trim())try{(await request("/api/v1/comments",{method:"POST",body:{type:"recipe",id:e.id,content:n.value,author_name:"Utilisateur"}})).success&&(await o(),n.value="")}catch(t){console.error("Erreur lors de l'ajout du commentaire:",t)}},shareRecipe:()=>{navigator.share&&i.value?navigator.share({title:i.value.title,text:i.value.description,url:window.location.href}):(navigator.clipboard.writeText(window.location.href),alert("Lien copié dans le presse-papiers!"))},goBack:()=>{t.push("/recipes")},getDifficultyLabel:e=>({beginner:"Débutant",intermediate:"Intermédiaire",advanced:"Avancé"}[e]||"Débutant"),formatDate:e=>new Date(e).toLocaleDateString("fr-FR"),handleImageError:e=>{e.target.src="/images/default-recipe.jpg"},formatInstructions:e=>e?"string"==typeof e?e:Array.isArray(e)?e.map((e,t)=>"object"==typeof e&&e.step?`<div class="instruction-step">\n              <h4>Étape ${t+1}</h4>\n              <p>${e.step}</p>\n            </div>`:"string"==typeof e?`<div class="instruction-step">\n              <h4>Étape ${t+1}</h4>\n              <p>${e}</p>\n            </div>`:`<div class="instruction-step"><p>${e}</p></div>`).join(""):e.toString():""}}},[["render",function(l,d,m,p,g,y){var ce;return u(),e("div",v,[t("nav",h,[t("div",b,[t("button",{onClick:d[0]||(d[0]=(...e)=>p.goBack&&p.goBack(...e)),class:"md3-icon-button"},d[7]||(d[7]=[t("i",{class:"material-icons"},"arrow_back",-1)])),t("div",k,[t("h1",f,a((null==(ce=p.recipe)?void 0:ce.title)||"Recette"),1)]),t("div",w,[t("button",{onClick:d[1]||(d[1]=(...e)=>p.toggleLike&&p.toggleLike(...e)),class:i(["md3-icon-button",{liked:p.userLiked}])},[t("i",x,a(p.userLiked?"favorite":"favorite_border"),1)],2),t("button",{onClick:d[2]||(d[2]=(...e)=>p.shareRecipe&&p.shareRecipe(...e)),class:"md3-icon-button"},d[8]||(d[8]=[t("i",{class:"material-icons"},"share",-1)]))])])]),t("main",_,[p.loading?(u(),e("div",L,d[9]||(d[9]=[t("div",{class:"md3-circular-progress"},null,-1),t("p",{class:"md3-body-large"},"Chargement de la recette...",-1)]))):p.recipe?(u(),e("div",C,[t("div",D,[t("img",{src:p.recipe.image||"/images/default-recipe.jpg",alt:p.recipe.title,class:"recipe-hero-image",onError:d[3]||(d[3]=(...e)=>p.handleImageError&&p.handleImageError(...e))},null,40,j),t("div",E,[t("div",I,[p.recipe.difficulty_level?(u(),e("div",R,[d[10]||(d[10]=t("i",{class:"material-icons"},"restaurant",-1)),t("span",null,a(p.getDifficultyLabel(p.recipe.difficulty_level)),1)])):s("",!0),p.recipe.category?(u(),e("div",T,[d[11]||(d[11]=t("i",{class:"material-icons"},"tag",-1)),t("span",null,a(p.recipe.category.name),1)])):s("",!0)])])]),t("div",A,[t("div",B,[t("div",$,[d[12]||(d[12]=t("i",{class:"material-icons dinor-text-secondary"},"schedule",-1)),t("span",S,a(p.recipe.cooking_time)+"min",1)]),t("div",q,[d[13]||(d[13]=t("i",{class:"material-icons dinor-text-secondary"},"people",-1)),t("span",H,a(p.recipe.servings)+" pers.",1)]),t("div",M,[d[14]||(d[14]=t("i",{class:"material-icons dinor-text-secondary"},"favorite",-1)),t("span",P,a(p.recipe.likes_count||0),1)]),t("div",F,[d[15]||(d[15]=t("i",{class:"material-icons dinor-text-secondary"},"comment",-1)),t("span",O,a(p.recipe.comments_count||0),1)])]),p.recipe.description?(u(),e("div",U,[d[16]||(d[16]=t("h2",{class:"md3-title-medium dinor-text-primary"},"Description",-1)),t("p",{class:"md3-body-large dinor-text-gray",innerHTML:p.recipe.description},null,8,z)])):s("",!0),p.recipe.ingredients&&p.recipe.ingredients.length?(u(),e("div",V,[d[17]||(d[17]=t("h2",{class:"md3-title-medium dinor-text-primary"},"Ingrédients",-1)),t("ul",G,[(u(!0),e(r,null,c(p.recipe.ingredients,i=>(u(),e("li",{key:i.id,class:"ingredient-item"},[t("span",J,a(i.quantity)+" "+a(i.unit)+" "+a(i.name),1)]))),128))])])):s("",!0),p.recipe.instructions?(u(),e("div",K,[d[18]||(d[18]=t("h2",{class:"md3-title-medium dinor-text-primary"},"Instructions",-1)),t("div",{class:"md3-body-large dinor-text-gray",innerHTML:p.formatInstructions(p.recipe.instructions)},null,8,N)])):s("",!0),t("div",Q,[t("h2",W,"Commentaires ("+a(p.comments.length)+")",1),t("div",X,[n(t("textarea",{"onUpdate:modelValue":d[4]||(d[4]=e=>p.newComment=e),placeholder:"Ajoutez votre commentaire...",class:"md3-textarea",rows:"3"},"              ",512),[[o,p.newComment]]),t("button",{onClick:d[5]||(d[5]=(...e)=>p.addComment&&p.addComment(...e)),class:"btn-primary",disabled:!p.newComment.trim()}," Publier ",8,Y)]),p.comments.length?(u(),e("div",Z,[(u(!0),e(r,null,c(p.comments,i=>(u(),e("div",{key:i.id,class:"comment-item"},[t("div",ee,[t("span",te,a(i.author_name),1),t("span",ae,a(p.formatDate(i.created_at)),1)]),t("p",ie,a(i.content),1)]))),128))])):(u(),e("div",se,d[19]||(d[19]=[t("p",{class:"md3-body-medium dinor-text-gray"},"Aucun commentaire pour le moment.",-1)])))])])])):(u(),e("div",re,[d[20]||(d[20]=t("div",{class:"error-icon"},[t("i",{class:"material-icons"},"error_outline")],-1)),d[21]||(d[21]=t("h2",{class:"md3-title-large"},"Recette introuvable",-1)),d[22]||(d[22]=t("p",{class:"md3-body-large dinor-text-gray"},"La recette demandée n'existe pas ou a été supprimée.",-1)),t("button",{onClick:d[6]||(d[6]=(...e)=>p.goBack&&p.goBack(...e)),class:"btn-primary"},"Retour")]))])])}],["__scopeId","data-v-8d1b09f0"]]);export{ce as default};
