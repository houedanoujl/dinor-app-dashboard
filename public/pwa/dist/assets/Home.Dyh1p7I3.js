import{b as e,r as t,m as a,C as l,p as i,d as s,e as r,v as n,t as o,w as c,z as d,j as u,f as v,F as m,i as p,n as g,g as f,h as y,o as h}from"./vendor.BeqKZlTx.js";import{u as b}from"./useApi.XzjE-Aek.js";import{B as _,u as k}from"./BannerSection.L2GxXlpZ.js";import{_ as D}from"./index.W0j3SMuK.js";import"./api.DeptcIQc.js";const C={name:"ContentCarousel",props:{title:{type:String,required:!0},items:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},error:{type:String,default:null},contentType:{type:String,required:!0,validator:e=>["recipes","tips","events","videos"].includes(e)},viewAllLink:{type:String,required:!0},showControls:{type:Boolean,default:!0},showIndicators:{type:Boolean,default:!1},itemsPerView:{type:Number,default:4}},emits:["item-click"],setup(e,{emit:s}){const r=y(),n=t(null),o=t(0),c=t(!1),d=t(!0),u=()=>{const e=n.value;e&&(c.value=e.scrollLeft>0,d.value=e.scrollLeft<e.scrollWidth-e.clientWidth)},v=()=>({recipes:"/images/default-recipe.jpg",tips:"/images/default-tip.jpg",events:"/images/default-event.jpg",videos:"/images/default-video.jpg"}[e.contentType]||"/images/default-recipe.jpg");return a(async()=>{await l(),u();const e=n.value;e&&e.addEventListener("scroll",u)}),i(()=>{const e=n.value;e&&e.removeEventListener("scroll",u)}),{carouselRef:n,currentIndex:o,canScrollLeft:c,canScrollRight:d,scrollCarousel:e=>{var t;const a=n.value;if(!a)return;const l=2*(((null==(t=a.querySelector(".carousel-item"))?void 0:t.offsetWidth)||280)+16);a.scrollBy({left:e*l,behavior:"smooth"}),setTimeout(u,300)},scrollToIndex:e=>{var t;const a=n.value;if(!a)return;const l=e*(((null==(t=a.querySelector(".carousel-item"))?void 0:t.offsetWidth)||280)+16);a.scrollTo({left:l,behavior:"smooth"}),o.value=e},handleItemClick:t=>{s("item-click",t);const a={recipes:`/recipe/${t.id}`,tips:`/tip/${t.id}`,events:`/event/${t.id}`,videos:`/video/${t.id}`}[e.contentType];a&&r.push(a)},getShortDescription:e=>{if(!e)return"Aucune description disponible";return e.length>100?e.substring(0,100)+"...":e},formatDate:e=>{if(!e)return"";return new Date(e).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"})},formatDuration:e=>{if(!e)return"";return`${Math.floor(e/60)}:${(e%60).toString().padStart(2,"0")}`},getDifficultyLabel:e=>({easy:"Facile",medium:"Moyen",hard:"Difficile",beginner:"Débutant",intermediate:"Intermédiaire",advanced:"Avancé"}[e]||e||"Non spécifié"),getStatusLabel:e=>({active:"Actif",upcoming:"À venir",completed:"Terminé",cancelled:"Annulé",draft:"Brouillon",published:"Publié"}[e]||e||"Non défini"),getStatusClass:e=>`status-${e}`,getItemClass:()=>`content-${e.contentType}`,getTypeIcon:()=>({recipes:"restaurant",tips:"lightbulb",events:"event",videos:"play_circle"}[e.contentType]||"info"),getDefaultImage:v,getVideoThumbnail:e=>{if((null==e?void 0:e.includes("youtube.com"))||(null==e?void 0:e.includes("youtu.be"))){return`https://img.youtube.com/vi/${e.split("v=")[1]||e.split("/").pop()}/maxresdefault.jpg`}return"/images/default-video-thumbnail.jpg"},handleImageError:e=>{e.target.src=v()}}}},T={class:"content-carousel"},S={class:"section-header"},I={class:"carousel-container"},w={key:0,class:"carousel-loading"},j={key:1,class:"carousel-error"},L={key:2,class:"carousel-empty"},E={key:3,class:"carousel-wrapper"},V=["onClick"],$={class:"default-card"},x={key:0,class:"card-image"},R=["src","alt"],A={class:"card-overlay"},B={key:0,class:"time-badge"},F={key:1,class:"card-icon"},q={class:"material-symbols-outlined"},z={class:"card-content"},M={class:"card-meta"},W={key:0,class:"likes"},N={key:1,class:"date"},P={key:2,class:"difficulty"},H={key:0,class:"carousel-controls"},G=["disabled"],J=["disabled"],K={key:1,class:"carousel-indicators"},O=["onClick"];const Q={class:"home"},U={class:"content-area"},X={class:"recipe-card"},Y={class:"card-image"},Z=["src","alt"],ee={class:"card-overlay"},te={key:0,class:"time-badge"},ae={key:1,class:"difficulty-badge"},le={class:"card-content"},ie={class:"card-meta"},se={class:"likes"},re={class:"date"},ne={class:"tip-card"},oe={class:"card-content"},ce={class:"card-meta"},de={key:0,class:"time"},ue={class:"difficulty"},ve={class:"date"},me={class:"event-card"},pe={class:"card-image"},ge=["src","alt"],fe={class:"card-overlay"},ye={class:"card-content"},he={class:"card-meta"},be={class:"date"},_e={class:"created"},ke={class:"video-card"},De={class:"video-thumbnail"},Ce=["src","alt"],Te={class:"video-overlay"},Se={key:0,class:"live-badge"},Ie={key:1,class:"duration-badge"},we={class:"card-content"},je={class:"card-meta"},Le={class:"views"},Ee={class:"date"};const Ve=D({name:"Home",components:{ContentCarousel:D(C,[["render",function(e,t,a,l,i,y){const b=u("router-link");return h(),s("section",T,[r("div",S,[r("h2",null,o(a.title),1),n(b,{to:a.viewAllLink,class:"see-all-btn"},{default:c(()=>t[3]||(t[3]=[d(" Voir tout "),r("span",{class:"material-symbols-outlined"},"arrow_forward",-1)])),_:1,__:[3]},8,["to"])]),r("div",I,[a.loading?(h(),s("div",w,t[4]||(t[4]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"Chargement...",-1)]))):a.error?(h(),s("div",j,t[5]||(t[5]=[r("span",{class:"material-symbols-outlined"},"error",-1),r("p",null,"Erreur lors du chargement",-1)]))):0===a.items.length?(h(),s("div",L,t[6]||(t[6]=[r("span",{class:"material-symbols-outlined"},"info",-1),r("p",null,"Aucun contenu disponible",-1)]))):(h(),s("div",E,[r("div",{class:"carousel",ref:l.carouselRef},[(h(!0),s(m,null,p(a.items,a=>(h(),s("div",{key:a.id,onClick:e=>l.handleItemClick(a),class:g(["carousel-item",l.getItemClass()])},[f(e.$slots,"item",{item:a,getShortDescription:l.getShortDescription},()=>[r("div",$,[a.featured_image_url||a.image_url?(h(),s("div",x,[r("img",{src:a.featured_image_url||a.image_url||l.getDefaultImage(),alt:a.title,loading:"lazy",onError:t[0]||(t[0]=(...e)=>l.handleImageError&&l.handleImageError(...e))},null,40,R),r("div",A,[a.preparation_time||a.estimated_time?(h(),s("span",B,o(a.preparation_time||a.estimated_time)+"min ",1)):v("",!0),a.status?(h(),s("span",{key:1,class:g([l.getStatusClass(a.status),"status-badge"])},o(l.getStatusLabel(a.status)),3)):v("",!0)])])):(h(),s("div",F,[r("span",q,o(l.getTypeIcon()),1)])),r("div",z,[r("h3",null,o(a.title),1),r("p",null,o(l.getShortDescription(a.short_description||a.content||a.description)),1),r("div",M,[a.likes_count?(h(),s("span",W,[t[7]||(t[7]=r("span",{class:"material-symbols-outlined"},"favorite",-1)),d(" "+o(a.likes_count),1)])):v("",!0),a.created_at?(h(),s("span",N,o(l.formatDate(a.created_at)),1)):v("",!0),a.difficulty_level?(h(),s("span",P,o(l.getDifficultyLabel(a.difficulty_level)),1)):v("",!0)])])])])],10,V))),128))],512),a.showControls&&a.items.length>1?(h(),s("div",H,[r("button",{onClick:t[1]||(t[1]=e=>l.scrollCarousel(-1)),class:"carousel-btn prev",disabled:!l.canScrollLeft},t[8]||(t[8]=[r("span",{class:"material-symbols-outlined"},"chevron_left",-1)]),8,G),r("button",{onClick:t[2]||(t[2]=e=>l.scrollCarousel(1)),class:"carousel-btn next",disabled:!l.canScrollRight},t[9]||(t[9]=[r("span",{class:"material-symbols-outlined"},"chevron_right",-1)]),8,J)])):v("",!0),a.showIndicators&&a.items.length>1?(h(),s("div",K,[(h(!0),s(m,null,p(a.items,(e,t)=>(h(),s("button",{key:t,onClick:e=>l.scrollToIndex(t),class:g(["indicator",{active:l.currentIndex===t}])},null,10,O))),128))])):v("",!0)]))])])}],["__scopeId","data-v-3b79962d"]]),BannerSection:_},setup(){const t=y(),{banners:a,loading:l,error:i}=k(),{recipes:s,error:r,loading:n}=function(t={},a={}){const{data:l,error:i,loading:s,execute:r,refresh:n}=b("/recipes",t,{cacheTTL:3e5,...a}),o=e(()=>{var e,t;return(null==(t=null==(e=l.value)?void 0:e.data)?void 0:t.filter(e=>e.is_featured))||[]}),c=e(()=>{var e,t;return(null==(t=null==(e=l.value)?void 0:e.data)?void 0:t.sort((e,t)=>(t.likes_count||0)-(e.likes_count||0)))||[]});return{recipes:l,featuredRecipes:o,popularRecipes:c,error:i,loading:s,execute:r,refresh:n}}({limit:4,sort_by:"created_at",sort_order:"desc"}),{tips:o,error:c,loading:d}=function(t={},a={}){const{data:l,error:i,loading:s,execute:r,refresh:n}=b("/tips",t,{cacheTTL:3e5,...a}),o=e(()=>{var e,t;return(null==(t=null==(e=l.value)?void 0:e.data)?void 0:t.filter(e=>e.is_featured))||[]}),c=e(()=>{var e;const t={};return(null==(e=l.value)?void 0:e.data)&&l.value.data.forEach(e=>{const a=e.difficulty_level||"beginner";t[a]||(t[a]=[]),t[a].push(e)}),t});return{tips:l,featuredTips:o,tipsByDifficulty:c,error:i,loading:s,execute:r,refresh:n}}({limit:4,sort_by:"created_at",sort_order:"desc"}),{events:u,error:v,loading:m}=function(t={},a={}){const{data:l,error:i,loading:s,execute:r,refresh:n}=b("/events",t,{cacheTTL:3e5,...a}),o=e(()=>{var e,t;return(null==(t=null==(e=l.value)?void 0:e.data)?void 0:t.filter(e=>"active"===e.status))||[]}),c=e(()=>{var e,t;return(null==(t=null==(e=l.value)?void 0:e.data)?void 0:t.filter(e=>new Date(e.date)>new Date).sort((e,t)=>new Date(e.date)-new Date(t.date)))||[]}),d=e(()=>{var e,t;return(null==(t=null==(e=l.value)?void 0:e.data)?void 0:t.filter(e=>e.is_featured))||[]});return{events:l,activeEvents:o,upcomingEvents:c,featuredEvents:d,error:i,loading:s,execute:r,refresh:n}}({limit:4,sort_by:"created_at",sort_order:"desc"}),{videos:p,error:g,loading:f}=function(t={},a={}){const{data:l,error:i,loading:s,execute:r,refresh:n}=b("/dinor-tv",t,{cacheTTL:6e5,...a}),o=e(()=>{var e,t;return(null==(t=null==(e=l.value)?void 0:e.data)?void 0:t.filter(e=>e.is_featured))||[]}),c=e(()=>{var e,t;return(null==(t=null==(e=l.value)?void 0:e.data)?void 0:t.sort((e,t)=>new Date(t.created_at)-new Date(e.created_at)))||[]}),d=e(()=>{var e;const t={};return(null==(e=l.value)?void 0:e.data)&&l.value.data.forEach(e=>{var a;const l=(null==(a=e.category)?void 0:a.name)||"Autres";t[l]||(t[l]=[]),t[l].push(e)}),t});return{videos:l,featuredVideos:o,latestVideos:c,videosByCategory:d,error:i,loading:s,execute:r,refresh:n}}({limit:4,sort_by:"created_at",sort_order:"desc"}),h=e(()=>{var e,t;return(null==(t=null==(e=s.value)?void 0:e.data)?void 0:t.slice(0,4))||[]}),_=e(()=>{var e,t;return(null==(t=null==(e=o.value)?void 0:e.data)?void 0:t.slice(0,4))||[]}),D=e(()=>{var e,t;return(null==(t=null==(e=u.value)?void 0:e.data)?void 0:t.slice(0,4))||[]}),C=e(()=>{var e,t;return(null==(t=null==(e=p.value)?void 0:e.data)?void 0:t.slice(0,4))||[]}),T=e(()=>{var e,t,a,l,i,r,n,c;return{recipes:(null==(t=null==(e=s.value)?void 0:e.meta)?void 0:t.total)||h.value.length,tips:(null==(l=null==(a=o.value)?void 0:a.meta)?void 0:l.total)||_.value.length,events:(null==(r=null==(i=u.value)?void 0:i.meta)?void 0:r.total)||D.value.length,videos:(null==(c=null==(n=p.value)?void 0:n.meta)?void 0:c.total)||C.value.length}});return{banners:a,loadingBanners:l,errorBanners:i,latestRecipes:h,latestTips:_,latestEvents:D,latestVideos:C,stats:T,loadingRecipes:n,loadingTips:d,loadingEvents:m,loadingVideos:f,errorRecipes:r,errorTips:c,errorEvents:v,errorVideos:g,handleRecipeClick:e=>{t.push(`/recipe/${e.id}`)},handleTipClick:e=>{t.push(`/tip/${e.id}`)},handleEventClick:e=>{t.push(`/event/${e.id}`)},handleVideoClick:e=>{t.push(`/video/${e.id}`)},getShortDescription:e=>{if(!e)return"";const t=e.replace(/<[^>]*>/g,"");return t.length>80?t.substring(0,80)+"...":t},getDifficultyLabel:e=>({beginner:"Débutant",intermediate:"Intermédiaire",advanced:"Avancé",easy:"Facile",medium:"Moyen",hard:"Difficile"}[e]||e),getTotalTime:e=>(e.preparation_time||0)+(e.cooking_time||0)+(e.resting_time||0),getStatusClass:e=>`status-${e}`,getStatusLabel:e=>({active:"Actif",upcoming:"À venir",completed:"Terminé",cancelled:"Annulé"}[e]||e),formatDate:e=>e?new Date(e).toLocaleDateString("fr-FR",{day:"numeric",month:"short"}):"",getVideoThumbnail:e=>{if(!e)return"/images/default-video.jpg";const t=e.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\n?#]+)/);return t?`https://img.youtube.com/vi/${t[1]}/maxresdefault.jpg`:"/images/default-video.jpg"},formatDuration:e=>{if(!e)return"";return`${Math.floor(e/60)}:${(e%60).toString().padStart(2,"0")}`},getContrastColor:e=>(.299*parseInt(e.slice(1,3),16)+.587*parseInt(e.slice(3,5),16)+.114*parseInt(e.slice(5,7),16))/255>.5?"#000000":"#FFFFFF"}}},[["render",function(e,t,a,l,i,m){const p=u("BannerSection"),f=u("ContentCarousel");return h(),s("div",Q,[r("div",U,[n(p,{type:"home",section:"hero",banners:l.banners},null,8,["banners"]),n(f,{title:"Dernières Recettes",items:l.latestRecipes,loading:l.loadingRecipes,error:l.errorRecipes,"content-type":"recipes","view-all-link":"/recipes",onItemClick:l.handleRecipeClick},{item:c(({item:e})=>[r("div",X,[r("div",Y,[r("img",{src:e.featured_image_url||"/images/default-recipe.jpg",alt:e.title,loading:"lazy"},null,8,Z),r("div",ee,[l.getTotalTime(e)?(h(),s("span",te,o(l.getTotalTime(e))+"min ",1)):v("",!0),e.difficulty?(h(),s("span",ae,o(l.getDifficultyLabel(e.difficulty)),1)):v("",!0)])]),r("div",le,[r("h3",null,o(e.title),1),r("p",null,o(l.getShortDescription(e.short_description)),1),r("div",ie,[r("span",se,[t[0]||(t[0]=r("span",{class:"material-symbols-outlined"},"favorite",-1)),t[1]||(t[1]=r("span",{class:"emoji-fallback"},"❤️",-1)),d(" "+o(e.likes_count||0),1)]),r("span",re,o(l.formatDate(e.created_at)),1)])])])]),_:1},8,["items","loading","error","onItemClick"]),n(f,{title:"Dernières Astuces",items:l.latestTips,loading:l.loadingTips,error:l.errorTips,"content-type":"tips","view-all-link":"/tips",onItemClick:l.handleTipClick},{item:c(({item:e})=>[r("div",ne,[t[2]||(t[2]=r("div",{class:"tip-icon"},[r("span",{class:"material-symbols-outlined"},"lightbulb"),r("span",{class:"emoji-fallback"},"💡")],-1)),r("div",oe,[r("h3",null,o(e.title),1),r("p",null,o(l.getShortDescription(e.content)),1),r("div",ce,[e.estimated_time?(h(),s("span",de,o(e.estimated_time)+"min ",1)):v("",!0),r("span",ue,o(l.getDifficultyLabel(e.difficulty_level)),1),r("span",ve,o(l.formatDate(e.created_at)),1)])])])]),_:1},8,["items","loading","error","onItemClick"]),n(f,{title:"Derniers Événements",items:l.latestEvents,loading:l.loadingEvents,error:l.errorEvents,"content-type":"events","view-all-link":"/events",onItemClick:l.handleEventClick},{item:c(({item:e})=>[r("div",me,[r("div",pe,[r("img",{src:e.featured_image_url||"/images/default-event.jpg",alt:e.title,loading:"lazy"},null,8,ge),r("div",fe,[r("span",{class:g([l.getStatusClass(e.status),"status-badge"])},o(l.getStatusLabel(e.status)),3)])]),r("div",ye,[r("h3",null,o(e.title),1),r("p",null,o(l.getShortDescription(e.short_description)),1),r("div",he,[r("span",be,[t[3]||(t[3]=r("span",{class:"material-symbols-outlined"},"calendar_today",-1)),t[4]||(t[4]=r("span",{class:"emoji-fallback"},"📅",-1)),d(" "+o(l.formatDate(e.start_date)),1)]),r("span",_e,o(l.formatDate(e.created_at)),1)])])])]),_:1},8,["items","loading","error","onItemClick"]),n(f,{title:"Dernières Vidéos Dinor TV",items:l.latestVideos,loading:l.loadingVideos,error:l.errorVideos,"content-type":"videos","view-all-link":"/dinor-tv",onItemClick:l.handleVideoClick,class:"dinor-tv-section"},{item:c(({item:e})=>[r("div",ke,[r("div",De,[r("img",{src:e.thumbnail_url||l.getVideoThumbnail(e.video_url),alt:e.title,loading:"lazy"},null,8,Ce),r("div",Te,[t[6]||(t[6]=r("div",{class:"play-button"},[r("span",{class:"material-symbols-outlined"},"play_circle"),r("span",{class:"emoji-fallback"},"▶️")],-1)),e.is_live?(h(),s("div",Se,t[5]||(t[5]=[r("span",{class:"live-dot"},null,-1),d(" LIVE ")]))):v("",!0),e.duration?(h(),s("div",Ie,o(l.formatDuration(e.duration)),1)):v("",!0)])]),r("div",we,[r("h3",null,o(e.title),1),r("p",null,o(l.getShortDescription(e.description)),1),r("div",je,[r("span",Le,[t[7]||(t[7]=r("span",{class:"material-symbols-outlined"},"visibility",-1)),t[8]||(t[8]=r("span",{class:"emoji-fallback"},"👁️",-1)),d(" "+o(e.views_count||0),1)]),r("span",Ee,o(l.formatDate(e.created_at)),1)])])])]),_:1},8,["items","loading","error","onItemClick"])])])}],["__scopeId","data-v-fcd57070"]]);export{Ve as default};
