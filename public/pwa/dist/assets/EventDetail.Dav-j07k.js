import{e,f as t,t as a,n as s,m as n,y as i,A as o,B as r,F as l,g as c,r as d,o as m,u as v,h as u,j as p}from"./vendor.CNJ67EhX.js";import{_ as y,c as g}from"./main.a-2UG2Uh.js";const k={class:"event-detail"},h={class:"md3-top-app-bar"},b={class:"md3-app-bar-container"},f={class:"md3-app-bar-title"},_={class:"md3-title-large dinor-text-primary"},x={class:"md3-app-bar-actions"},w={class:"material-icons"},C={class:"md3-main-content"},E={key:0,class:"loading-container"},D={key:1,class:"event-content"},L={key:0,class:"event-hero"},j=["src","alt"],A={class:"event-overlay dinor-gradient-primary"},B={class:"event-badges"},H={key:0,class:"md3-chip event-location"},I={key:1,class:"md3-chip event-category"},$={class:"event-info"},S={class:"event-stats"},q={class:"stat-item"},F={class:"md3-body-medium"},R={key:0,class:"stat-item"},T={class:"md3-body-medium"},M={class:"stat-item"},P={class:"md3-body-medium"},U={class:"stat-item"},z={class:"md3-body-medium"},V={class:"event-details"},G={class:"detail-item"},J={class:"md3-body-medium"},K={key:0},N={key:1},O={key:0},Q={key:0,class:"detail-item"},W={class:"md3-body-medium"},X={key:0,class:"event-description"},Y=["innerHTML"],Z={key:1,class:"event-registration"},ee={key:0,class:"registration-info"},te={class:"md3-body-small dinor-text-gray"},ae={class:"comments-section"},se={class:"md3-title-medium dinor-text-primary"},ne={class:"add-comment-form"},ie=["disabled"],oe={key:0,class:"comments-list"},re={class:"comment-header"},le={class:"comment-author md3-body-medium"},ce={class:"comment-date md3-body-small dinor-text-gray"},de={class:"comment-content md3-body-medium"},me={key:1,class:"empty-comments"},ve={key:2,class:"error-state"},ue={class:"error-actions"};const pe=y({name:"EventDetail",props:{id:{type:String,required:!0}},setup(e){const t=v();u();const a=g(),s=d(null),n=d([]),i=d(!0),o=d(!1),r=d(""),l=async()=>{try{const t=await a.get("/comments",{type:"event",id:e.id});t.success&&(n.value=t.data)}catch(t){console.error("Erreur lors du chargement des commentaires:",t)}},c=async()=>{try{const t=await a.get("/likes/check",{type:"event",id:e.id});o.value=t.success&&t.data.liked}catch(t){console.error("Erreur lors de la vérification du like:",t)}};return m(()=>{(async()=>{try{const t=await a.get(`/events/${e.id}`);t.success&&(s.value=t.data,await l(),await c())}catch(t){console.error("Erreur lors du chargement de l'événement:",t)}finally{i.value=!1}})()}),{event:s,comments:n,loading:i,userLiked:o,newComment:r,toggleLike:async()=>{try{const t=await a.post("/likes/toggle",{likeable_type:"event",likeable_id:e.id});t.success&&(o.value=!o.value,s.value&&(s.value.likes_count=t.data.total_likes))}catch(t){console.error("Erreur lors du toggle like:",t)}},addComment:async()=>{if(r.value.trim())try{(await a.post("/comments",{type:"event",id:e.id,content:r.value,author_name:"Utilisateur"})).success&&(await l(),r.value="")}catch(t){console.error("Erreur lors de l'ajout du commentaire:",t)}},shareEvent:()=>{navigator.share&&s.value?navigator.share({title:s.value.title,text:s.value.content,url:window.location.href}):(navigator.clipboard.writeText(window.location.href),alert("Lien copié dans le presse-papiers!"))},goBack:()=>{t.push("/events")},goHome:()=>{t.push("/")},formatEventDate:e=>new Date(e).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),formatDate:e=>new Date(e).toLocaleDateString("fr-FR"),handleImageError:e=>{e.target.src="/images/default-recipe.jpg"},formatContent:e=>e?"string"==typeof e?e:Array.isArray(e)?e.map((e,t)=>"object"==typeof e&&e.step?`<div class="content-step">\n              <h4>Étape ${t+1}</h4>\n              <p>${e.step}</p>\n            </div>`:"string"==typeof e?`<div class="content-step">\n              <p>${e}</p>\n            </div>`:`<div class="content-step"><p>${e}</p></div>`).join(""):e.toString():""}}},[["render",function(d,m,v,u,y,g){var pe;return p(),e("div",k,[t("nav",h,[t("div",b,[t("button",{onClick:m[0]||(m[0]=(...e)=>u.goBack&&u.goBack(...e)),class:"md3-icon-button"},m[8]||(m[8]=[t("i",{class:"material-icons"},"arrow_back",-1)])),t("div",f,[t("h1",_,a((null==(pe=u.event)?void 0:pe.title)||"Événement"),1)]),t("div",x,[t("button",{onClick:m[1]||(m[1]=(...e)=>u.toggleLike&&u.toggleLike(...e)),class:s(["md3-icon-button",{liked:u.userLiked}])},[t("i",w,a(u.userLiked?"favorite":"favorite_border"),1)],2),t("button",{onClick:m[2]||(m[2]=(...e)=>u.shareEvent&&u.shareEvent(...e)),class:"md3-icon-button"},m[9]||(m[9]=[t("i",{class:"material-icons"},"share",-1)]))])])]),t("main",C,[u.loading?(p(),e("div",E,m[10]||(m[10]=[t("div",{class:"md3-circular-progress"},null,-1),t("p",{class:"md3-body-large"},"Chargement de l'événement...",-1)]))):u.event?(p(),e("div",D,[u.event.image?(p(),e("div",L,[t("img",{src:u.event.image||"/images/default-recipe.jpg",alt:u.event.title,class:"event-hero-image",onError:m[3]||(m[3]=(...e)=>u.handleImageError&&u.handleImageError(...e))},null,40,j),t("div",A,[t("div",B,[u.event.location?(p(),e("div",H,[m[11]||(m[11]=t("i",{class:"material-icons"},"location_on",-1)),t("span",null,a(u.event.location),1)])):n("",!0),u.event.category?(p(),e("div",I,[m[12]||(m[12]=t("i",{class:"material-icons"},"tag",-1)),t("span",null,a(u.event.category.name),1)])):n("",!0)])])])):n("",!0),t("div",$,[t("div",S,[t("div",q,[m[13]||(m[13]=t("i",{class:"material-icons dinor-text-secondary"},"event",-1)),t("span",F,a(u.formatEventDate(u.event.start_date)),1)]),u.event.start_time?(p(),e("div",R,[m[14]||(m[14]=t("i",{class:"material-icons dinor-text-secondary"},"schedule",-1)),t("span",T,a(u.event.start_time),1)])):n("",!0),t("div",M,[m[15]||(m[15]=t("i",{class:"material-icons dinor-text-secondary"},"favorite",-1)),t("span",P,a(u.event.likes_count||0),1)]),t("div",U,[m[16]||(m[16]=t("i",{class:"material-icons dinor-text-secondary"},"comment",-1)),t("span",z,a(u.event.comments_count||0),1)])]),t("div",V,[t("div",G,[m[17]||(m[17]=t("h3",{class:"md3-title-small dinor-text-primary"},"Date et Heure",-1)),t("p",J,[i(a(u.formatEventDate(u.event.start_date))+" ",1),u.event.start_time?(p(),e("span",K," à "+a(u.event.start_time),1)):n("",!0),u.event.end_date&&u.event.end_date!==u.event.start_date?(p(),e("span",N,[i(" - "+a(u.formatEventDate(u.event.end_date))+" ",1),u.event.end_time?(p(),e("span",O," à "+a(u.event.end_time),1)):n("",!0)])):n("",!0)])]),u.event.location?(p(),e("div",Q,[m[18]||(m[18]=t("h3",{class:"md3-title-small dinor-text-primary"},"Lieu",-1)),t("p",W,a(u.event.location),1)])):n("",!0)]),u.event.content?(p(),e("div",X,[m[19]||(m[19]=t("h2",{class:"md3-title-medium dinor-text-primary"},"Description",-1)),t("div",{class:"md3-body-large dinor-text-gray",innerHTML:u.formatContent(u.event.content)},null,8,Y)])):n("",!0),u.event.registration_required?(p(),e("div",Z,[m[20]||(m[20]=t("h3",{class:"md3-title-small dinor-text-primary"},"Inscription",-1)),m[21]||(m[21]=t("p",{class:"md3-body-medium"},[t("i",{class:"material-icons dinor-text-secondary"},"info"),i(" Inscription requise pour cet événement ")],-1)),u.event.max_attendees?(p(),e("div",ee,[t("p",te," Places limitées: "+a(u.event.max_attendees)+" personnes maximum ",1)])):n("",!0)])):n("",!0),t("div",ae,[t("h2",se,"Commentaires ("+a(u.comments.length)+")",1),t("div",ne,[o(t("textarea",{"onUpdate:modelValue":m[4]||(m[4]=e=>u.newComment=e),placeholder:"Ajoutez votre commentaire...",class:"md3-textarea",rows:"3"},"              ",512),[[r,u.newComment]]),t("button",{onClick:m[5]||(m[5]=(...e)=>u.addComment&&u.addComment(...e)),class:"btn-primary",disabled:!u.newComment.trim()}," Publier ",8,ie)]),u.comments.length?(p(),e("div",oe,[(p(!0),e(l,null,c(u.comments,s=>(p(),e("div",{key:s.id,class:"comment-item"},[t("div",re,[t("span",le,a(s.author_name),1),t("span",ce,a(u.formatDate(s.created_at)),1)]),t("p",de,a(s.content),1)]))),128))])):(p(),e("div",me,m[22]||(m[22]=[t("p",{class:"md3-body-medium dinor-text-gray"},"Aucun commentaire pour le moment.",-1)])))])])])):(p(),e("div",ve,[m[23]||(m[23]=t("div",{class:"error-icon"},[t("i",{class:"material-icons"},"error_outline")],-1)),m[24]||(m[24]=t("h2",{class:"md3-title-large"},"Événement introuvable",-1)),m[25]||(m[25]=t("p",{class:"md3-body-large dinor-text-gray"},"L'événement demandé n'existe pas ou a été supprimé.",-1)),t("div",ue,[t("button",{onClick:m[6]||(m[6]=(...e)=>u.goBack&&u.goBack(...e)),class:"btn-secondary"},"Retour aux événements"),t("button",{onClick:m[7]||(m[7]=(...e)=>u.goHome&&u.goHome(...e)),class:"btn-primary"},"Accueil")])]))])])}],["__scopeId","data-v-b00d9b94"]]);export{pe as default};
