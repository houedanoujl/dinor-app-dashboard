import{g as e,h as t,i as a,q as s,j as l,s as i,b as n,d as r,l as o,t as c,w as u,e as d,k as v,F as p,r as m,n as f,v as g,x as h,o as y,y as b}from"./vendor.2V9jEnd_.js";import{_}from"./main.DEpiNenS.js";const k=e("cache",()=>{const e=t(new Map),a=t(new Map),s=t(3e5);function l(t){const s=a.value.get(t);return!s||Date.now()>s?(e.value.delete(t),a.value.delete(t),null):e.value.get(t)}function i(){const t=Date.now();for(const[s,l]of a.value.entries())t>l&&(e.value.delete(s),a.value.delete(s))}return setInterval(i,3e4),{defaultTTL:s,set:function(t,l,i=s.value){e.value.set(t,l),a.value.set(t,Date.now()+i)},get:l,has:function(e){return null!==l(e)},remove:function(t){e.value.delete(t),a.value.delete(t)},clear:function(){e.value.clear(),a.value.clear()},clearExpired:i,getCacheInfo:function(){return{size:e.value.size,keys:Array.from(e.value.keys()),expired:Array.from(a.value.entries()).filter(([,e])=>Date.now()>e).map(([e])=>e)}}}}),w=e("api",()=>{const e=t(new Set),a=t(new Map),s=t(`${window.location.origin}/api/v1`),l=k();function i(t,a){a?e.value.add(t):e.value.delete(t)}function n(e,t){t?a.value.set(e,t):a.value.delete(e)}async function r(e,t={}){const a=`${e}_${JSON.stringify(t)}`;if(!t.method||"GET"===t.method){const a=await async function(e,t={}){try{const a=o(e);if(!a)return null;const s=c(t),l=await fetch("/api/pwa/cache/get",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({type:a,params:s})});if(l.ok){const e=await l.json();if(e.success)return e.data}}catch(a){console.warn("Erreur cache PWA get:",a)}return null}(e,t);if(a)return a}i(a,!0),n(a,null);try{const a=`${s.value}${e}`,l={headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest",...t.headers},...t},i=await fetch(a,l);if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const n=await i.json();return t.method&&"GET"!==t.method||await async function(e,t,a={}){try{const s=o(e);if(!s)return;const l=c(a);await fetch("/api/pwa/cache/set",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({type:s,data:t,params:l})})}catch(s){console.warn("Erreur cache PWA set:",s)}}(e,n,t),n}catch(l){throw n(a,l.message),l}finally{i(a,!1)}}function o(e){return e.includes("/recipes")?"recipes":e.includes("/tips")?"tips":e.includes("/events")?"events":e.includes("/dinor-tv")?"videos":e.includes("/categories")?"categories":null}function c(e){const t=new URL(`http://example.com${e.url||""}`),a={};for(const[s,l]of t.searchParams)a[s]=l;return a}async function u(e,t={},a={}){const s=new URLSearchParams(t).toString();return r(s?`${e}?${s}`:e,{...a,method:"GET"})}return{loading:e,errors:a,baseURL:s,isLoading:function(t){return e.value.has(t)},getError:function(e){return a.value.get(e)},setLoading:i,setError:n,clearError:function(e){a.value.delete(e)},request:r,get:u,post:async function(e,t,a={}){return r(e,{...a,method:"POST",body:JSON.stringify(t)})},put:async function(e,t,a={}){return r(e,{...a,method:"PUT",body:JSON.stringify(t)})},del:async function(e,t={}){return r(e,{...t,method:"DELETE"})},invalidateCache:function(e){l.getCacheInfo().keys.filter(t=>t.includes(e)||new RegExp(e).test(t)).forEach(e=>l.remove(e))},preload:async function(e){const t=e.map(({endpoint:e,params:t,options:a})=>u(e,t,{...a,priority:"low"}).catch(()=>null));return Promise.allSettled(t)}}});function C(e,l={},i={}){const n=w(),r=t(null),o=t(null),c=t(!1),u=a(()=>`${e}_${JSON.stringify(l.value||l)}`),d=async(t=null,a={})=>{const s=t||l.value||l,u={...i,...a};c.value=!0,o.value=null;try{const t=await n.get(e,s,u);return r.value=t,t}catch(d){throw o.value=d.message,d}finally{c.value=!1}};return!1!==i.autoFetch&&d(),!1!==i.watchParams&&"object"==typeof l&&void 0!==l.value&&s(l,()=>d(),{deep:!0}),{data:r,error:o,loading:c,execute:d,refresh:()=>(n.invalidateCache(u.value),d())}}const D={name:"ContentCarousel",props:{title:{type:String,required:!0},items:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},error:{type:String,default:null},contentType:{type:String,required:!0,validator:e=>["recipes","tips","events","videos"].includes(e)},viewAllLink:{type:String,required:!0},showControls:{type:Boolean,default:!0},showIndicators:{type:Boolean,default:!1},itemsPerView:{type:Number,default:4}},emits:["item-click"],setup(e,{emit:a}){const s=h(),n=t(null),r=t(0),o=t(!1),c=t(!0),u=()=>{const e=n.value;e&&(o.value=e.scrollLeft>0,c.value=e.scrollLeft<e.scrollWidth-e.clientWidth)},d=()=>({recipes:"/images/default-recipe.jpg",tips:"/images/default-tip.jpg",events:"/images/default-event.jpg",videos:"/images/default-video.jpg"}[e.contentType]||"/images/default.jpg");return l(()=>{const e=n.value;e&&(e.addEventListener("scroll",u),u())}),i(()=>{const e=n.value;e&&e.removeEventListener("scroll",u)}),{carouselRef:n,currentIndex:r,canScrollLeft:o,canScrollRight:c,scrollCarousel:e=>{var t;const a=n.value;if(!a)return;const s=2*(((null==(t=a.querySelector(".carousel-item"))?void 0:t.offsetWidth)||280)+16);a.scrollBy({left:e*s,behavior:"smooth"}),setTimeout(u,300)},scrollToIndex:e=>{var t;const a=n.value;if(!a)return;const s=e*(((null==(t=a.querySelector(".carousel-item"))?void 0:t.offsetWidth)||280)+16);a.scrollTo({left:s,behavior:"smooth"}),r.value=e},handleItemClick:t=>{a("item-click",t);const l={recipes:`/recipe/${t.id}`,tips:`/tip/${t.id}`,events:`/event/${t.id}`,videos:`/video/${t.id}`}[e.contentType];l&&s.push(l)},handleImageError:e=>{e.target.src=d()},getShortDescription:e=>{if(!e)return"";const t=e.replace(/<[^>]*>/g,"");return t.length>80?t.substring(0,80)+"...":t},getDefaultImage:d,getTypeIcon:()=>({recipes:"restaurant",tips:"lightbulb",events:"event",videos:"play_circle"}[e.contentType]||"info"),getItemClass:()=>`${e.contentType}-card`,getStatusClass:e=>`status-${e}`,getStatusLabel:e=>({active:"Actif",upcoming:"À venir",completed:"Terminé",cancelled:"Annulé",draft:"Brouillon",published:"Publié"}[e]||e),getDifficultyLabel:e=>({beginner:"Débutant",intermediate:"Intermédiaire",advanced:"Avancé"}[e]||e),formatDate:e=>e?new Date(e).toLocaleDateString("fr-FR",{day:"numeric",month:"short"}):""}}},T={class:"content-carousel"},S={class:"section-header"},E={class:"carousel-container"},I={key:0,class:"carousel-loading"},L={key:1,class:"carousel-error"},$={key:2,class:"carousel-empty"},R={key:3,class:"carousel-wrapper"},j=["onClick"],x={class:"default-card"},A={key:0,class:"card-image"},V=["src","alt"],P={class:"card-overlay"},q={key:0,class:"time-badge"},O={key:1,class:"card-icon"},B={class:"material-symbols-outlined"},z={class:"card-content"},N={class:"card-meta"},W={key:0,class:"likes"},J={key:1,class:"date"},M={key:2,class:"difficulty"},F={key:0,class:"carousel-controls"},U=["disabled"],G=["disabled"],H={key:1,class:"carousel-indicators"},X=["onClick"];const K={class:"home"},Q={class:"hero"},Y={class:"hero-content"},Z={class:"hero-stats"},ee={class:"stat"},te={class:"stat-number"},ae={class:"stat"},se={class:"stat-number"},le={class:"stat"},ie={class:"stat-number"},ne={class:"stat"},re={class:"stat-number"},oe={class:"recipe-card"},ce={class:"card-image"},ue=["src","alt"],de={class:"card-overlay"},ve={key:0,class:"time-badge"},pe={key:1,class:"difficulty-badge"},me={class:"card-content"},fe={class:"card-meta"},ge={class:"likes"},he={class:"date"},ye={class:"tip-card"},be={class:"card-content"},_e={class:"card-meta"},ke={key:0,class:"time"},we={class:"difficulty"},Ce={class:"date"},De={class:"event-card"},Te={class:"card-image"},Se=["src","alt"],Ee={class:"card-overlay"},Ie={class:"card-content"},Le={class:"card-meta"},$e={class:"date"},Re={class:"created"},je={class:"video-card"},xe={class:"video-thumbnail"},Ae=["src","alt"],Ve={class:"video-overlay"},Pe={key:0,class:"live-badge"},qe={key:1,class:"duration-badge"},Oe={class:"card-content"},Be={class:"card-meta"},ze={class:"views"},Ne={class:"date"};const We=_({name:"Home",components:{ContentCarousel:_(D,[["render",function(e,t,a,s,l,i){const h=d("router-link");return y(),n("section",T,[r("div",S,[r("h2",null,c(a.title),1),o(h,{to:a.viewAllLink,class:"see-all-btn"},{default:u(()=>t[3]||(t[3]=[b(" Voir tout "),r("span",{class:"material-symbols-outlined"},"arrow_forward",-1)])),_:1,__:[3]},8,["to"])]),r("div",E,[a.loading?(y(),n("div",I,t[4]||(t[4]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"Chargement...",-1)]))):a.error?(y(),n("div",L,t[5]||(t[5]=[r("span",{class:"material-symbols-outlined"},"error",-1),r("p",null,"Erreur lors du chargement",-1)]))):0===a.items.length?(y(),n("div",$,t[6]||(t[6]=[r("span",{class:"material-symbols-outlined"},"info",-1),r("p",null,"Aucun contenu disponible",-1)]))):(y(),n("div",R,[r("div",{class:"carousel",ref:s.carouselRef},[(y(!0),n(p,null,m(a.items,a=>(y(),n("div",{key:a.id,onClick:e=>s.handleItemClick(a),class:f(["carousel-item",s.getItemClass()])},[g(e.$slots,"item",{item:a,getShortDescription:s.getShortDescription},()=>[r("div",x,[a.featured_image_url||a.image_url?(y(),n("div",A,[r("img",{src:a.featured_image_url||a.image_url||s.getDefaultImage(),alt:a.title,loading:"lazy",onError:t[0]||(t[0]=(...e)=>s.handleImageError&&s.handleImageError(...e))},null,40,V),r("div",P,[a.preparation_time||a.estimated_time?(y(),n("span",q,c(a.preparation_time||a.estimated_time)+"min ",1)):v("",!0),a.status?(y(),n("span",{key:1,class:f([s.getStatusClass(a.status),"status-badge"])},c(s.getStatusLabel(a.status)),3)):v("",!0)])])):(y(),n("div",O,[r("span",B,c(s.getTypeIcon()),1)])),r("div",z,[r("h3",null,c(a.title),1),r("p",null,c(s.getShortDescription(a.short_description||a.content||a.description)),1),r("div",N,[a.likes_count?(y(),n("span",W,[t[7]||(t[7]=r("span",{class:"material-symbols-outlined"},"favorite",-1)),b(" "+c(a.likes_count),1)])):v("",!0),a.created_at?(y(),n("span",J,c(s.formatDate(a.created_at)),1)):v("",!0),a.difficulty_level?(y(),n("span",M,c(s.getDifficultyLabel(a.difficulty_level)),1)):v("",!0)])])])])],10,j))),128))],512),a.showControls&&a.items.length>1?(y(),n("div",F,[r("button",{onClick:t[1]||(t[1]=e=>s.scrollCarousel(-1)),class:"carousel-btn prev",disabled:!s.canScrollLeft},t[8]||(t[8]=[r("span",{class:"material-symbols-outlined"},"chevron_left",-1)]),8,U),r("button",{onClick:t[2]||(t[2]=e=>s.scrollCarousel(1)),class:"carousel-btn next",disabled:!s.canScrollRight},t[9]||(t[9]=[r("span",{class:"material-symbols-outlined"},"chevron_right",-1)]),8,G)])):v("",!0),a.showIndicators&&a.items.length>1?(y(),n("div",H,[(y(!0),n(p,null,m(a.items,(e,t)=>(y(),n("button",{key:t,onClick:e=>s.scrollToIndex(t),class:f(["indicator",{active:s.currentIndex===t}])},null,10,X))),128))])):v("",!0)]))])])}],["__scopeId","data-v-c6e844dc"]])},setup(){const e=h(),{recipes:t,error:s,loading:l}=function(e={},t={}){const{data:s,error:l,loading:i,execute:n,refresh:r}=C("/recipes",e,{cacheTTL:3e5,...t}),o=a(()=>{var e,t;return(null==(t=null==(e=s.value)?void 0:e.data)?void 0:t.filter(e=>e.is_featured))||[]}),c=a(()=>{var e,t;return(null==(t=null==(e=s.value)?void 0:e.data)?void 0:t.sort((e,t)=>(t.likes_count||0)-(e.likes_count||0)))||[]});return{recipes:s,featuredRecipes:o,popularRecipes:c,error:l,loading:i,execute:n,refresh:r}}({limit:4,sort_by:"created_at",sort_order:"desc"}),{tips:i,error:n,loading:r}=function(e={},t={}){const{data:s,error:l,loading:i,execute:n,refresh:r}=C("/tips",e,{cacheTTL:3e5,...t}),o=a(()=>{var e,t;return(null==(t=null==(e=s.value)?void 0:e.data)?void 0:t.filter(e=>e.is_featured))||[]}),c=a(()=>{var e;const t={};return(null==(e=s.value)?void 0:e.data)&&s.value.data.forEach(e=>{const a=e.difficulty_level||"beginner";t[a]||(t[a]=[]),t[a].push(e)}),t});return{tips:s,featuredTips:o,tipsByDifficulty:c,error:l,loading:i,execute:n,refresh:r}}({limit:4,sort_by:"created_at",sort_order:"desc"}),{events:o,error:c,loading:u}=function(e={},t={}){const{data:s,error:l,loading:i,execute:n,refresh:r}=C("/events",e,{cacheTTL:3e5,...t}),o=a(()=>{var e,t;return(null==(t=null==(e=s.value)?void 0:e.data)?void 0:t.filter(e=>"active"===e.status))||[]}),c=a(()=>{var e,t;return(null==(t=null==(e=s.value)?void 0:e.data)?void 0:t.filter(e=>new Date(e.date)>new Date).sort((e,t)=>new Date(e.date)-new Date(t.date)))||[]}),u=a(()=>{var e,t;return(null==(t=null==(e=s.value)?void 0:e.data)?void 0:t.filter(e=>e.is_featured))||[]});return{events:s,activeEvents:o,upcomingEvents:c,featuredEvents:u,error:l,loading:i,execute:n,refresh:r}}({limit:4,sort_by:"created_at",sort_order:"desc"}),{videos:d,error:v,loading:p}=function(e={},t={}){const{data:s,error:l,loading:i,execute:n,refresh:r}=C("/dinor-tv",e,{cacheTTL:6e5,...t}),o=a(()=>{var e,t;return(null==(t=null==(e=s.value)?void 0:e.data)?void 0:t.filter(e=>e.is_featured))||[]}),c=a(()=>{var e,t;return(null==(t=null==(e=s.value)?void 0:e.data)?void 0:t.sort((e,t)=>new Date(t.created_at)-new Date(e.created_at)))||[]}),u=a(()=>{var e;const t={};return(null==(e=s.value)?void 0:e.data)&&s.value.data.forEach(e=>{var a;const s=(null==(a=e.category)?void 0:a.name)||"Autres";t[s]||(t[s]=[]),t[s].push(e)}),t});return{videos:s,featuredVideos:o,latestVideos:c,videosByCategory:u,error:l,loading:i,execute:n,refresh:r}}({limit:4,sort_by:"created_at",sort_order:"desc"}),m=a(()=>{var e,a;return(null==(a=null==(e=t.value)?void 0:e.data)?void 0:a.slice(0,4))||[]}),f=a(()=>{var e,t;return(null==(t=null==(e=i.value)?void 0:e.data)?void 0:t.slice(0,4))||[]}),g=a(()=>{var e,t;return(null==(t=null==(e=o.value)?void 0:e.data)?void 0:t.slice(0,4))||[]}),y=a(()=>{var e,t;return(null==(t=null==(e=d.value)?void 0:e.data)?void 0:t.slice(0,4))||[]}),b=a(()=>{var e,a,s,l,n,r,c,u;return{recipes:(null==(a=null==(e=t.value)?void 0:e.meta)?void 0:a.total)||m.value.length,tips:(null==(l=null==(s=i.value)?void 0:s.meta)?void 0:l.total)||f.value.length,events:(null==(r=null==(n=o.value)?void 0:n.meta)?void 0:r.total)||g.value.length,videos:(null==(u=null==(c=d.value)?void 0:c.meta)?void 0:u.total)||y.value.length}});return{latestRecipes:m,latestTips:f,latestEvents:g,latestVideos:y,stats:b,loadingRecipes:l,loadingTips:r,loadingEvents:u,loadingVideos:p,errorRecipes:s,errorTips:n,errorEvents:c,errorVideos:v,handleRecipeClick:t=>{e.push(`/recipe/${t.id}`)},handleTipClick:t=>{e.push(`/tip/${t.id}`)},handleEventClick:t=>{e.push(`/event/${t.id}`)},handleVideoClick:t=>{e.push(`/video/${t.id}`)},getShortDescription:e=>{if(!e)return"";const t=e.replace(/<[^>]*>/g,"");return t.length>80?t.substring(0,80)+"...":t},getDifficultyLabel:e=>({beginner:"Débutant",intermediate:"Intermédiaire",advanced:"Avancé"}[e]||e),getStatusClass:e=>`status-${e}`,getStatusLabel:e=>({active:"Actif",upcoming:"À venir",completed:"Terminé",cancelled:"Annulé"}[e]||e),formatDate:e=>e?new Date(e).toLocaleDateString("fr-FR",{day:"numeric",month:"short"}):"",getVideoThumbnail:e=>{if(!e)return"/images/default-video.jpg";const t=e.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\n?#]+)/);return t?`https://img.youtube.com/vi/${t[1]}/maxresdefault.jpg`:"/images/default-video.jpg"},formatDuration:e=>{if(!e)return"";return`${Math.floor(e/60)}:${(e%60).toString().padStart(2,"0")}`}}}},[["render",function(e,t,a,s,l,i){const p=d("ContentCarousel");return y(),n("div",K,[r("section",Q,[r("div",Y,[t[4]||(t[4]=r("h1",null,"Bienvenue sur Dinor",-1)),t[5]||(t[5]=r("p",null,"Découvrez les saveurs authentiques de la Côte d'Ivoire",-1)),r("div",Z,[r("div",ee,[r("span",te,c(s.stats.recipes),1),t[0]||(t[0]=r("span",{class:"stat-label"},"Recettes",-1))]),r("div",ae,[r("span",se,c(s.stats.tips),1),t[1]||(t[1]=r("span",{class:"stat-label"},"Astuces",-1))]),r("div",le,[r("span",ie,c(s.stats.events),1),t[2]||(t[2]=r("span",{class:"stat-label"},"Événements",-1))]),r("div",ne,[r("span",re,c(s.stats.videos),1),t[3]||(t[3]=r("span",{class:"stat-label"},"Vidéos",-1))])])])]),o(p,{title:"Dernières Recettes",items:s.latestRecipes,loading:s.loadingRecipes,error:s.errorRecipes,"content-type":"recipes","view-all-link":"/recipes",onItemClick:s.handleRecipeClick},{item:u(({item:e})=>[r("div",oe,[r("div",ce,[r("img",{src:e.featured_image_url||"/images/default-recipe.jpg",alt:e.title,loading:"lazy"},null,8,ue),r("div",de,[e.preparation_time?(y(),n("span",ve,c(e.preparation_time)+"min ",1)):v("",!0),e.difficulty?(y(),n("span",pe,c(s.getDifficultyLabel(e.difficulty)),1)):v("",!0)])]),r("div",me,[r("h3",null,c(e.title),1),r("p",null,c(s.getShortDescription(e.short_description)),1),r("div",fe,[r("span",ge,[t[6]||(t[6]=r("span",{class:"material-symbols-outlined"},"favorite",-1)),b(" "+c(e.likes_count||0),1)]),r("span",he,c(s.formatDate(e.created_at)),1)])])])]),_:1},8,["items","loading","error","onItemClick"]),o(p,{title:"Dernières Astuces",items:s.latestTips,loading:s.loadingTips,error:s.errorTips,"content-type":"tips","view-all-link":"/tips",onItemClick:s.handleTipClick},{item:u(({item:e})=>[r("div",ye,[t[7]||(t[7]=r("div",{class:"tip-icon"},[r("span",{class:"material-symbols-outlined"},"lightbulb")],-1)),r("div",be,[r("h3",null,c(e.title),1),r("p",null,c(s.getShortDescription(e.content)),1),r("div",_e,[e.estimated_time?(y(),n("span",ke,c(e.estimated_time)+"min ",1)):v("",!0),r("span",we,c(s.getDifficultyLabel(e.difficulty_level)),1),r("span",Ce,c(s.formatDate(e.created_at)),1)])])])]),_:1},8,["items","loading","error","onItemClick"]),o(p,{title:"Derniers Événements",items:s.latestEvents,loading:s.loadingEvents,error:s.errorEvents,"content-type":"events","view-all-link":"/events",onItemClick:s.handleEventClick},{item:u(({item:e})=>[r("div",De,[r("div",Te,[r("img",{src:e.featured_image_url||"/images/default-event.jpg",alt:e.title,loading:"lazy"},null,8,Se),r("div",Ee,[r("span",{class:f([s.getStatusClass(e.status),"status-badge"])},c(s.getStatusLabel(e.status)),3)])]),r("div",Ie,[r("h3",null,c(e.title),1),r("p",null,c(s.getShortDescription(e.short_description)),1),r("div",Le,[r("span",$e,[t[8]||(t[8]=r("span",{class:"material-symbols-outlined"},"calendar_today",-1)),b(" "+c(s.formatDate(e.start_date)),1)]),r("span",Re,c(s.formatDate(e.created_at)),1)])])])]),_:1},8,["items","loading","error","onItemClick"]),o(p,{title:"Dernières Vidéos Dinor TV",items:s.latestVideos,loading:s.loadingVideos,error:s.errorVideos,"content-type":"videos","view-all-link":"/dinor-tv",onItemClick:s.handleVideoClick,class:"dinor-tv-section"},{item:u(({item:e})=>[r("div",je,[r("div",xe,[r("img",{src:e.thumbnail_url||s.getVideoThumbnail(e.video_url),alt:e.title,loading:"lazy"},null,8,Ae),r("div",Ve,[t[10]||(t[10]=r("div",{class:"play-button"},[r("span",{class:"material-symbols-outlined"},"play_circle")],-1)),e.is_live?(y(),n("div",Pe,t[9]||(t[9]=[r("span",{class:"live-dot"},null,-1),b(" LIVE ")]))):v("",!0),e.duration?(y(),n("div",qe,c(s.formatDuration(e.duration)),1)):v("",!0)])]),r("div",Oe,[r("h3",null,c(e.title),1),r("p",null,c(s.getShortDescription(e.description)),1),r("div",Be,[r("span",ze,[t[11]||(t[11]=r("span",{class:"material-symbols-outlined"},"visibility",-1)),b(" "+c(e.views_count||0),1)]),r("span",Ne,c(s.formatDate(e.created_at)),1)])])])]),_:1},8,["items","loading","error","onItemClick"])])}],["__scopeId","data-v-93f33136"]]);export{We as default};
