const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Home.GK8CziJe.js","assets/vendor.CNJ67EhX.js","assets/Home.Dk7MYAKo.css","assets/RecipesList.Drcailc1.js","assets/api.uSn_et4s.js","assets/RecipesList.B0LZZg4I.css","assets/RecipeDetail.C7BRLg_U.js","assets/RecipeDetail.DibD2M29.css","assets/TipsList.DhHGkYrh.js","assets/TipsList.zD83pog9.css","assets/TipDetail.C3zg5c48.js","assets/TipDetail.CGa2TJX6.css","assets/EventsList.CYVF6idF.js","assets/EventsList.C-0R72Ja.css","assets/EventDetail.Dav-j07k.js","assets/EventDetail.CbLqYfRW.css","assets/PagesList.CYjT1kd1.js","assets/PagesList.BPnmRK1j.css","assets/DinorTV.MJgCkLFh.js","assets/DinorTV.DRSHh94S.css","assets/WebEmbed.DqBg9_tY.js","assets/WebEmbed.Dy3729QS.css"])))=>i.map(i=>d[i]);
import{c as e,a as t,d as n,r as a,b as o,w as s,o as i,e as r,f as l,F as c,g as u,u as p,h as d,i as m,j as v,k as h,l as f,t as w,n as _,m as b,p as y,q as g,s as E}from"./vendor.CNJ67EhX.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const P={},I=function(e,t,n){let a=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),n=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));a=Promise.allSettled(t.map(e=>{if((e=function(e){return"/pwa/dist/"+e}(e))in P)return;P[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const o=document.createElement("link");return o.rel=t?"stylesheet":"modulepreload",t||(o.as="script"),o.crossOrigin="",o.href=e,n&&o.setAttribute("nonce",n),document.head.appendChild(o),t?new Promise((t,n)=>{o.addEventListener("load",t),o.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function o(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return a.then(t=>{for(const e of t||[])"rejected"===e.status&&o(e.reason);return e().catch(o)})},L=[{path:"/",name:"home",component:()=>I(()=>import("./Home.GK8CziJe.js"),__vite__mapDeps([0,1,2])),meta:{title:"Accueil"}},{path:"/home",redirect:"/"},{path:"/recipes",name:"recipes",component:()=>I(()=>import("./RecipesList.Drcailc1.js"),__vite__mapDeps([3,1,4,5])),meta:{title:"Recettes"}},{path:"/recipe/:id",name:"recipe-detail",component:()=>I(()=>import("./RecipeDetail.C7BRLg_U.js"),__vite__mapDeps([6,1,7])),meta:{title:"Détail Recette"},props:!0},{path:"/tips",name:"tips",component:()=>I(()=>import("./TipsList.DhHGkYrh.js"),__vite__mapDeps([8,1,4,9])),meta:{title:"Astuces"}},{path:"/tip/:id",name:"tip-detail",component:()=>I(()=>import("./TipDetail.C3zg5c48.js"),__vite__mapDeps([10,1,11])),meta:{title:"Détail Astuce"},props:!0},{path:"/events",name:"events",component:()=>I(()=>import("./EventsList.CYVF6idF.js"),__vite__mapDeps([12,1,4,13])),meta:{title:"Événements"}},{path:"/event/:id",name:"event-detail",component:()=>I(()=>import("./EventDetail.Dav-j07k.js"),__vite__mapDeps([14,1,15])),meta:{title:"Détail Événement"},props:!0},{path:"/pages",name:"pages",component:()=>I(()=>import("./PagesList.CYjT1kd1.js"),__vite__mapDeps([16,1,4,17])),meta:{title:"Pages"}},{path:"/dinor-tv",name:"dinor-tv",component:()=>I(()=>import("./DinorTV.MJgCkLFh.js"),__vite__mapDeps([18,1,4,19])),meta:{title:"Dinor TV"}},{path:"/video/:id",redirect:e=>"/dinor-tv"},{path:"/web-embed",name:"web-embed",component:()=>I(()=>import("./WebEmbed.DqBg9_tY.js"),__vite__mapDeps([20,1,21])),meta:{title:"Web Embed"}},{path:"/:pathMatch(.*)*",redirect:"/"}],A=e({history:t("/pwa/"),routes:L});A.beforeEach((e,t,n)=>{e.meta.title&&(document.title=`${e.meta.title} - Dinor App`),n()});const T=n("cache",()=>{const e=a(new Map),t=a(new Map),n=a(3e5);function o(n){const a=t.value.get(n);return!a||Date.now()>a?(e.value.delete(n),t.value.delete(n),null):e.value.get(n)}function s(){const n=Date.now();for(const[a,o]of t.value.entries())n>o&&(e.value.delete(a),t.value.delete(a))}return setInterval(s,3e4),{defaultTTL:n,set:function(a,o,s=n.value){e.value.set(a,o),t.value.set(a,Date.now()+s)},get:o,has:function(e){return null!==o(e)},remove:function(n){e.value.delete(n),t.value.delete(n)},clear:function(){e.value.clear(),t.value.clear()},clearExpired:s,getCacheInfo:function(){return{size:e.value.size,keys:Array.from(e.value.keys()),expired:Array.from(t.value.entries()).filter(([,e])=>Date.now()>e).map(([e])=>e)}}}}),D=n("api",()=>{const e=a(new Set),t=a(new Map),n=a(`${window.location.origin}/api/v1`),o=T();function s(t,n){n?e.value.add(t):e.value.delete(t)}function i(e,n){n?t.value.set(e,n):t.value.delete(e)}async function r(e,t={}){const a=`${e}_${JSON.stringify(t)}`;if(!t.method||"GET"===t.method){const n=await async function(e,t={}){try{const n=l(e);if(!n)return null;const a=c(t),o=await fetch("/api/pwa/cache/get",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({type:n,params:a})});if(o.ok){const e=await o.json();if(e.success)return e.data}}catch(n){console.warn("Erreur cache PWA get:",n)}return null}(e,t);if(n)return n}s(a,!0),i(a,null);try{const a=`${n.value}${e}`,o={headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest",...t.headers},...t},s=await fetch(a,o);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const i=await s.json();return t.method&&"GET"!==t.method||await async function(e,t,n={}){try{const a=l(e);if(!a)return;const o=c(n);await fetch("/api/pwa/cache/set",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({type:a,data:t,params:o})})}catch(a){console.warn("Erreur cache PWA set:",a)}}(e,i,t),i}catch(o){throw i(a,o.message),o}finally{s(a,!1)}}function l(e){return e.includes("/recipes")?"recipes":e.includes("/tips")?"tips":e.includes("/events")?"events":e.includes("/dinor-tv")?"videos":e.includes("/categories")?"categories":null}function c(e){const t=new URL(`http://example.com${e.url||""}`),n={};for(const[a,o]of t.searchParams)n[a]=o;return n}async function u(e,t={},n={}){const a=new URLSearchParams(t).toString();return r(a?`${e}?${a}`:e,{...n,method:"GET"})}return{loading:e,errors:t,baseURL:n,isLoading:function(t){return e.value.has(t)},getError:function(e){return t.value.get(e)},setLoading:s,setError:i,clearError:function(e){t.value.delete(e)},request:r,get:u,post:async function(e,t,n={}){return r(e,{...n,method:"POST",body:JSON.stringify(t)})},put:async function(e,t,n={}){return r(e,{...n,method:"PUT",body:JSON.stringify(t)})},del:async function(e,t={}){return r(e,{...t,method:"DELETE"})},invalidateCache:function(e){o.getCacheInfo().keys.filter(t=>t.includes(e)||new RegExp(e).test(t)).forEach(e=>o.remove(e))},preload:async function(e){const t=e.map(({endpoint:e,params:t,options:n})=>u(e,t,{...n,priority:"low"}).catch(()=>null));return Promise.allSettled(t)}}});function O(){const e=D();return{get:e.get,post:e.post,put:e.put,del:e.del,invalidateCache:e.invalidateCache,preload:e.preload,isLoading:e.isLoading,getError:e.getError,clearError:e.clearError}}function R(e,t={},n={}){const i=D(),r=a(null),l=a(null),c=a(!1),u=o(()=>`${e}_${JSON.stringify(t.value||t)}`),p=async(a=null,o={})=>{const s=a||t.value||t,u={...n,...o};c.value=!0,l.value=null;try{const t=await i.get(e,s,u);return r.value=t,t}catch(p){throw l.value=p.message,p}finally{c.value=!1}};return!1!==n.autoFetch&&p(),!1!==n.watchParams&&"object"==typeof t&&void 0!==t.value&&s(t,()=>p(),{deep:!0}),{data:r,error:l,loading:c,execute:p,refresh:()=>(i.invalidateCache(u.value),p())}}const S=(e,t)=>{const n=e.__vccOpts||e;for(const[a,o]of t)n[a]=o;return n},j={class:"bottom-navigation"},k={class:"nav-items"},N={class:"nav-icon"},C={class:"material-symbols-outlined"},$={class:"nav-label"};const V=S({name:"BottomNavigation",setup(){const e=d(),t=p(),{request:n}=O(),o=a(""),s=()=>{o.value&&t.push(`/web-embed?url=${encodeURIComponent(o.value)}`)},r=a([]),l=async()=>{try{const e=await n("/api/v1/pwa-menu-items");e.success&&(r.value=e.data.map(e=>{const n={name:e.name,path:"route"===e.action_type?e.path:"#",icon:e.icon,label:e.label,action_type:e.action_type,web_url:e.web_url};return"web_embed"===e.action_type?n.action=()=>{e.web_url&&t.push(`/web-embed?url=${encodeURIComponent(e.web_url)}`)}:"external_link"===e.action_type&&(n.action=()=>{e.web_url&&window.open(e.web_url,"_blank")}),n}))}catch(e){console.warn("Impossible de charger les éléments de menu:",e),r.value=[{name:"home",path:"/",icon:"home",label:"Accueil"},{name:"recipes",path:"/recipes",icon:"restaurant",label:"Recettes"},{name:"tips",path:"/tips",icon:"lightbulb",label:"Astuces"},{name:"events",path:"/events",icon:"event",label:"Événements"},{name:"dinor-tv",path:"/dinor-tv",icon:"play_circle",label:"Dinor TV"},{name:"web",path:"#",icon:"public",label:"Web",action:s}]}};return i(()=>{(async()=>{try{const e=await n("/api/v1/pages?slug=web-embed");if(e.success&&e.data.length>0){const t=e.data[0];o.value=t.embed_url||t.content||""}}catch(e){console.warn("Impossible de charger les paramètres de la page Web:",e),o.value="https://www.google.com"}})(),l()}),{navItems:r,isActive:t=>"#"!==t&&("/"===t?"/"===e.path:e.path.startsWith(t)),loadNavItems:l}}},[["render",function(e,t,n,a,o,s){const i=m("router-link");return v(),r("nav",j,[l("div",k,[(v(!0),r(c,null,u(a.navItems,e=>(v(),h(i,{key:e.name,to:e.path,class:_(["nav-item",{active:a.isActive(e.path)}]),onClick:t=>e.action&&e.action()},{default:f(()=>[l("div",N,[l("span",C,w(e.icon),1)]),l("span",$,w(e.label),1)]),_:2},1032,["to","class","onClick"]))),128))])])}],["__scopeId","data-v-b4a489c1"]]),W=n("app",()=>{const e=a(!1),t=a(null),n=a(navigator.onLine),o=a(null),s=a(!1);function i(e){n.value=e}function r(e){o.value=e}function l(e){s.value=e}return{loading:e,error:t,online:n,installPromptEvent:o,isInstalled:s,setLoading:function(t){e.value=t},setError:function(e){t.value=e},clearError:function(){t.value=null},setOnlineStatus:i,setInstallPromptEvent:r,setInstallationStatus:l,showInstallPrompt:async function(){if(!o.value)return!1;try{const e="accepted"===(await o.value.prompt()).outcome;return e&&(l(!0),r(null)),e}catch(e){return console.error("Install prompt failed:",e),!1}},initializeNetworkListeners:function(){window.addEventListener("online",()=>i(!0)),window.addEventListener("offline",()=>i(!1))},initializePWAListeners:function(){window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),r(e)}),window.addEventListener("appinstalled",()=>{l(!0),r(null)}),window.matchMedia("(display-mode: standalone)").matches&&l(!0)}}}),x={class:"prompt-content"},q={class:"prompt-actions"};const B={id:"app-container"};const M=g(S({name:"App",components:{BottomNavigation:V,InstallPrompt:S({name:"InstallPrompt",setup(){const e=W(),t=a(!1),n=a(!1),s=o(()=>e.installPromptEvent&&!e.isInstalled&&!n.value);return i(()=>{sessionStorage.getItem("pwa-install-dismissed")?n.value=!0:setTimeout(()=>{s.value&&(t.value=!0)},3e3)}),{showPrompt:s,visible:t,installApp:async()=>{await e.showInstallPrompt()&&(t.value=!1)},dismissPrompt:()=>{n.value=!0,t.value=!1,sessionStorage.setItem("pwa-install-dismissed","true")}}}},[["render",function(e,t,n,a,o,s){return a.showPrompt?(v(),r("div",{key:0,class:_(["install-prompt",{visible:a.visible}])},[l("div",x,[t[2]||(t[2]=l("div",{class:"prompt-icon"},[l("span",{class:"material-symbols-outlined"},"download")],-1)),t[3]||(t[3]=l("div",{class:"prompt-text"},[l("h3",null,"Installer Dinor App"),l("p",null,"Installez l'app pour une meilleure expérience")],-1)),l("div",q,[l("button",{onClick:t[0]||(t[0]=(...e)=>a.dismissPrompt&&a.dismissPrompt(...e)),class:"btn-dismiss"}," Plus tard "),l("button",{onClick:t[1]||(t[1]=(...e)=>a.installApp&&a.installApp(...e)),class:"btn-install"}," Installer ")])])],2)):b("",!0)}],["__scopeId","data-v-003a7eb4"]])},setup(){const e=d();return{showBottomNav:o(()=>["/","/recipes","/tips","/events","/pages","/dinor-tv"].some(t=>e.path===t||"/"!==t&&e.path.startsWith(t)))}}},[["render",function(e,t,n,a,o,s){const i=m("router-view"),c=m("BottomNavigation"),u=m("InstallPrompt");return v(),r("div",B,[l("main",{class:_(["main-content md3-main-content",{"with-bottom-nav":a.showBottomNav}])},[y(i)],2),a.showBottomNav?(v(),h(c,{key:0})):b("",!0),y(u)])}]])),U=E();M.use(U),M.use(A),M.mount("#app");export{S as _,O as a,W as b,D as c,R as u};
