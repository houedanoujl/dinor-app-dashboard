import{b as e,d as t,p as a,i as l,t as s,e as n,F as i,g as r,n as o,f as c,l as u,m as d,u as v,o as p}from"./vendor.CHp--hJi.js";import{a as m}from"./api.XOCQ1Ma4.js";import{S as y}from"./SearchAndFilters.CjayWb-X.js";import{_ as g}from"./index.B8aG9rpS.js";const f={class:"events-list"},b={key:0,class:"loading-state"},h={key:1,class:"error-state"},F={key:2,class:"content"},k={key:0,class:"empty-state"},C={key:0},_={key:1},T={key:1,class:"events-container"},w=["onClick"],A={class:"event-image"},L=["src","alt"],E={class:"event-status"},S={class:"event-content"},Q={class:"event-header"},D={class:"event-title"},j={key:0,class:"event-price"},x={key:0,class:"free-badge"},R={key:1,class:"price"},z={key:0,class:"event-description"},P={class:"event-details"},U={class:"detail"},N={key:0,class:"detail"},G={key:1,class:"detail"},I={key:2,class:"detail"},O={key:1,class:"participants-info"};const $=g({name:"EventsList",components:{SearchAndFilters:y},setup(){const e=v(),t=c([]),a=c([]),l=c(!1),s=c(null),n=c(""),i=c(null),r=c({eventType:null,eventFormat:null,price:null,status:null}),o=u(()=>{let e=t.value;if(n.value.trim()){const t=n.value.toLowerCase();e=e.filter(e=>{var a,l,s,n,i,r;return(null==(a=e.title)?void 0:a.toLowerCase().includes(t))||(null==(l=e.description)?void 0:l.toLowerCase().includes(t))||(null==(s=e.short_description)?void 0:s.toLowerCase().includes(t))||(null==(n=e.location)?void 0:n.toLowerCase().includes(t))||(null==(i=e.city)?void 0:i.toLowerCase().includes(t))||(null==(r=e.organizer_name)?void 0:r.toLowerCase().includes(t))})}return i.value&&(e=e.filter(e=>e.category_id===i.value)),r.value.eventType&&(e=e.filter(e=>e.event_type===r.value.eventType)),r.value.eventFormat&&(e=e.filter(e=>e.event_format===r.value.eventFormat)),r.value.price&&("free"===r.value.price?e=e.filter(e=>e.is_free):"paid"===r.value.price&&(e=e.filter(e=>!e.is_free))),r.value.status&&(e=e.filter(e=>e.status===r.value.status)),e}),p=u(()=>Object.values(r.value).some(e=>null!==e)),y=u(()=>[{key:"eventType",label:"Type d'événement",icon:"category",allLabel:"Tous les types",options:[{value:"conference",label:"Conférence"},{value:"workshop",label:"Atelier"},{value:"seminar",label:"Séminaire"},{value:"cooking_class",label:"Cours de cuisine"},{value:"tasting",label:"Dégustation"},{value:"festival",label:"Festival"},{value:"competition",label:"Concours"},{value:"networking",label:"Networking"},{value:"exhibition",label:"Exposition"},{value:"party",label:"Fête"}]},{key:"eventFormat",label:"Format",icon:"computer",allLabel:"Tous les formats",options:[{value:"in_person",label:"En présentiel"},{value:"online",label:"En ligne"},{value:"hybrid",label:"Hybride"}]},{key:"price",label:"Tarif",icon:"payments",allLabel:"Tous les tarifs",options:[{value:"free",label:"Gratuit"},{value:"paid",label:"Payant"}]},{key:"status",label:"Statut",icon:"info",allLabel:"Tous les statuts",options:[{value:"active",label:"Actif"},{value:"upcoming",label:"À venir"},{value:"completed",label:"Terminé"}]}]),g=async()=>{l.value=!0,s.value=null;try{const e=await m.getEvents();if(!e.success)throw new Error(e.message||"Failed to fetch events");t.value=e.data}catch(e){s.value=e.message,console.error("Error fetching events:",e)}finally{l.value=!1}},f=async()=>{try{const e=await m.getCategories();e.success&&(a.value=e.data)}catch(e){console.warn("Error fetching categories:",e)}};return d(()=>{g(),f()}),{events:t,categories:a,loading:l,error:s,searchQuery:n,selectedCategory:i,selectedFilters:r,filteredEvents:o,hasActiveFilters:p,eventFilters:y,goToEvent:t=>{e.push(`/event/${t}`)},retry:()=>{s.value=null,g(),f()},updateAdditionalFilter:({key:e,value:t})=>{r.value[e]=t},clearAllFilters:()=>{n.value="",i.value=null,r.value={eventType:null,eventFormat:null,price:null,status:null}},getStatusClass:e=>({active:"status-active",cancelled:"status-cancelled",completed:"status-completed",upcoming:"status-upcoming"}[e]||"status-default"),getStatusLabel:e=>({active:"Actif",cancelled:"Annulé",completed:"Terminé",upcoming:"À venir"}[e]||"Non défini"),getEventTypeLabel:e=>({festival:"Festival",cooking_class:"Cours de cuisine",tasting:"Dégustation",workshop:"Atelier",conference:"Conférence"}[e]||e),formatDate:e=>e?new Date(e).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}):"",formatTime:e=>e?new Date(`2000-01-01T${e}`).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}):"",formatPrice:(e,t="XOF")=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:t}).format(e)}}},[["render",function(c,u,d,v,m,y){const g=l("SearchAndFilters");return p(),e("div",f,[u[12]||(u[12]=t("header",{class:"page-header"},[t("div",{class:"header-content"},[t("h1",null,"Événements"),t("p",{class:"subtitle"},"Participez à nos événements culinaires")])],-1)),a(g,{searchQuery:v.searchQuery,"onUpdate:searchQuery":u[0]||(u[0]=e=>v.searchQuery=e),selectedCategory:v.selectedCategory,"onUpdate:selectedCategory":u[1]||(u[1]=e=>v.selectedCategory=e),"search-placeholder":"Rechercher un événement...",categories:v.categories,"additional-filters":v.eventFilters,"selected-filters":v.selectedFilters,"results-count":v.filteredEvents.length,"item-type":"événement","onUpdate:additionalFilter":v.updateAdditionalFilter},null,8,["searchQuery","selectedCategory","categories","additional-filters","selected-filters","results-count","onUpdate:additionalFilter"]),v.loading?(p(),e("div",b,u[4]||(u[4]=[t("div",{class:"loading-spinner"},null,-1),t("p",null,"Chargement des événements...",-1)]))):v.error?(p(),e("div",h,[u[5]||(u[5]=t("div",{class:"error-icon"},[t("span",{class:"material-symbols-outlined"},"error")],-1)),t("p",null,s(v.error),1),t("button",{onClick:u[2]||(u[2]=(...e)=>v.retry&&v.retry(...e)),class:"retry-btn"}," Réessayer ")])):(p(),e("div",F,[v.filteredEvents.length||v.loading?(p(),e("div",T,[(p(!0),e(i,null,r(v.filteredEvents,a=>(p(),e("article",{key:a.id,onClick:e=>v.goToEvent(a.id),class:"event-card"},[t("div",A,[t("img",{src:a.featured_image_url||"/images/default-event.jpg",alt:a.title,loading:"lazy"},null,8,L),t("div",E,[t("span",{class:o(v.getStatusClass(a.status))},s(v.getStatusLabel(a.status)),3)])]),t("div",S,[t("div",Q,[t("h3",D,s(a.title),1),a.price?(p(),e("div",j,[a.is_free?(p(),e("span",x,"Gratuit")):(p(),e("span",R,s(v.formatPrice(a.price,a.currency)),1))])):n("",!0)]),a.short_description?(p(),e("p",z,s(a.short_description),1)):n("",!0),t("div",P,[t("div",U,[u[7]||(u[7]=t("span",{class:"material-symbols-outlined"},"calendar_today",-1)),t("span",null,s(v.formatDate(a.start_date)),1)]),a.start_time?(p(),e("div",N,[u[8]||(u[8]=t("span",{class:"material-symbols-outlined"},"schedule",-1)),t("span",null,s(v.formatTime(a.start_time)),1)])):n("",!0),a.location?(p(),e("div",G,[u[9]||(u[9]=t("span",{class:"material-symbols-outlined"},"location_on",-1)),t("span",null,s(a.location),1)])):n("",!0),a.event_type?(p(),e("div",I,[u[10]||(u[10]=t("span",{class:"material-symbols-outlined"},"category",-1)),t("span",null,s(v.getEventTypeLabel(a.event_type)),1)])):n("",!0)]),a.max_participants?(p(),e("div",O,[u[11]||(u[11]=t("span",{class:"material-symbols-outlined"},"group",-1)),t("span",null,s(a.participants_count||0)+" / "+s(a.max_participants)+" participants",1)])):n("",!0)])],8,w))),128))])):(p(),e("div",k,[u[6]||(u[6]=t("div",{class:"empty-icon"},[t("span",{class:"material-symbols-outlined"},"event")],-1)),t("h3",null,s(v.searchQuery||v.selectedCategory||v.hasActiveFilters?"Aucun événement trouvé":"Aucun événement disponible"),1),v.searchQuery||v.selectedCategory||v.hasActiveFilters?(p(),e("p",C," Essayez de modifier vos critères de recherche. ")):(p(),e("p",_," Les événements culinaires seront bientôt disponibles. ")),v.searchQuery||v.selectedCategory||v.hasActiveFilters?(p(),e("button",{key:2,onClick:u[3]||(u[3]=(...e)=>v.clearAllFilters&&v.clearAllFilters(...e)),class:"clear-filters-btn"}," Effacer tous les filtres ")):n("",!0)]))]))])}],["__scopeId","data-v-ab7d3a90"]]);export{$ as default};
