import{b as e,d as s,k as i,t,y as l,F as a,r as o,B as d,C as r,h as n,i as c,j as u,o as v}from"./vendor.2V9jEnd_.js";import{a as m}from"./api.uSn_et4s.js";import{_ as p}from"./main.DEpiNenS.js";const y={class:"dinor-tv"},b={key:0,class:"loading-state"},g={key:1,class:"error-state"},h={key:2,class:"content"},f={key:0,class:"live-section"},k={class:"live-grid"},V=["onClick"],_={class:"video-thumbnail"},w=["src","alt"],D={class:"video-info"},S={class:"video-title"},C={key:0,class:"video-description"},T={class:"video-meta"},j={key:0,class:"viewers"},$={key:1,class:"scheduled"},E={class:"videos-section"},F={key:0,class:"empty-state"},L={key:1,class:"videos-grid"},R=["onClick"],x={class:"video-thumbnail"},z=["src","alt"],I={class:"video-overlay"},M={key:0,class:"duration"},U={class:"video-info"},A={class:"video-title"},B={key:0,class:"video-description"},P={class:"video-meta"},q={key:0,class:"views"},G={key:1,class:"date"},H={class:"video-player"},J=["src","title"],K={class:"video-details"},N={key:0};const O=p({name:"DinorTV",setup(){const e=n([]),s=n(null),i=n(!1),t=n(null),l=c(()=>e.value.filter(e=>e.is_live)),a=async()=>{i.value=!0,t.value=null;try{const s=await m.getVideos();if(!s.success)throw new Error(s.message||"Failed to fetch videos");e.value=s.data}catch(s){t.value=s.message,console.error("Error fetching videos:",s)}finally{i.value=!1}};return u(()=>{a()}),{videos:e,liveVideos:l,selectedVideo:s,loading:i,error:t,retry:()=>{t.value=null,a()},playVideo:e=>{s.value=e,document.body.style.overflow="hidden"},closeVideo:()=>{s.value=null,document.body.style.overflow="auto"},getVideoThumbnail:e=>{if(!e)return"/images/default-video.jpg";const s=e.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\n?#]+)/);return s?`https://img.youtube.com/vi/${s[1]}/maxresdefault.jpg`:"/images/default-video.jpg"},getEmbedUrl:e=>{if(!e)return"";const s=e.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\n?#]+)/);return s?`https://www.youtube.com/embed/${s[1]}?autoplay=1`:e},getShortDescription:e=>{if(!e)return"";const s=e.replace(/<[^>]*>/g,"");return s.length>100?s.substring(0,100)+"...":s},formatDuration:e=>{if(!e)return"";const s=Math.floor(e/3600),i=Math.floor(e%3600/60),t=e%60;return s>0?`${s}:${i.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`:`${i}:${t.toString().padStart(2,"0")}`},formatDate:e=>e?new Date(e).toLocaleDateString("fr-FR",{year:"numeric",month:"short",day:"numeric"}):"",formatTime:e=>e?new Date(e).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}):""}}},[["render",function(n,c,u,m,p,O){return v(),e("div",y,[c[14]||(c[14]=s("header",{class:"page-header"},[s("div",{class:"header-content"},[s("h1",null,"Dinor TV"),s("p",{class:"subtitle"},"Vidéos culinaires et émissions en direct")])],-1)),m.loading?(v(),e("div",b,c[4]||(c[4]=[s("div",{class:"loading-spinner"},null,-1),s("p",null,"Chargement des vidéos...",-1)]))):m.error?(v(),e("div",g,[c[5]||(c[5]=s("div",{class:"error-icon"},[s("span",{class:"material-symbols-outlined"},"error")],-1)),s("p",null,t(m.error),1),s("button",{onClick:c[0]||(c[0]=(...e)=>m.retry&&m.retry(...e)),class:"retry-btn"}," Réessayer ")])):(v(),e("div",h,[m.liveVideos.length?(v(),e("section",f,[c[8]||(c[8]=s("h2",{class:"section-title"},[s("span",{class:"live-indicator"}),l(" En Direct ")],-1)),s("div",k,[(v(!0),e(a,null,o(m.liveVideos,a=>(v(),e("article",{key:a.id,onClick:e=>m.playVideo(a),class:"video-card live-card"},[s("div",_,[s("img",{src:a.thumbnail_url||m.getVideoThumbnail(a.video_url),alt:a.title,loading:"lazy"},null,8,w),c[6]||(c[6]=d('<div class="video-overlay" data-v-e897b679><div class="play-button" data-v-e897b679><span class="material-symbols-outlined" data-v-e897b679>play_circle</span></div><div class="live-badge" data-v-e897b679><span class="live-dot" data-v-e897b679></span> LIVE </div></div>',1))]),s("div",D,[s("h3",S,t(a.title),1),a.description?(v(),e("p",C,t(m.getShortDescription(a.description)),1)):i("",!0),s("div",T,[a.viewers_count?(v(),e("span",j,[c[7]||(c[7]=s("span",{class:"material-symbols-outlined"},"visibility",-1)),l(" "+t(a.viewers_count)+" spectateurs ",1)])):i("",!0),a.scheduled_at?(v(),e("span",$," Programmé à "+t(m.formatTime(a.scheduled_at)),1)):i("",!0)])])],8,V))),128))])])):i("",!0),s("section",E,[c[12]||(c[12]=s("h2",{class:"section-title"},"Toutes les vidéos",-1)),m.videos.length||m.loading?(v(),e("div",L,[(v(!0),e(a,null,o(m.videos,a=>(v(),e("article",{key:a.id,onClick:e=>m.playVideo(a),class:"video-card"},[s("div",x,[s("img",{src:a.thumbnail_url||m.getVideoThumbnail(a.video_url),alt:a.title,loading:"lazy"},null,8,z),s("div",I,[c[10]||(c[10]=s("div",{class:"play-button"},[s("span",{class:"material-symbols-outlined"},"play_circle")],-1)),a.duration?(v(),e("div",M,t(m.formatDuration(a.duration)),1)):i("",!0)])]),s("div",U,[s("h3",A,t(a.title),1),a.description?(v(),e("p",B,t(m.getShortDescription(a.description)),1)):i("",!0),s("div",P,[a.views_count?(v(),e("span",q,[c[11]||(c[11]=s("span",{class:"material-symbols-outlined"},"visibility",-1)),l(" "+t(a.views_count)+" vues ",1)])):i("",!0),a.created_at?(v(),e("span",G,t(m.formatDate(a.created_at)),1)):i("",!0)])])],8,R))),128))])):(v(),e("div",F,c[9]||(c[9]=[s("div",{class:"empty-icon"},[s("span",{class:"material-symbols-outlined"},"play_circle")],-1),s("h3",null,"Aucune vidéo disponible",-1),s("p",null,"Les vidéos culinaires seront bientôt disponibles.",-1)])))])])),m.selectedVideo?(v(),e("div",{key:3,class:"video-modal",onClick:c[3]||(c[3]=(...e)=>m.closeVideo&&m.closeVideo(...e))},[s("div",{class:"modal-content",onClick:c[2]||(c[2]=r(()=>{},["stop"]))},[s("button",{onClick:c[1]||(c[1]=(...e)=>m.closeVideo&&m.closeVideo(...e)),class:"close-button"},c[13]||(c[13]=[s("span",{class:"material-symbols-outlined"},"close",-1)])),s("div",H,[s("iframe",{src:m.getEmbedUrl(m.selectedVideo.video_url),title:m.selectedVideo.title,frameborder:"0",allowfullscreen:""},null,8,J)]),s("div",K,[s("h3",null,t(m.selectedVideo.title),1),m.selectedVideo.description?(v(),e("p",N,t(m.selectedVideo.description),1)):i("",!0)])])])):i("",!0)])}],["__scopeId","data-v-e897b679"]]);export{O as default};
