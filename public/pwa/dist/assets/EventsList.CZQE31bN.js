import{d as e,v as a,j as t,e as l,f as s,t as n,F as r,i,n as o,r as c,b as u,m as d,h as v,o as p}from"./vendor.BeqKZlTx.js";import{a as m}from"./api.70uutYeQ.js";import{S as y}from"./SearchAndFilters.CqR4qwHj.js";import{_ as g}from"./index.W0j3SMuK.js";const f={class:"events-list"},b={key:0,class:"loading-state"},h={key:1,class:"error-state"},k={key:2,class:"content"},F={key:0,class:"empty-state"},C={class:"md3-body-medium dinor-text-gray"},_={key:1,class:"events-container"},E=["onClick"],T={class:"event-image"},w=["src","alt"],A={class:"event-status"},L={class:"event-content"},j={class:"event-header"},S={class:"event-title"},x={key:0,class:"event-price"},Q={key:0,class:"free-badge"},D={key:1,class:"price"},I={key:0,class:"event-description"},R={class:"event-details"},U={class:"detail"},N={key:0,class:"detail"},P={key:1,class:"detail"},z={key:2,class:"detail"},G={key:1,class:"participants-info"};const O=g({name:"EventsList",components:{SearchAndFilters:y},setup(){const e=v(),a=c([]),t=c([]),l=c(!1),s=c(null),n=c(""),r=c(null),i=c({eventType:null,eventFormat:null,price:null,status:null}),o=u(()=>{let e=a.value;if(n.value.trim()){const a=n.value.toLowerCase();e=e.filter(e=>{var t,l,s,n,r,i;return(null==(t=e.title)?void 0:t.toLowerCase().includes(a))||(null==(l=e.description)?void 0:l.toLowerCase().includes(a))||(null==(s=e.short_description)?void 0:s.toLowerCase().includes(a))||(null==(n=e.location)?void 0:n.toLowerCase().includes(a))||(null==(r=e.city)?void 0:r.toLowerCase().includes(a))||(null==(i=e.organizer_name)?void 0:i.toLowerCase().includes(a))})}return r.value&&(e=e.filter(e=>e.category_id===r.value)),i.value.eventType&&(e=e.filter(e=>e.event_type===i.value.eventType)),i.value.eventFormat&&(e=e.filter(e=>e.event_format===i.value.eventFormat)),i.value.price&&("free"===i.value.price?e=e.filter(e=>e.is_free):"paid"===i.value.price&&(e=e.filter(e=>!e.is_free))),i.value.status&&(e=e.filter(e=>e.status===i.value.status)),e}),p=u(()=>Object.values(i.value).some(e=>null!==e)),y=u(()=>[{key:"eventType",label:"Type d'événement",icon:"category",allLabel:"Tous les types",options:[{value:"conference",label:"Conférence"},{value:"workshop",label:"Atelier"},{value:"seminar",label:"Séminaire"},{value:"cooking_class",label:"Cours de cuisine"},{value:"tasting",label:"Dégustation"},{value:"festival",label:"Festival"},{value:"competition",label:"Concours"},{value:"networking",label:"Networking"},{value:"exhibition",label:"Exposition"},{value:"party",label:"Fête"}]},{key:"eventFormat",label:"Format",icon:"computer",allLabel:"Tous les formats",options:[{value:"in_person",label:"En présentiel"},{value:"online",label:"En ligne"},{value:"hybrid",label:"Hybride"}]},{key:"price",label:"Tarif",icon:"payments",allLabel:"Tous les tarifs",options:[{value:"free",label:"Gratuit"},{value:"paid",label:"Payant"}]},{key:"status",label:"Statut",icon:"info",allLabel:"Tous les statuts",options:[{value:"active",label:"Actif"},{value:"upcoming",label:"À venir"},{value:"completed",label:"Terminé"}]}]),g=async()=>{l.value=!0,s.value=null;try{const e=await m.getEvents();if(!e.success)throw new Error(e.message||"Failed to fetch events");a.value=e.data}catch(e){s.value=e.message,console.error("Error fetching events:",e)}finally{l.value=!1}},f=async()=>{try{const e=await m.getEventCategories();e.success&&(t.value=e.data)}catch(e){console.warn("Error fetching event categories:",e)}};return d(()=>{g(),f()}),{events:a,categories:t,loading:l,error:s,searchQuery:n,selectedCategory:r,selectedFilters:i,filteredEvents:o,hasActiveFilters:p,eventFilters:y,goToEvent:a=>{e.push(`/event/${a}`)},retry:()=>{s.value=null,g(),f()},updateAdditionalFilter:({key:e,value:a})=>{i.value[e]=a},clearAllFilters:()=>{n.value="",r.value=null,i.value={eventType:null,eventFormat:null,price:null,status:null}},getStatusClass:e=>({active:"status-active",cancelled:"status-cancelled",completed:"status-completed",upcoming:"status-upcoming"}[e]||"status-default"),getStatusLabel:e=>({active:"Actif",cancelled:"Annulé",completed:"Terminé",upcoming:"À venir"}[e]||"Non défini"),getEventTypeLabel:e=>({festival:"Festival",cooking_class:"Cours de cuisine",tasting:"Dégustation",workshop:"Atelier",conference:"Conférence"}[e]||e),formatDate:e=>e?new Date(e).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}):"",formatTime:e=>e?new Date(`2000-01-01T${e}`).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}):"",formatPrice:(e,a="XOF")=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:a}).format(e),handleImageError:e=>{e.target.src="/images/default-event.jpg"}}}},[["render",function(c,u,d,v,m,y){const g=t("SearchAndFilters");return p(),e("div",f,[a(g,{searchQuery:v.searchQuery,"onUpdate:searchQuery":u[0]||(u[0]=e=>v.searchQuery=e),selectedCategory:v.selectedCategory,"onUpdate:selectedCategory":u[1]||(u[1]=e=>v.selectedCategory=e),"search-placeholder":"Rechercher un événement...",categories:v.categories,"additional-filters":v.eventFilters,"selected-filters":v.selectedFilters,"results-count":v.filteredEvents.length,"item-type":"événement","onUpdate:additionalFilter":v.updateAdditionalFilter},null,8,["searchQuery","selectedCategory","categories","additional-filters","selected-filters","results-count","onUpdate:additionalFilter"]),v.loading?(p(),e("div",b,u[5]||(u[5]=[l("div",{class:"loading-spinner"},null,-1),l("p",null,"Chargement des événements...",-1)]))):v.error?(p(),e("div",h,[u[6]||(u[6]=l("div",{class:"error-icon"},[l("span",{class:"material-symbols-outlined"},"error"),l("span",{class:"emoji-fallback"},"⚠️")],-1)),u[7]||(u[7]=l("p",{class:"md3-body-large dinor-text-gray"},"Erreur lors du chargement des événements.",-1)),l("button",{onClick:u[2]||(u[2]=(...e)=>v.retry&&v.retry(...e)),class:"retry-btn"}," Réessayer ")])):(p(),e("div",k,[v.filteredEvents.length||v.loading?(p(),e("div",_,[(p(!0),e(r,null,i(v.filteredEvents,a=>(p(),e("article",{key:a.id,onClick:e=>v.goToEvent(a.id),class:"event-card"},[l("div",T,[l("img",{src:a.featured_image_url||"/images/default-event.jpg",alt:a.title,loading:"lazy",onError:u[4]||(u[4]=(...e)=>v.handleImageError&&v.handleImageError(...e))},null,40,w),l("div",A,[l("span",{class:o(v.getStatusClass(a.status))},n(v.getStatusLabel(a.status)),3)])]),l("div",L,[l("div",j,[l("h3",S,n(a.title),1),a.price?(p(),e("div",x,[a.is_free?(p(),e("span",Q,"Gratuit")):(p(),e("span",D,n(v.formatPrice(a.price,a.currency)),1))])):s("",!0)]),a.short_description?(p(),e("p",I,n(a.short_description),1)):s("",!0),l("div",R,[l("div",U,[u[10]||(u[10]=l("span",{class:"material-symbols-outlined"},"calendar_today",-1)),u[11]||(u[11]=l("span",{class:"emoji-fallback"},"📅",-1)),l("span",null,n(v.formatDate(a.start_date)),1)]),a.start_time?(p(),e("div",N,[u[12]||(u[12]=l("span",{class:"material-symbols-outlined"},"schedule",-1)),u[13]||(u[13]=l("span",{class:"emoji-fallback"},"⏰",-1)),l("span",null,n(v.formatTime(a.start_time)),1)])):s("",!0),a.location?(p(),e("div",P,[u[14]||(u[14]=l("span",{class:"material-symbols-outlined"},"location_on",-1)),u[15]||(u[15]=l("span",{class:"emoji-fallback"},"📍",-1)),l("span",null,n(a.location),1)])):s("",!0),a.event_type?(p(),e("div",z,[u[16]||(u[16]=l("span",{class:"material-symbols-outlined"},"category",-1)),u[17]||(u[17]=l("span",{class:"emoji-fallback"},"🏷️",-1)),l("span",null,n(v.getEventTypeLabel(a.event_type)),1)])):s("",!0)]),a.max_participants?(p(),e("div",G,[u[18]||(u[18]=l("span",{class:"material-symbols-outlined"},"group",-1)),u[19]||(u[19]=l("span",{class:"emoji-fallback"},"👥",-1)),l("span",null,n(a.participants_count||0)+" / "+n(a.max_participants)+" participants",1)])):s("",!0)])],8,E))),128))])):(p(),e("div",F,[u[8]||(u[8]=l("div",{class:"empty-icon"},[l("span",{class:"material-symbols-outlined"},"event"),l("span",{class:"emoji-fallback"},"📅")],-1)),u[9]||(u[9]=l("h2",{class:"md3-title-medium"},"Aucun événement trouvé",-1)),l("p",C,n(v.searchQuery||v.selectedCategory||v.hasActiveFilters?"Aucun événement ne correspond à vos critères de recherche.":"Aucun événement n'est disponible pour le moment."),1),v.searchQuery||v.selectedCategory||v.hasActiveFilters?(p(),e("button",{key:0,onClick:u[3]||(u[3]=(...e)=>v.clearAllFilters&&v.clearAllFilters(...e)),class:"clear-filters-btn"}," Effacer tous les filtres ")):s("",!0)]))]))])}],["__scopeId","data-v-70ba06fb"]]);export{O as default};
