<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Iframe Simple</title>
</head>
<body>
    <h1>Test des √©v√©nements iframe</h1>
    
    <button onclick="testExampleCom()">Tester example.com</button>
    <button onclick="testHttpbin()">Tester httpbin.org</button>
    <button onclick="clearLogs()">Effacer logs</button>
    
    <div id="iframe-container" style="margin: 20px 0;">
        <!-- L'iframe sera ins√©r√©e ici -->
    </div>
    
    <div id="logs" style="background: #f0f0f0; padding: 10px; height: 300px; overflow-y: scroll; font-family: monospace; white-space: pre-wrap;"></div>

    <script>
        let logElement = document.getElementById('logs');
        let iframeContainer = document.getElementById('iframe-container');
        let currentIframe = null;
        
        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            logElement.textContent += `[${timestamp}] ${message}\n`;
            logElement.scrollTop = logElement.scrollHeight;
            console.log(message);
        }
        
        function clearLogs() {
            logElement.textContent = '';
            if (currentIframe) {
                currentIframe.remove();
                currentIframe = null;
            }
            iframeContainer.innerHTML = '';
        }
        
        function createIframe(url) {
            clearLogs();
            log(`üöÄ Cr√©ation d'une iframe pour: ${url}`);
            
            currentIframe = document.createElement('iframe');
            currentIframe.src = url;
            currentIframe.style.width = '100%';
            currentIframe.style.height = '400px';
            currentIframe.style.border = '1px solid #ccc';
            
            // Ajouter tous les √©v√©nements possibles
            currentIframe.addEventListener('load', () => {
                log('‚úÖ √âv√©nement LOAD d√©clench√©');
                log(`   - readyState: ${currentIframe.contentDocument?.readyState || 'Inaccessible (CORS)'}`);
                log(`   - URL finale: ${currentIframe.contentWindow?.location?.href || 'Inaccessible (CORS)'}`);
            });
            
            currentIframe.addEventListener('error', (e) => {
                log('‚ùå √âv√©nement ERROR d√©clench√©');
                log(`   - D√©tails: ${e.message || 'Pas de message'}`);
            });
            
            currentIframe.addEventListener('loadstart', () => {
                log('üîÑ √âv√©nement LOADSTART d√©clench√©');
            });
            
            currentIframe.addEventListener('loadend', () => {
                log('üèÅ √âv√©nement LOADEND d√©clench√©');
            });
            
            // Timeout de test
            setTimeout(() => {
                log('‚è∞ Timeout de 10 secondes atteint');
                if (currentIframe) {
                    log(`   - iframe toujours pr√©sente`);
                    log(`   - src: ${currentIframe.src}`);
                    try {
                        log(`   - contentDocument: ${currentIframe.contentDocument ? 'Accessible' : 'Null'}`);
                    } catch (e) {
                        log(`   - contentDocument: Erreur CORS (${e.message})`);
                    }
                }
            }, 10000);
            
            log('üìç Ajout de l\'iframe au DOM...');
            iframeContainer.appendChild(currentIframe);
            log('‚úÖ Iframe ajout√©e au DOM');
        }
        
        function testExampleCom() {
            createIframe('https://example.com');
        }
        
        function testHttpbin() {
            createIframe('https://httpbin.org/');
        }
        
        log('üöÄ Page charg√©e, pr√™t pour les tests');
    </script>
</body>
</html> 